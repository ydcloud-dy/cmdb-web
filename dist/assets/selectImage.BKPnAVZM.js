/*! 
 Build based on  
 Time : 1735190558000 */
import{P as e,o as l,c as a,B as t,h as o,w as s,e as r,f as u,b as i,cA as n,g as c,cm as m,Q as d,dv as p,a as v,dn as f,F as g,v as y,dw as h,t as w,cu as k,i as b,k as x,E as j}from"./index.ABWJOL2Q.js";import{E as C}from"./drawer.XhtctEYG.js";import"./overlay.CDLw2uOw.js";import{E as _}from"./pagination.BfYt3rvk.js";/* empty css            */import"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              */import{E as z}from"./image-viewer.Dd9ZIujV.js";/* empty css               */import{b as I,g as V}from"./image.CN53lrx2.js";import{_ as S,U as B,e as T,g as E,d as U}from"./common.CYrLijw_.js";import{_ as P}from"./warningBar.BzThqhMC.js";const D={class:"w-40 h-40 relative rounded border border-dashed border-gray-300 overflow-hidden cursor-pointer group"},A={key:1,class:"w-full h-full object-cover",muted:"",preload:"metadata"},F=["src"],M=["src"],O={__name:"selectComponent",props:{model:{default:"",type:String}},emits:["chooseItem","deleteItem"],setup(p,{emit:v}){const f=v,g=()=>{f("chooseItem")},y=()=>{f("deleteItem")};return(v,f)=>{const h=e("VideoPlay"),w=d;return l(),a("div",D,[t(I)(p.model||"")?(l(),o(w,{key:0,size:32,class:"absolute top-[calc(50%-16px)] left-[calc(50%-16px)]"},{default:s((()=>[r(h)])),_:1})):u("",!0),t(I)(p.model||"")?(l(),a("video",A,[i("source",{src:t(V)(p.model)+"#t=1"},null,8,F)])):u("",!0),p.model&&!t(I)(p.model)?(l(),a("img",{key:2,class:"w-full h-full",src:t(V)(p.model),alt:"图片"},null,8,M)):u("",!0),p.model?(l(),a("div",{key:3,class:"left-0 top-0 hidden text-gray-600 group-hover:bg-gray-600 group-hover:bg-opacity-30 w-full h-full group-hover:flex justify-center items-center absolute z-10",onClick:y},[r(w,null,{default:s((()=>[r(t(n))])),_:1}),f[0]||(f[0]=c(" 删除 "))])):(l(),a("div",{key:4,class:"text-gray-600 group-hover:bg-gray-400 w-full h-full flex justify-center items-center",onClick:g},[r(w,null,{default:s((()=>[r(t(m))])),_:1}),f[1]||(f[1]=c(" 上传 "))]))])}}},N={key:1,class:"w-full gap-4 flex flex-wrap"},Q={class:"dycloud-btn-list gap-2"},q={class:"flex flex-wrap gap-4"},G={class:"w-40 h-40 border rounded overflow-hidden border-dashed border-gray-300 cursor-pointer relative group"},H=["onClick"],J=["src"],K={key:2,class:"w-full h-full object-cover flex items-center justify-center"},L=["onClick"],R=["onClick"],W={__name:"selectImage",props:p({multiple:{type:Boolean,default:!1},fileType:{type:String,default:""},maxUpdateCount:{type:Number,default:0}},{modelValue:{type:[String,Array]},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const m=v(""),p=v(""),D=v({}),A=v(1),F=v(0),M=v(20),W=f(n,"modelValue"),X=n,Y=e=>{M.value=e,oe()},Z=e=>{A.value=e,oe()},$=v(!1),ee=v([]),le={image:["png","jpg","jpeg","gif","bmp","webp"],video:["mp4","avi","rmvb","rm","asf","divx","mpg","mpeg","mpe","wmv","mkv","vob"]},ae=e=>{if(X.fileType){if(!le[X.fileType].some((l=>{if(e.includes(l))return!0})))return void b({type:"error",message:"当前类型不支持使用"})}X.multiple?W.value.push(e):W.value=e,$.value=!1},te=async()=>{!W.value||X.multiple?(await oe(),$.value=!0):W.value=""},oe=async()=>{const e=await E({page:A.value,pageSize:M.value,...D.value});0===e.code&&(ee.value=e.data.list,F.value=e.data.total,A.value=e.data.page,M.value=e.data.pageSize)};return(n,v)=>{const f=x,E=j,le=e("VideoPlay"),se=d,re=z,ue=e("CircleClose"),ie=_,ne=C;return l(),a("div",null,[X.multiple?(l(),a("div",N,[(l(!0),a(g,null,y(W.value,((e,a)=>(l(),o(O,{key:a,model:e,onChooseItem:te,onDeleteItem:e=>(e=>{W.value.splice(e,1)})(a)},null,8,["model","onDeleteItem"])))),128)),W.value.length<X.maxUpdateCount||0===X.maxUpdateCount?(l(),o(O,{key:0,onChooseItem:te,onDeleteItem:te})):u("",!0)])):(l(),o(O,{key:0,model:W.value,onChooseItem:te,onDeleteItem:te},null,8,["model"])),r(ne,{modelValue:$.value,"onUpdate:modelValue":v[1]||(v[1]=e=>$.value=e),title:"媒体库",size:"650px"},{default:s((()=>[r(P,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),i("div",Q,[r(S,{"image-common":p.value,onOnSuccess:oe},null,8,["image-common"]),r(B,{"image-url":m.value,"file-size":512,"max-w-h":1080,onOnSuccess:oe},null,8,["image-url"]),r(f,{modelValue:D.value.keyword,"onUpdate:modelValue":v[0]||(v[0]=e=>D.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"]),r(E,{type:"primary",icon:"search",onClick:oe},{default:s((()=>v[2]||(v[2]=[c(" 查询 ")]))),_:1})]),i("div",q,[(l(!0),a(g,null,y(ee.value,((e,n)=>(l(),a("div",{key:n,class:"w-40"},[i("div",G,[(l(),o(re,{key:n,src:t(V)(e.url),fit:"cover",class:"w-full h-full relative",onClick:l=>ae(e.url)},{error:s((()=>[t(I)(e.url||"")?(l(),o(se,{key:0,size:32,class:"absolute top-[calc(50%-16px)] left-[calc(50%-16px)]"},{default:s((()=>[r(le)])),_:1})):u("",!0),t(I)(e.url||"")?(l(),a("video",{key:1,class:"w-full h-full object-cover",muted:"",preload:"metadata",onClick:l=>ae(e.url)},[i("source",{src:t(V)(e.url)+"#t=1"},null,8,J),v[3]||(v[3]=c(" 您的浏览器不支持视频播放 "))],8,H)):(l(),a("div",K,[r(se,{size:32},{default:s((()=>[r(t(h))])),_:1})]))])),_:2},1032,["src","onClick"])),i("div",{class:"absolute -right-1 top-1 w-8 h-8 group-hover:inline-block hidden",onClick:l=>(e=>{k.confirm("是否删除该文件","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await U(e)).code&&(b({type:"success",message:"删除成功!"}),oe())})).catch((()=>{b({type:"info",message:"已取消删除"})}))})(e)},[r(se,{size:16},{default:s((()=>[r(ue)])),_:1})],8,L)]),i("div",{class:"overflow-hidden text-nowrap overflow-ellipsis text-center w-full",onClick:l=>(async e=>{k.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:l})=>{e.name=l,0===(await T(e)).code&&(b({type:"success",message:"编辑成功!"}),oe())})).catch((()=>{b({type:"info",message:"取消修改"})}))})(e)},w(e.name),9,R)])))),128))]),r(ie,{"current-page":A.value,"page-size":M.value,total:F.value,style:{"justify-content":"center"},layout:"total, prev, pager, next, jumper",onCurrentChange:Z,onSizeChange:Y},null,8,["current-page","page-size","total"])])),_:1},8,["modelValue"])])}}};export{W as _};
