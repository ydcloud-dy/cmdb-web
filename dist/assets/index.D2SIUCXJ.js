/*! 
 Build based on  
 Time : 1735190558000 */
import{a as e,q as a,o as l,c as o,b as t,e as i,w as s,F as r,v as u,h as n,g as d,t as m,f as p,i as c,E as v,k as f}from"./index.ABWJOL2Q.js";import{E as g}from"./pagination.BfYt3rvk.js";/* empty css            */import{E as b,a as y}from"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              */import{E as j}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";/* empty css                    *//* empty css                     */import{E as w,a as h}from"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                *//* empty css             *//* empty css               */import{a as _,E as V}from"./form-item.ujPiwBAF.js";import{l as k,c as x,d as C}from"./network.CeBFTVYV.js";import{g as I}from"./host.9Piocw2G.js";import{E as z}from"./index.DglrVZRl.js";import{b as U,a as E}from"./index.DINKPDpR.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./index.D4uEcQv3.js";import"./index.BRjlB3m5.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./refs.CZv2DkwS.js";import"./_initCloneObject.jmqS1x-g.js";import"./_baseClone.gl1e0kmI.js";const S={class:"dycloud-form-box"},P={style:{"margin-bottom":"20px",display:"inline-block"}},A={class:"dialog-footer"},R={slot:"footer",class:"dialog-footer"},q={class:"dycloud-pagination"},F={name:"Network"},H=Object.assign(F,{setup(F){const H=e(1),M=e(0),N=e(10),O=e=>{N.value=e,G()},D=e=>{H.value=e,G()},Y=e({name:""}),B=e([]),G=async()=>{const e=await k(oe.value,{page:H.value,pageSize:N.value,name:Y.value.name});0===e.code&&(M.value=e.data.total,H.value=e.data.page,N.value=e.data.pageSize,B.value=e.data.items)},J=e({name:"",driver:"bridge",ipam:{driver:"",config:{}}}),K=e(!1),L=async()=>{K.value=!1},Q=async()=>{if(""===J.value.name)return;0===(await x(oe.value,J.value)).code&&(L(),J.value={name:"",driver:"bridge",ipam:{driver:"",config:{}}},G())},T=e([]),W=e=>{T.value=e},X=async()=>{const e=[];0!==T.value.length?(T.value&&T.value.map((a=>{e.push(a.id)})),$.value.Ids=e,Z.value=!0):c({type:"warning",message:"请选择要删除的数据"})},Z=e(!1),$=e({Ids:[]}),ee=async()=>{Z.value=!1},ae=async()=>{0===(await C(oe.value,$.value)).code&&(c({type:"success",message:"删除成功"}),ee(),$.value.Ids=[],G())},le=e([]),oe=e("host"),te=e=>{oe.value=e,window.localStorage.setItem("currentHost",e),ie()},ie=()=>{G()};return a((()=>{(()=>{const e=window.localStorage.getItem("currentHost");e&&(oe.value=e)})(),(async()=>{le.value=[];const e=await I({pageSize:1e4});if(0===e.code)for(let a=0;a<e.data.list.length;a++)le.value.push({value:e.data.list[a].name,label:e.data.list[a].name})})(),ie()})),(e,a)=>{const c=b,k=y,x=_,C=v,I=f,F=V,ie=w,se=z,re=h,ue=U,ne=E,de=j,me=g;return l(),o("div",S,[t("div",P,[i(F,{inline:!0,model:Y.value},{default:s((()=>[i(x,{label:"主机:"},{default:s((()=>[i(k,{modelValue:oe.value,"onUpdate:modelValue":a[0]||(a[0]=e=>oe.value=e),onChange:te,placeholder:"请选择主机"},{default:s((()=>[(l(!0),o(r,null,u(le.value,(e=>(l(),n(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(x,null,{default:s((()=>[i(C,{type:"primary",icon:"plus",onClick:a[1]||(a[1]=e=>(async()=>{K.value=!0})())},{default:s((()=>a[12]||(a[12]=[d("创建网络")]))),_:1})])),_:1}),i(x,null,{default:s((()=>[i(C,{icon:"delete",style:{"margin-left":"10px"},disabled:!T.value.length,onClick:X},{default:s((()=>a[13]||(a[13]=[d("批量删除")]))),_:1},8,["disabled"])])),_:1}),i(x,null,{default:s((()=>[i(I,{modelValue:Y.value.name,"onUpdate:modelValue":a[2]||(a[2]=e=>Y.value.name=e),class:"search-input",placeholder:"输入网络名称"},null,8,["modelValue"]),i(C,{style:{"margin-left":"20px"},type:"primary",icon:"search",onClick:a[3]||(a[3]=e=>(async()=>{H.value=1,N.value=10,G()})(Y.value.name))},{default:s((()=>a[14]||(a[14]=[d("查询 ")]))),_:1})])),_:1})])),_:1},8,["model"])]),i(re,{data:B.value,style:{color:"#ffffff"},"row-key":"id",onSelectionChange:W},{default:s((()=>[i(ie,{type:"selection",width:"55"}),i(ie,{label:"网络名称",prop:"name"},{default:s((e=>[d(m(e.row.name)+" ",1),"bridge"===e.row.name||"host"===e.row.name||"none"===e.row.name?(l(),n(se,{key:0,type:"danger","disable-transitions":""},{default:s((()=>a[15]||(a[15]=[d("系统")]))),_:1})):p("",!0)])),_:1}),i(ie,{label:"网络驱动",prop:"driver"}),i(ie,{label:"IPAM 驱动",prop:"ipam.driver"}),i(ie,{label:"IPAM IPv4 子网",prop:"ipam.config.subnet"}),i(ie,{label:"IPAM IPv4 网关",prop:"ipam.config.gateway"}),i(ie,{label:"创建时间",prop:"created",sortable:""}),i(ie,{label:"操作"},{default:s((e=>["bridge"!==e.row.name&&"host"!==e.row.name&&"none"!==e.row.name?(l(),n(C,{key:0,type:"danger",icon:"delete-filled",round:"",onClick:a=>(async e=>{$.value.Ids=[e.id],Z.value=!0})(e.row)},null,8,["onClick"])):p("",!0)])),_:1})])),_:1},8,["data"]),i(de,{modelValue:K.value,"onUpdate:modelValue":a[10]||(a[10]=e=>K.value=e),title:"创建网络",width:"500px","show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},{footer:s((()=>[t("div",A,[i(C,{onClick:L},{default:s((()=>a[16]||(a[16]=[d("取 消")]))),_:1}),i(C,{type:"primary",onClick:Q},{default:s((()=>a[17]||(a[17]=[d("确 定")]))),_:1})])])),default:s((()=>[i(F,{ref:"addNetworkFrom",rules:e.rules,model:J.value,"label-width":"120px"},{default:s((()=>[i(x,{label:"网络名称:",prop:"name",rules:[{required:!0,message:"网络名称不能为空"}]},{default:s((()=>[i(I,{modelValue:J.value.name,"onUpdate:modelValue":a[4]||(a[4]=e=>J.value.name=e),placeholder:"my network",style:{width:"240px"}},null,8,["modelValue"])])),_:1}),i(x,{label:"网络驱动:",prop:"driver"},{default:s((()=>[i(ne,{modelValue:J.value.driver,"onUpdate:modelValue":a[5]||(a[5]=e=>J.value.driver=e)},{default:s((()=>[i(ue,{label:"bridge"}),i(ue,{label:"ipvlan"}),i(ue,{label:"macvlan"}),i(ue,{label:"overlay"})])),_:1},8,["modelValue"])])),_:1}),i(x,{label:"子网地址:",prop:"ipam"},{default:s((()=>[i(I,{modelValue:J.value.ipam.config.subnet,"onUpdate:modelValue":a[6]||(a[6]=e=>J.value.ipam.config.subnet=e),placeholder:"示例: 172.20.0.0/16",style:{width:"200px"},size:"small"},null,8,["modelValue"])])),_:1}),i(x,{label:"网关地址:",prop:"ipam"},{default:s((()=>[i(I,{modelValue:J.value.ipam.config.gateway,"onUpdate:modelValue":a[7]||(a[7]=e=>J.value.ipam.config.gateway=e),placeholder:"示例: 172.20.10.11",style:{width:"200px"},size:"small"},null,8,["modelValue"])])),_:1}),i(x,{label:"IP范围:"},{default:s((()=>[i(I,{modelValue:J.value.ipam.config.ipRange,"onUpdate:modelValue":a[8]||(a[8]=e=>J.value.ipam.config.ipRange=e),placeholder:"示例: 172.20.10.128/25",style:{width:"200px"},size:"small"},null,8,["modelValue"])])),_:1}),"macvlan"===J.value.driver?(l(),n(x,{key:0,label:"网络接口:"},{default:s((()=>[i(I,{modelValue:J.value.ipam.config.ipRange,"onUpdate:modelValue":a[9]||(a[9]=e=>J.value.ipam.config.ipRange=e),placeholder:"示例: eth0",style:{width:"170px"},size:"small"},null,8,["modelValue"])])),_:1})):p("",!0)])),_:1},8,["rules","model"])])),_:1},8,["modelValue"]),i(de,{modelValue:Z.value,"onUpdate:modelValue":a[11]||(a[11]=e=>Z.value=e),title:"是否确定删除?",width:"300px","show-close":!1},{default:s((()=>[t("div",R,[i(C,{type:"primary",onClick:ae},{default:s((()=>a[18]||(a[18]=[d("是")]))),_:1}),i(C,{onClick:ee},{default:s((()=>a[19]||(a[19]=[d("否")]))),_:1})])])),_:1},8,["modelValue"]),t("div",q,[i(me,{"current-page":H.value,"page-size":N.value,"page-sizes":[10,30,50,100],total:M.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:D,onSizeChange:O},null,8,["current-page","page-size","total"])])])}}});export{H as default};
