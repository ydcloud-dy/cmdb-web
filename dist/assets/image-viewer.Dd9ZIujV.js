/*! 
 Build based on  
 Time : 1735190558000 */
import{bd as e,D as a,ao as t,c9 as n,af as l,y as s,cU as o,cV as i,cW as c,G as r,z as u,a$ as d,a as v,cX as f,aZ as m,H as p,R as g,a1 as y,q as b,o as k,h as w,w as x,e as h,aE as z,b as C,n as _,B as I,K as O,b0 as S,O as N,f as E,Q as L,b9 as T,c as R,F as A,cd as Y,bR as B,cY as j,cz as M,ax as X,cZ as F,c_ as $,v as P,S as D,T as V,J as W,C as Z,ai as q,aC as G,cL as H,L as K,cG as J,a_ as Q,cF as U,ae as ee,a8 as ae,t as te,aY as ne,aV as le,am as se,c$ as oe,d0 as ie}from"./index.ABWJOL2Q.js";import{E as ce}from"./index.BRjlB3m5.js";import{d as re}from"./debounce.CkdGDwJt.js";import{i as ue}from"./position.DTC6E8em.js";function de(a,t,n){var l=!0,s=!0;if("function"!=typeof a)throw new TypeError("Expected a function");return e(n)&&(l="leading"in n?!!n.leading:l,s="trailing"in n?!!n.trailing:s),re(a,t,{leading:l,maxWait:t,trailing:s})}const ve=a({urlList:{type:t(Array),default:()=>n([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:t(String)}}),fe={close:()=>!0,switch:e=>l(e),rotate:e=>l(e)},me=s({name:"ElImageViewer"});const pe=K(Z(s({...me,props:ve,emits:fe,setup(e,{expose:a,emit:t}){var n;const l=e,s={CONTAIN:{name:"contain",icon:o(i)},ORIGINAL:{name:"original",icon:o(c)}},{t:Z}=r(),K=u("image-viewer"),{nextZIndex:J}=d(),Q=v(),U=v([]),ee=f(),ae=v(!0),te=v(l.initialIndex),ne=m(s.CONTAIN),le=v({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),se=v(null!=(n=l.zIndex)?n:J()),oe=p((()=>{const{urlList:e}=l;return e.length<=1})),ie=p((()=>0===te.value)),re=p((()=>te.value===l.urlList.length-1)),ue=p((()=>l.urlList[te.value])),ve=p((()=>[K.e("btn"),K.e("prev"),K.is("disabled",!l.infinite&&ie.value)])),fe=p((()=>[K.e("btn"),K.e("next"),K.is("disabled",!l.infinite&&re.value)])),me=p((()=>{const{scale:e,deg:a,offsetX:t,offsetY:n,enableTransition:l}=le.value;let o=t/e,i=n/e;const c=a*Math.PI/180,r=Math.cos(c),u=Math.sin(c);o=o*r+i*u,i=i*r-t/e*u;const d={transform:"scale(".concat(e,") rotate(").concat(a,"deg) translate(").concat(o,"px, ").concat(i,"px)"),transition:l?"transform .3s":""};return ne.value.name===s.CONTAIN.name&&(d.maxWidth=d.maxHeight="100%"),d}));function pe(){ee.stop(),t("close")}function ge(){ae.value=!1}function ye(e){ae.value=!1,e.target.alt=Z("el.image.error")}function be(e){if(ae.value||0!==e.button||!Q.value)return;le.value.enableTransition=!1;const{offsetX:a,offsetY:t}=le.value,n=e.pageX,l=e.pageY,s=de((e=>{le.value={...le.value,offsetX:a+e.pageX-n,offsetY:t+e.pageY-l}})),o=G(document,"mousemove",s);G(document,"mouseup",(()=>{o()})),e.preventDefault()}function ke(){le.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function we(){if(ae.value)return;const e=H(s),a=Object.values(s),t=ne.value.name,n=(a.findIndex((e=>e.name===t))+1)%e.length;ne.value=s[e[n]],ke()}function xe(e){const a=l.urlList.length;te.value=(e+a)%a}function he(){ie.value&&!l.infinite||xe(te.value-1)}function ze(){re.value&&!l.infinite||xe(te.value+1)}function Ce(e,a={}){if(ae.value)return;const{minScale:n,maxScale:s}=l,{zoomRate:o,rotateDeg:i,enableTransition:c}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":le.value.scale>n&&(le.value.scale=Number.parseFloat((le.value.scale/o).toFixed(3)));break;case"zoomIn":le.value.scale<s&&(le.value.scale=Number.parseFloat((le.value.scale*o).toFixed(3)));break;case"clockwise":le.value.deg+=i,t("rotate",le.value.deg);break;case"anticlockwise":le.value.deg-=i,t("rotate",le.value.deg)}le.value.enableTransition=c}function _e(e){var a;"pointer"===(null==(a=e.detail)?void 0:a.focusReason)&&e.preventDefault()}function Ie(){l.closeOnPressEscape&&pe()}return g(ue,(()=>{y((()=>{const e=U.value[0];(null==e?void 0:e.complete)||(ae.value=!0)}))})),g(te,(e=>{ke(),t("switch",e)})),b((()=>{!function(){const e=de((e=>{switch(e.code){case q.esc:l.closeOnPressEscape&&pe();break;case q.space:we();break;case q.left:he();break;case q.up:Ce("zoomIn");break;case q.right:ze();break;case q.down:Ce("zoomOut")}})),a=de((e=>{Ce((e.deltaY||e.deltaX)<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})}));ee.run((()=>{G(document,"keydown",e),G(document,"wheel",a)}))}()})),a({setActiveItem:xe}),(e,a)=>(k(),w(I(ce),{to:"body",disabled:!e.teleported},{default:x((()=>[h(z,{name:"viewer-fade",appear:""},{default:x((()=>[C("div",{ref_key:"wrapper",ref:Q,tabindex:-1,class:_(I(K).e("wrapper")),style:O({zIndex:se.value})},[h(I(S),{loop:"",trapped:"","focus-trap-el":Q.value,"focus-start-el":"container",onFocusoutPrevented:_e,onReleaseRequested:Ie},{default:x((()=>[C("div",{class:_(I(K).e("mask")),onClick:N((a=>e.hideOnClickModal&&pe()),["self"])},null,10,["onClick"]),E(" CLOSE "),C("span",{class:_([I(K).e("btn"),I(K).e("close")]),onClick:pe},[h(I(L),null,{default:x((()=>[h(I(T))])),_:1})],2),E(" ARROW "),I(oe)?E("v-if",!0):(k(),R(A,{key:0},[C("span",{class:_(I(ve)),onClick:he},[h(I(L),null,{default:x((()=>[h(I(Y))])),_:1})],2),C("span",{class:_(I(fe)),onClick:ze},[h(I(L),null,{default:x((()=>[h(I(B))])),_:1})],2)],64)),E(" ACTIONS "),C("div",{class:_([I(K).e("btn"),I(K).e("actions")])},[C("div",{class:_(I(K).e("actions__inner"))},[h(I(L),{onClick:e=>Ce("zoomOut")},{default:x((()=>[h(I(j))])),_:1},8,["onClick"]),h(I(L),{onClick:e=>Ce("zoomIn")},{default:x((()=>[h(I(M))])),_:1},8,["onClick"]),C("i",{class:_(I(K).e("actions__divider"))},null,2),h(I(L),{onClick:we},{default:x((()=>[(k(),w(X(I(ne).icon)))])),_:1}),C("i",{class:_(I(K).e("actions__divider"))},null,2),h(I(L),{onClick:e=>Ce("anticlockwise")},{default:x((()=>[h(I(F))])),_:1},8,["onClick"]),h(I(L),{onClick:e=>Ce("clockwise")},{default:x((()=>[h(I($))])),_:1},8,["onClick"])],2)],2),E(" CANVAS "),C("div",{class:_(I(K).e("canvas"))},[(k(!0),R(A,null,P(e.urlList,((a,t)=>D((k(),R("img",{ref_for:!0,ref:e=>U.value[t]=e,key:a,src:a,style:O(I(me)),class:_(I(K).e("img")),crossorigin:e.crossorigin,onLoad:ge,onError:ye,onMousedown:be},null,46,["src","crossorigin"])),[[V,t===te.value]]))),128))],2),W(e.$slots,"default")])),_:3},8,["focus-trap-el"])],6)])),_:3})])),_:3},8,["disabled"]))}}),[["__file","image-viewer.vue"]])),ge=a({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:t([String,Object])},previewSrcList:{type:t(Array),default:()=>n([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:t(String)}}),ye={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>l(e),close:()=>!0,show:()=>!0},be=s({name:"ElImage",inheritAttrs:!1});const ke=K(Z(s({...be,props:ge,emits:ye,setup(e,{emit:a}){const t=e;let n="";const{t:l}=r(),s=u("image"),o=J(),i=p((()=>Q(Object.entries(o).filter((([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))))),c=U({excludeListeners:!0,excludeKeys:p((()=>Object.keys(i.value)))}),d=v(),f=v(!1),m=v(!0),h=v(!1),z=v(),O=v(),S=ee&&"loading"in HTMLImageElement.prototype;let N,L;const T=p((()=>[s.e("inner"),B.value&&s.e("preview"),m.value&&s.is("loading")])),Y=p((()=>{const{fit:e}=t;return ee&&e?{objectFit:e}:{}})),B=p((()=>{const{previewSrcList:e}=t;return ae(e)&&e.length>0})),j=p((()=>{const{previewSrcList:e,initialIndex:a}=t;let n=a;return a>e.length-1&&(n=0),n})),M=p((()=>"eager"!==t.loading&&(!S&&"lazy"===t.loading||t.lazy))),X=()=>{ee&&(m.value=!0,f.value=!1,d.value=t.src)};function F(e){m.value=!1,f.value=!1,a("load",e)}function $(e){m.value=!1,f.value=!0,a("error",e)}function P(){ue(z.value,O.value)&&(X(),Z())}const D=ie(P,200,!0);async function V(){var e;if(!ee)return;await y();const{scrollContainer:a}=t;le(a)?O.value=a:se(a)&&""!==a?O.value=null!=(e=document.querySelector(a))?e:void 0:z.value&&(O.value=oe(z.value)),O.value&&(N=G(O,"scroll",D),setTimeout((()=>P()),100))}function Z(){ee&&O.value&&D&&(null==N||N(),O.value=void 0)}function q(e){if(e.ctrlKey)return e.deltaY<0||e.deltaY>0?(e.preventDefault(),!1):void 0}function H(){B.value&&(L=G("wheel",q,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",h.value=!0,a("show"))}function K(){null==L||L(),document.body.style.overflow=n,h.value=!1,a("close")}function ce(e){a("switch",e)}return g((()=>t.src),(()=>{M.value?(m.value=!0,f.value=!1,Z(),V()):X()})),b((()=>{M.value?V():X()})),(e,a)=>(k(),R("div",ne({ref_key:"container",ref:z},I(i),{class:[I(s).b(),e.$attrs.class]}),[f.value?W(e.$slots,"error",{key:0},(()=>[C("div",{class:_(I(s).e("error"))},te(I(l)("el.image.error")),3)])):(k(),R(A,{key:1},[void 0!==d.value?(k(),R("img",ne({key:0},I(c),{src:d.value,loading:e.loading,style:I(Y),class:I(T),crossorigin:e.crossorigin,onClick:H,onLoad:F,onError:$}),null,16,["src","loading","crossorigin"])):E("v-if",!0),m.value?(k(),R("div",{key:1,class:_(I(s).e("wrapper"))},[W(e.$slots,"placeholder",{},(()=>[C("div",{class:_(I(s).e("placeholder"))},null,2)]))],2)):E("v-if",!0)],64)),I(B)?(k(),R(A,{key:2},[h.value?(k(),w(I(pe),{key:0,"z-index":e.zIndex,"initial-index":I(j),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:K,onSwitch:ce},{default:x((()=>[e.$slots.viewer?(k(),R("div",{key:0},[W(e.$slots,"viewer")])):E("v-if",!0)])),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):E("v-if",!0)],64)):E("v-if",!0)],16))}}),[["__file","image.vue"]]));export{ke as E,de as t};
