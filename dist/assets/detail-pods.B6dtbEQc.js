/*! 
 Build based on  
 Time : 1735190558000 */
import{a as e,o as a,c as l,h as t,w as o,e as s,b as u,t as i,F as r,v as n,g as d,f as m,B as c,E as p}from"./index.ABWJOL2Q.js";import{E as v}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";import{E as f,a as y}from"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                *//* empty css               */import"./scrollbar.3ySweVnY.js";import{b as w,E as _,a as k}from"./dropdown-item.Bdep7Ju0.js";/* empty css               *//* empty css            */import{P as g}from"./metrics.Dq7Dbl3h.js";import{P as h,G as b}from"./terminal.CkdZuQYW.js";import{A as j}from"./age.Du5VDnjl.js";import{_ as C,R as x}from"./index.DDa397GF.js";import{P as V}from"./terminal-log.p9WpB3Ej.js";import O from"./monitor.CqRBZu0a.js";import{E as S}from"./index.DglrVZRl.js";const E={class:"span-link"},P={key:0},F={key:0},I={style:{"text-align":"right"}},M={class:"dialog-footer"},T={key:1},U={class:"dialog-footer"},z={style:{"text-align":"right"}},D={key:2},R={class:"dialog-footer"},K={name:"DetailPods"},A=Object.assign(K,{props:{data:{default:function(){return{}},type:Object},selectors:{default:function(){return""},type:String}},setup(K){const A=K,B=e({}),G=e(""),J=e(!1),N=e(""),X=e(!1),q=e(0);(async()=>{B.value=A.data,G.value=A.selectors,q.value=B.value.cluster_id})();const H=e([]);(async()=>{const e=await b({cluster_id:B.value.cluster_id,namespace:B.value.metadata.namespace,labelSelector:G.value});0===e.code&&e.data.items&&(H.value=e.data.items)})();const L=e([]);(async()=>{const e=await g({cluster_id:B.value.cluster_id,namespace:B.value.metadata.namespace,labelSelector:G.value});0===e.code&&(L.value=e.data.items)})();const Q=(e,a)=>{let l="0 m";if(L.value.length>0)for(const t of L.value)if(t.metadata.name===e){let e=0;for(const l of t.containers)"cpu"===a&&(l.usage.cpu.indexOf("n")>-1&&(e+=parseInt(l.usage.cpu)),l.usage.cpu.indexOf("m")>-1&&(e+=1e3*parseInt(l.usage.cpu)*1e3)),"memory"===a&&(l.usage.memory.indexOf("Ki")>-1&&(e+=parseInt(l.usage.memory)),l.usage.memory.indexOf("Mi")>-1&&(e+=1e3*parseInt(l.usage.memory)));const o="cpu"===a?"m":"Mi";l="cpu"===a?(e/1e6).toFixed(2):(e/1e3).toFixed(2),l+=o}return l},W=e(!1),Y=e({}),Z=e(""),$=e(!1),ee=()=>{$.value=!1,W.value=!1,J.value=!1},ae=()=>{J.value?J.value=!1:J.value=!0},le=e({});return(e,g)=>{const b=f,K=S,A=p,G=w,L=_,te=k,oe=y,se=v;return a(),l("div",null,[(a(),t(oe,{key:H.value,data:H.value},{default:o((()=>[s(b,{label:"名称",prop:"name","min-width":"80","show-overflow-tooltip":""},{default:o((e=>[u("span",E,i(e.row.metadata.name),1)])),_:1}),s(b,{label:"镜像","min-width":"120","show-overflow-tooltip":""},{default:o((e=>[(a(!0),l(r,null,n(e.row.spec.containers,((e,t)=>(a(),l("div",{key:t},[s(K,{type:"info",size:"small",style:{display:"flex"}},{default:o((()=>[d(i(e.image),1)])),_:2},1024)])))),128))])),_:1}),s(b,{prop:"status",label:"CPU/内存/TCP",type:"scope",width:"200"},{default:o((e=>[e.row?(a(),l("div",P,[s(C,{data:e.row,cluster_id:q.value},null,8,["data","cluster_id"])])):m("",!0)])),_:1}),s(b,{label:"状态",prop:"status",type:"scope",width:"90"},{default:o((e=>["Succeeded"===e.row.status.phase?(a(),t(K,{key:0,type:"info"},{default:o((()=>g[3]||(g[3]=[d("Completed")]))),_:1})):e.row.metadata.deletionTimestamp?(a(),t(K,{key:1,type:"danger"},{default:o((()=>g[4]||(g[4]=[d("Deleting")]))),_:1})):"Running"===e.row.status.phase?(a(),t(K,{key:2,type:"success"},{default:o((()=>g[5]||(g[5]=[d("Running")]))),_:1})):(a(),t(K,{key:3,type:"danger"},{default:o((()=>[d(i(e.row.status.phase),1)])),_:2},1024))])),_:1}),s(b,{label:"重启次数",prop:"restarts",type:"scope",width:"90"},{default:o((e=>[u("span",null,i(c(x)(e.row.status.containerStatuses)),1)])),_:1}),s(b,{label:"节点","min-width":"40",prop:"spec.nodeName","show-overflow-tooltip":""}),s(b,{label:"Cpu","min-width":"45"},{default:o((e=>[d(i(Q(e.row.metadata.name,"cpu")),1)])),_:1}),s(b,{label:"Memory","min-width":"45"},{default:o((e=>[d(i(Q(e.row.metadata.name,"memory")),1)])),_:1}),s(b,{label:"存活时间","min-width":"40",prop:"metadata.creationTimestamp","show-overflow-tooltip":"",fix:""},{default:o((e=>[d(i(c(j)(e.row.metadata.creationTimestamp)),1)])),_:1}),s(b,{label:"操作"},{default:o((e=>[s(G,null,{default:o((()=>[s(A,{type:"primary",link:"",size:"small",onClick:a=>{return l=e.row,le.value=l,le.value.cluster_id=B.value.cluster_id,void(X.value=!0);var l}},{default:o((()=>g[6]||(g[6]=[d("监控")]))),_:2},1032,["onClick"])])),_:2},1024),s(G,null,{dropdown:o((()=>[s(te,null,{default:o((()=>[(a(!0),l(r,null,n(e.row.spec.containers,((t,u)=>(a(),l("div",{key:u},[s(L,{onClick:a=>{return l=e.row,o=t.name,Y.value=l,N.value="容器组名："+l.metadata.name+" 容器名："+o+" 终端",Y.value.cluster_id=B.value.cluster_id,Z.value=o,void(W.value=!0);var l,o}},{default:o((()=>[d(i(t.name)+" 终端 ",1)])),_:2},1032,["onClick"])])))),128)),(a(!0),l(r,null,n(e.row.spec.containers,((t,u)=>(a(),l("div",{key:u},[s(L,{onClick:a=>{return l=e.row,o=t.name,Y.value=l,N.value="容器组名："+l.metadata.name+" 容器名："+o+" 终端日志",Y.value.cluster_id=B.value.cluster_id,Z.value=o,void($.value=!0);var l,o}},{default:o((()=>[d(i(t.name)+" 终端日志 ",1)])),_:2},1032,["onClick"])])))),128))])),_:2},1024)])),default:o((()=>[s(A,{type:"primary",link:"",size:"small"},{default:o((()=>g[7]||(g[7]=[d("更多")]))),_:1})])),_:2},1024)])),_:1})])),_:1},8,["data"])),W.value?(a(),l("div",F,[s(se,{modelValue:W.value,"onUpdate:modelValue":g[0]||(g[0]=e=>W.value=e),width:"60%",title:N.value,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,fullscreen:J.value,center:!0},{default:o((()=>[u("div",I,[s(A,{type:"primary",link:"",icon:"FullScreen",onClick:ae}),s(A,{type:"primary",link:"",icon:"Close",onClick:ee})]),u("div",M,[s(h,{data:Y.value,name:Z.value,onClose:ee},null,8,["data","name"])])])),_:1},8,["modelValue","title","fullscreen"])])):m("",!0),$.value?(a(),l("div",T,[s(se,{modelValue:$.value,"onUpdate:modelValue":g[1]||(g[1]=e=>$.value=e),width:"60%",title:N.value,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,fullscreen:J.value,center:!0},{default:o((()=>[u("div",U,[u("div",z,[s(A,{type:"primary",link:"",icon:"FullScreen",onClick:ae}),s(A,{type:"primary",link:"",icon:"Close",onClick:ee})]),s(V,{data:Y.value,name:Z.value,onClose:ee},null,8,["data","name"])])])),_:1},8,["modelValue","title","fullscreen"])])):m("",!0),X.value?(a(),l("div",D,[s(se,{ref:"monitor",modelValue:X.value,"onUpdate:modelValue":g[2]||(g[2]=e=>X.value=e),width:"60%",title:N.value},{default:o((()=>[u("div",R,[s(O,{data:le.value},null,8,["data"])])])),_:1},8,["modelValue","title"])])):m("",!0)])}}});export{A as _};
