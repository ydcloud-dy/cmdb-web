/*! 
 Build based on  
 Time : 1735190558000 */
import{_ as e,a as t,R as a,o,c as s,b as r,e as l,w as n,g as u,t as i,K as d,f as c,dC as m,dD as p,i as y,dE as f,a1 as h,k as j,E as k}from"./index.ABWJOL2Q.js";import{E as v}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";import{E as w,a as I}from"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                *//* empty css               */import{E as b}from"./scrollbar.3ySweVnY.js";/* empty css            *//* empty css             *//* empty css               *//* empty css              */import{u as g}from"./authority.Ckl6dsTi.js";import{g as _,s as x}from"./authorityBtn.CNV2FmNx.js";import{E as C}from"./index.HOewoZCo.js";import"./index.BRjlB3m5.js";import"./refs.CZv2DkwS.js";import"./index.D4uEcQv3.js";import"./_Uint8Array.BjvNwsUf.js";import"./_initCloneObject.jmqS1x-g.js";import"./_baseIteratee.BPaQBmlP.js";import"./isEqual.CtpQH3Dm.js";import"./debounce.CkdGDwJt.js";import"./index.6ock-Gvr.js";import"./token.DWNpOE8r.js";import"./index.gYVODlrW.js";const E={class:"sticky top-0.5 z-10"},R={class:"tree-content clear-both"},D={class:"custom-tree-node"},V={key:0},N={key:1},A={class:"dialog-footer"},O=e(Object.assign({name:"Menus"},{__name:"menus",props:{row:{default:function(){return{}},type:Object}},emits:["changeRow"],setup(e,{expose:O,emit:B}){const U=e,S=B,T=t(""),q=t([]),z=t([]),H=t(!1),K=t({children:"children",label:function(e){return e.meta.title},disabled:function(e){return U.row.defaultRouter===e.name}});(async()=>{const e=await m();q.value=e.data.menus;const t=(await p({authorityId:U.row.authorityId})).data.menus,a=[];t.forEach((e=>{t.some((t=>t.parentId===e.menuId))||a.push(Number(e.menuId))})),z.value=a})();const M=()=>{H.value=!0},Y=t(null),Z=async()=>{const e=Y.value.getCheckedNodes(!1,!0);0===(await f({menus:e,authorityId:U.row.authorityId})).code&&y({type:"success",message:"菜单设置成功!"})};O({enterAndNext:()=>{Z()},needConfirm:H});const F=t(!1),G=t([]),J=t([]),L=t();let P="";const Q=e=>{J.value=e},W=e=>{F.value=!0,G.value=e.menuBtn},X=()=>{F.value=!1},$=async()=>{const e=J.value.map((e=>e.ID));0===(await x({menuID:P,selected:e,authorityId:U.row.authorityId})).code&&(y({type:"success",message:"设置成功"}),F.value=!1)},ee=(e,t)=>!e||-1!==t.meta.title.indexOf(e);return a(T,(e=>{Y.value.filter(e)})),(t,a)=>{const m=j,p=k,f=C,x=b,O=w,B=I,H=v;return o(),s("div",null,[r("div",E,[l(m,{modelValue:T.value,"onUpdate:modelValue":a[0]||(a[0]=e=>T.value=e),class:"w-3/5",placeholder:"筛选"},null,8,["modelValue"]),l(p,{class:"float-right",type:"primary",onClick:Z},{default:n((()=>a[2]||(a[2]=[u("确 定")]))),_:1})]),r("div",R,[l(x,null,{default:n((()=>[l(f,{ref_key:"menuTree",ref:Y,data:q.value,"default-checked-keys":z.value,props:K.value,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":"","filter-node-method":ee,onCheck:M},{default:n((({node:t,data:m})=>[r("span",D,[r("span",null,i(t.label),1),t.checked?(o(),s("span",V,[l(p,{type:"primary",link:"",style:d({color:e.row.defaultRouter===m.name?"#E6A23C":"#85ce61"}),onClick:()=>(async e=>{const t=await g({authorityId:U.row.authorityId,AuthorityName:U.row.authorityName,parentId:U.row.parentId,defaultRouter:e.name});0===t.code&&(y({type:"success",message:"设置成功"}),S("changeRow","defaultRouter",t.data.authority.defaultRouter))})(m)},{default:n((()=>[u(i(e.row.defaultRouter===m.name?"首页":"设为首页"),1)])),_:2},1032,["style","onClick"])])):c("",!0),m.menuBtn.length?(o(),s("span",N,[l(p,{type:"primary",link:"",onClick:()=>(async e=>{P=e.ID;const t=await _({menuID:P,authorityId:U.row.authorityId});0===t.code&&(W(e),await h(),t.data.selected&&t.data.selected.forEach((e=>{G.value.some((t=>{t.ID===e&&L.value.toggleRowSelection(t,!0)}))})))})(m)},{default:n((()=>a[3]||(a[3]=[u(" 分配按钮 ")]))),_:2},1032,["onClick"])])):c("",!0)])])),_:1},8,["data","default-checked-keys","props"])])),_:1})]),l(H,{modelValue:F.value,"onUpdate:modelValue":a[1]||(a[1]=e=>F.value=e),title:"分配按钮","destroy-on-close":""},{footer:n((()=>[r("div",A,[l(p,{onClick:X},{default:n((()=>a[4]||(a[4]=[u("取 消")]))),_:1}),l(p,{type:"primary",onClick:$},{default:n((()=>a[5]||(a[5]=[u("确 定")]))),_:1})])])),default:n((()=>[l(B,{ref_key:"btnTableRef",ref:L,data:G.value,"row-key":"ID",onSelectionChange:Q},{default:n((()=>[l(O,{type:"selection",width:"55"}),l(O,{label:"按钮名称",prop:"name"}),l(O,{label:"按钮备注",prop:"desc"})])),_:1},8,["data"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-4d144d5c"]]);export{O as default};
