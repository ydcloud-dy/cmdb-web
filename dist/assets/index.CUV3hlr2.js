/*! 
 Build based on  
 Time : 1735190558000 */
import{a as e,o as a,c as l,b as s,e as t,w as o,g as i,f as r,i as n,k as u,E as d}from"./index.ABWJOL2Q.js";import{E as m}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";import{E as p}from"./pagination.BfYt3rvk.js";/* empty css            */import"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              */import{E as c}from"./popover.DFR01WU1.js";/* empty css             *//* empty css               */import{a as v,E as g}from"./form-item.ujPiwBAF.js";import{g as y,d as j,a as f,b,c as h,u as k}from"./buildEnv.vyGXBGni.js";import w from"./form.BhTDchlQ.js";import _ from"./table.BeXvU7Xx.js";import{s as x}from"./cloud_region.DtcSymib.js";import"./index.BRjlB3m5.js";import"./refs.CZv2DkwS.js";import"./index.D4uEcQv3.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./index.DglrVZRl.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./dropdown.Co_mIot6.js";import"./_baseClone.gl1e0kmI.js";import"./_initCloneObject.jmqS1x-g.js";import"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                */import"./dayjs.min.DOWqlKAh.js";import"./stringFun.hIDu-B3o.js";const z={class:"dycloud-search-box"},C={class:"dycloud-table-box"},E={class:"dycloud-btn-list"},V={style:{"text-align":"right","margin-top":"8px"}},T={key:0},D={class:"dycloud-pagination"},I={key:0},U={name:"Index"},S=Object.assign(U,{setup(U){const S=e({}),H=e(1),F=e(0),A=e(10),O=e([]),q=e(""),B=e({}),G=e(!1),J=e([]),L=e([]),M=()=>{B.value={}},N=e=>{B.value=e,P()},R=()=>{H.value=1,A.value=10,P()},$=e=>{A.value=e,P()},K=e=>{H.value=e,P()},P=async()=>{const e=await y({page:H.value,pageSize:A.value,keyword:B.value.name});0===e.code&&(O.value=e.data.list,F.value=e.data.total,H.value=e.data.page,A.value=e.data.pageSize)};P();const Q=e(!1),W=e(""),X=async e=>{const a=await j(e.ID);if(W.value="update",q.value="更新",0===a.code){const e=a.data;S.value={ID:e.ID,name:e.name,image:e.image,command:e.command,args:e.args,desc:e.desc},Q.value=!0}},Y=async e=>{0===(await x({id:e.id})).code&&(n({type:"success",message:"操作成功"}),P())},Z=()=>{Q.value=!1,S.value={}},ee=async e=>{e.visible=!1;0===(await f(e.ID)).code&&(n({type:"success",message:"删除成功"}),1===O.value.length&&H.value>1&&H.value--,P())},ae=e=>{J.value=e},le=async()=>{const e=J.value.map((e=>e.ID)),a=await b({ids:e});0===a.code&&(n({type:"success",message:a.msg}),O.value.length===e.length&&H.value>1&&H.value--,G.value=!1,P())},se=async e=>{let a;switch("kubernetes"===e.type?(e.type=0,e.config={type:0,conf:"config"===e.authType?e.conf:void 0,url:"token"===e.authType?e.url:void 0,token:"token"===e.authType?e.kubeToken:void 0},delete e.conf,delete e.url,delete e.kubeToken):"registry"===e.type&&(e.type=1,e.config={url:e.registryUrl,username:e.username,password:e.password,isHttps:e.isHttps},delete e.registryUrl,delete e.username,delete e.password,delete e.isHttps),delete e.authType,W.value){case"create":default:a=await h(e);break;case"update":a=await k(e)}0===a.code&&(Z(),(async e=>{0===e.code&&(n({type:"success",message:e.msg}),1===O.value.length&&H.value>1&&H.value--,P())})(a))},te=async e=>{const a=await TestService(e);0===a.code&&n({type:"success",message:a.data})};return(e,n)=>{const y=u,j=v,f=d,b=g,h=c,k=p,x=m;return a(),l("div",null,[s("div",z,[t(b,{ref:"searchForm",inline:!0,model:B.value},{default:o((()=>[t(j,{label:"名称"},{default:o((()=>[t(y,{modelValue:B.value.name,"onUpdate:modelValue":n[0]||(n[0]=e=>B.value.name=e),placeholder:"名称"},null,8,["modelValue"])])),_:1}),t(j,null,{default:o((()=>[t(f,{size:"small",type:"primary",icon:"search",onClick:R},{default:o((()=>n[6]||(n[6]=[i("查询")]))),_:1}),t(f,{size:"small",icon:"refresh",onClick:M},{default:o((()=>n[7]||(n[7]=[i("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),s("div",C,[s("div",E,[t(f,{size:"small",type:"primary",icon:"plus",onClick:n[1]||(n[1]=e=>(W.value="create",q.value="创建",S.value={name:"",image:"",command:"",args:"",desc:""},void(Q.value=!0)))},{default:o((()=>n[8]||(n[8]=[i("新增")]))),_:1}),t(h,{modelValue:G.value,"onUpdate:modelValue":n[4]||(n[4]=e=>G.value=e),placement:"top",width:"160"},{reference:o((()=>[t(f,{icon:"delete",size:"small",disabled:!J.value.length,style:{"margin-left":"10px"},onClick:n[3]||(n[3]=e=>G.value=!0)},{default:o((()=>n[11]||(n[11]=[i("删除")]))),_:1},8,["disabled"])])),default:o((()=>[n[12]||(n[12]=s("p",null,"确定要删除吗？",-1)),s("div",V,[t(f,{size:"small",type:"primary",link:"",onClick:n[2]||(n[2]=e=>G.value=!1)},{default:o((()=>n[9]||(n[9]=[i("取消")]))),_:1}),t(f,{size:"small",type:"primary",onClick:le},{default:o((()=>n[10]||(n[10]=[i("确定")]))),_:1})])])),_:1},8,["modelValue"])]),O.value?(a(),l("div",T,[t(_,{"table-data":O.value,onUpdate:X,onSearch:N,onTest:te,onSelect:ae,onDelete:ee,onRegion:Y},null,8,["table-data"])])):r("",!0)]),s("div",D,[t(k,{"current-page":H.value,"page-size":A.value,"page-sizes":[10,30,50,100],total:F.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:K,onSizeChange:$},null,8,["current-page","page-size","total"])]),Q.value?(a(),l("div",I,[t(x,{modelValue:Q.value,"onUpdate:modelValue":n[5]||(n[5]=e=>Q.value=e),width:"40%",title:q.value,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},{default:o((()=>[t(w,{form:S.value,regions:L.value,onClose:Z,type:W.value,onEnter:se},null,8,["form","regions","type"])])),_:1},8,["modelValue","title"])])):r("",!0)])}}});export{S as default};
