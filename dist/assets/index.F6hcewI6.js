/*! 
 Build based on  
 Time : 1735190558000 */
import{a as e,o as a,c as l,b as t,e as s,w as o,g as i,f as r,i as u,cu as d,k as m,E as n}from"./index.ABWJOL2Q.js";import{E as c}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";import{E as p}from"./pagination.BfYt3rvk.js";/* empty css            */import"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              *//* empty css             *//* empty css               */import{a as v,E as j}from"./form-item.ujPiwBAF.js";import{P as f,G as g,c as y,b as _,f as k,d as w}from"./terminal.CkdZuQYW.js";import{P as b,E as x}from"./detail.12K7B398.js";import{g as C}from"./k8s.DUZ1Kw0R.js";import{_ as V}from"./index.CLE9PzC_.js";import{F as h}from"./files.U5RRtO1D.js";import E from"./table.CufN8tN-.js";import z from"./monitor.CqRBZu0a.js";import{P as U}from"./terminal-log.p9WpB3Ej.js";import"./index.BRjlB3m5.js";import"./refs.CZv2DkwS.js";import"./index.D4uEcQv3.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./index.DglrVZRl.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./_baseClone.gl1e0kmI.js";import"./_initCloneObject.jmqS1x-g.js";import"./xterm.BR7SOqRe.js";/* empty css              */import"./xterm-addon-fit.onOJMBm7.js";import"./tab-pane.fs024GHS.js";import"./index.C5gbd99D.js";import"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                */import"./monaco-editor-vue3.es.BmYKexe9.js";import"./js-yaml.B_ZKWvuw.js";import"./link.QK3LjIND.js";import"./upload.-Ej7EZzx.js";import"./progress.KCbgDfe_.js";import"./cloneDeep.BwH6oqGn.js";import"./dropdown-item.Bdep7Ju0.js";import"./dropdown.Co_mIot6.js";import"./index.DDa397GF.js";import"./index.DrIIbIcU.js";import"./metrics.Dq7Dbl3h.js";import"./age.Du5VDnjl.js";import"./date-picker.CCiP3Fyg.js";import"./dayjs.min.DOWqlKAh.js";import"./arrays.CvpzyGiz.js";import"./index.7ugBSK5z.js";const P={class:"dycloud-table-box"},S={class:"dycloud-btn-list"},F={key:0},I={class:"dycloud-pagination"},D={key:0},N={class:"dialog-footer"},O={key:1},T={class:"dialog-footer"},A={key:2},B={style:{"text-align":"right"}},L={class:"dialog-footer"},M={key:3},q={class:"dialog-footer"},G={style:{"text-align":"right"}},H={key:4},J={class:"dialog-footer"},K={key:5},R={class:"dialog-footer"},X={name:"Pods"},Q=Object.assign(X,{setup(X){const Q=e({}),W=e(1),Y=e(0),Z=e(10),$=e([]),ee=e(""),ae=e({keywords:"",namespace:""}),le=e(!1),te=e(!1),se=()=>{ae.value.keywords=""},oe=()=>{W.value=1,Z.value=10,ue()},ie=e=>{Z.value=e,ue()},re=e=>{W.value=e,ue()},ue=async()=>{const e=await g({cluster_id:ae.value.cluster_id,page:W.value,pageSize:Z.value,namespace:ae.value.namespace,keyword:ae.value.keywords});0===e.code&&($.value=e.data.items,Y.value=e.data.total,W.value=e.data.page,Z.value=e.data.pageSize)},de=e(!1),me=e(""),ne=async e=>{me.value="update",ee.value="编辑";const a=await y({cluster_id:ae.value.cluster_id,namespace:e.metadata.namespace,podName:e.metadata.name});a.data.items&&a.data.items.code?u({type:"error",message:a.data.items.message}):0===a.code&&(Q.value=a.data.items,de.value=!0)},ce=()=>{de.value=!1,we.value=!1,ge.value=!1,Q.value={},le.value=!1},pe=async e=>{e.visible=!1,d.confirm("您确定要删除  "+e.metadata.name+" Pod？, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const a=await _({cluster_id:ae.value.cluster_id,namespace:e.metadata.namespace,podName:e.metadata.name});a.data.items&&a.data.items.code?u({type:"error",message:a.data.items.message}):0===a.code&&(u({type:"success",message:"删除成功"}),ue())})).catch((()=>{u({type:"info",message:"已取消删除!"})}))},ve=async e=>{let a;switch(me.value){case"create":a=await k({cluster_id:ae.value.cluster_id,namespace:e.metadata.namespace,content:e});break;case"update":a=await w({cluster_id:ae.value.cluster_id,namespace:e.metadata.namespace,podName:e.metadata.name,content:e});break;default:a=await k({cluster_id:ae.value.cluster_id,content:e})}a.data.items&&a.data.items.code?u({type:"error",message:a.data.items.message}):0===a.code&&(ce(),(async e=>{0===e.code&&(u({type:"success",message:e.msg}),ue())})(a))},je=e(!1),fe=async e=>{Q.value=e,Q.value.cluster_id=ae.value.cluster_id;const a=await x({cluster_id:ae.value.cluster_id,fieldSelector:"involvedObject.name="+e.metadata.name,namespace:e.metadata.namespace});a.data.items&&a.data.items.code?u({type:"error",message:a.data.items.message}):(0===a.code&&(Q.value.events=a.data.items),ee.value="详情",je.value=!0)},ge=e(!1),ye=e({}),_e=e(""),ke=(e,a)=>{ye.value=e,ee.value="容器组名："+e.metadata.name+" 容器名："+a+" 终端",ye.value.cluster_id=ae.value.cluster_id,_e.value=a,ge.value=!0},we=e(!1),be=(e,a)=>{ye.value=e,ee.value="容器组名："+e.metadata.name+" 容器名："+a+" 终端日志",ye.value.cluster_id=ae.value.cluster_id,_e.value=a,we.value=!0},xe=()=>{le.value?le.value=!1:le.value=!0},Ce=(e,a)=>{ee.value="Pod: "+e.metadata.name+" Container: "+a+"  文件浏览",Q.value=e,Q.value.cluster_id=ae.value.cluster_id,Q.value.container_name=a,te.value=!0},Ve=e(!1),he=e=>{ee.value="Pod 名称: "+e.metadata.name,Q.value=e,Q.value.cluster_id=ae.value.cluster_id,Ve.value=!0};return window.addEventListener("setItemCluster",(e=>{ae.value.cluster_id=parseInt(localStorage.getItem("cluster_id"))})),window.addEventListener("setItemNamespace",(e=>{ae.value.namespace=localStorage.getItem("namespace"),ue()})),(e,u)=>{const d=m,g=v,y=n,_=j,k=p,w=c;return a(),l("div",null,[t("div",P,[t("div",S,[s(_,{ref:"searchForm",inline:!0,model:ae.value},{default:o((()=>[s(g,{label:"名称"},{default:o((()=>[s(d,{modelValue:ae.value.keywords,"onUpdate:modelValue":u[0]||(u[0]=e=>ae.value.keywords=e),placeholder:"名称"},null,8,["modelValue"])])),_:1}),s(g,null,{default:o((()=>[s(y,{size:"small",type:"primary",icon:"search",onClick:oe},{default:o((()=>u[8]||(u[8]=[i("查询")]))),_:1}),s(y,{size:"small",icon:"refresh",onClick:se},{default:o((()=>u[9]||(u[9]=[i("重置")]))),_:1})])),_:1}),s(g,null,{default:o((()=>[s(y,{size:"small",type:"primary",icon:"plus",onClick:u[1]||(u[1]=e=>(me.value="create",ee.value="创建",Q.value=C("pods",ae.value.namespace,""),void(de.value=!0)))},{default:o((()=>u[10]||(u[10]=[i("新增")]))),_:1})])),_:1})])),_:1},8,["model"])]),$.value?(a(),l("div",F,[s(E,{"table-data":$.value,cluster_id:ae.value.cluster_id,onTerminal:ke,onTerminallog:be,onUpdate:ne,onDetail:fe,onDelete:pe,onMonitor:he,onFiles:Ce},null,8,["table-data","cluster_id"])])):r("",!0)]),t("div",I,[s(k,{"current-page":W.value,"page-size":Z.value,"page-sizes":[10,30,50,100],total:Y.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:re,onSizeChange:ie},null,8,["current-page","page-size","total"])]),de.value?(a(),l("div",D,[s(w,{modelValue:de.value,"onUpdate:modelValue":u[2]||(u[2]=e=>de.value=e),width:"60%",title:ee.value},{default:o((()=>[t("div",N,[s(V,{data:Q.value,onClose:ce,onEnter:ve},null,8,["data"])])])),_:1},8,["modelValue","title"])])):r("",!0),je.value?(a(),l("div",O,[s(w,{modelValue:je.value,"onUpdate:modelValue":u[3]||(u[3]=e=>je.value=e),width:"60%",title:ee.value},{default:o((()=>[t("div",T,[s(b,{data:Q.value,onClose:ce,onEnter:ve},null,8,["data"])])])),_:1},8,["modelValue","title"])])):r("",!0),ge.value?(a(),l("div",A,[s(w,{modelValue:ge.value,"onUpdate:modelValue":u[4]||(u[4]=e=>ge.value=e),width:"60%",title:ee.value,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,fullscreen:le.value,center:!0},{default:o((()=>[t("div",B,[s(y,{type:"primary",link:"",icon:"FullScreen",onClick:xe}),s(y,{type:"primary",link:"",icon:"Close",onClick:ce})]),t("div",L,[s(f,{data:ye.value,name:_e.value,onClose:ce},null,8,["data","name"])])])),_:1},8,["modelValue","title","fullscreen"])])):r("",!0),we.value?(a(),l("div",M,[s(w,{modelValue:we.value,"onUpdate:modelValue":u[5]||(u[5]=e=>we.value=e),width:"60%",title:ee.value,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,fullscreen:le.value,center:!0},{default:o((()=>[t("div",q,[t("div",G,[s(y,{type:"primary",link:"",icon:"FullScreen",onClick:xe}),s(y,{type:"primary",link:"",icon:"Close",onClick:ce})]),s(U,{data:ye.value,name:_e.value,onClose:ce},null,8,["data","name"])])])),_:1},8,["modelValue","title","fullscreen"])])):r("",!0),Ve.value?(a(),l("div",H,[s(w,{ref:"monitor",modelValue:Ve.value,"onUpdate:modelValue":u[6]||(u[6]=e=>Ve.value=e),width:"60%",title:ee.value},{default:o((()=>[t("div",J,[s(z,{data:Q.value,onClose:ce},null,8,["data"])])])),_:1},8,["modelValue","title"])])):r("",!0),te.value?(a(),l("div",K,[s(w,{ref:"files",modelValue:te.value,"onUpdate:modelValue":u[7]||(u[7]=e=>te.value=e),width:"70%",title:ee.value},{default:o((()=>[t("div",R,[s(h,{form:Q.value,onClose:ce},null,8,["form"])])])),_:1},8,["modelValue","title"])])):r("",!0)])}}});export{Q as default};
