/*! 
 Build based on  
 Time : 1735190558000 */
import{s as e,a,o as t,c as s,b as o,e as l,w as i,g as r,f as c,i as u,k as d,E as m}from"./index.ABWJOL2Q.js";import{E as n}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";import{E as p}from"./pagination.BfYt3rvk.js";/* empty css            */import"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              *//* empty css             *//* empty css               */import{a as v,E as j}from"./form-item.ujPiwBAF.js";import{g as y}from"./k8s.DUZ1Kw0R.js";import{_ as g}from"./index.CLE9PzC_.js";import b from"./table.Bw2KK1Rr.js";import"./index.BRjlB3m5.js";import"./refs.CZv2DkwS.js";import"./index.D4uEcQv3.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./index.DglrVZRl.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./_baseClone.gl1e0kmI.js";import"./_initCloneObject.jmqS1x-g.js";import"./monaco-editor-vue3.es.BmYKexe9.js";import"./js-yaml.B_ZKWvuw.js";import"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                */import"./popover.DFR01WU1.js";import"./dropdown.Co_mIot6.js";import"./age.Du5VDnjl.js";const f=e=>"/kubernetes/proxy/".concat(e,"/apis/policy/v1beta1/podsecuritypolicies"),w=(e,a)=>"/kubernetes/proxy/".concat(e,"/apis/policy/v1beta1/podsecuritypolicies"),_=(a,t,s)=>e({url:"".concat(w(a),"/").concat(s),method:"get"}),k=(a,t,s)=>e({url:"".concat(w(a)),method:"post",data:s}),h={class:"dycloud-table-box"},x={class:"dycloud-btn-list"},z={key:0},C={class:"dycloud-pagination"},E={key:0},S={class:"dialog-footer"},V={name:"PodSecurityPolicies"},I=Object.assign(V,{setup(V){const I=a({}),U=a(1),A=a(0),D=a(10),F=a([]),L=a(""),O=a({keywords:"",namespace:""}),P=a(!1),q=()=>{O.value.keywords=""},H=()=>{U.value=1,D.value=10,B()},M=e=>{D.value=e,B()},N=e=>{U.value=e,B()},B=async()=>{const a=await((a,t,s,o,l,i)=>e(o&&"All Namespaces"!==o?{url:"".concat(w(a),"?search=true&keywords=").concat(l,"&page=").concat(t,"&pageSize=").concat(s,"&labelSelector=").concat(i),method:"get"}:{url:"".concat(f(a),"?search=true&keywords=").concat(l,"&page=").concat(t,"&pageSize=").concat(s),method:"get"}))(O.value.cluster_id,U.value,D.value,O.value.namespace,O.value.keywords,"");0===a.code&&(F.value=a.data.items,A.value=a.data.total,U.value=a.data.page,D.value=a.data.pageSize)},G=a(!1),J=a(""),K=async e=>{J.value="update",L.value="编辑";const a=await _(O.value.cluster_id,e.metadata.namespace,e.metadata.name);0===a.code&&(I.value=a.data.items,P.value=!1,G.value=!0)},Q=()=>{G.value=!1,I.value={}},R=async a=>{a.visible=!1;const t=await(s=O.value.cluster_id,a.metadata.namespace,o=a.metadata.name,e({url:"".concat(w(s),"/").concat(o),method:"delete"}));var s,o;t.data.items&&t.data.items.code?u({type:"error",message:t.data.items.message}):0===t.code&&(u({type:"success",message:"删除成功"}),B())},T=async a=>{let t;switch(J.value){case"create":t=await k(O.value.cluster_id,a.metadata.namespace,a);break;case"update":t=await(s=O.value.cluster_id,a.metadata.namespace,o=a.metadata.name,l=a,e({url:"".concat(w(s),"/").concat(o),method:"put",data:l}));break;default:t=await k(O.value.cluster_id)}var s,o,l;t.data.items&&t.data.items.code?u({type:"error",message:t.data.items.message}):0===t.code&&(Q(),(async e=>{0===e.code&&(u({type:"success",message:e.msg}),B())})(t))},W=async e=>{const a=await _(O.value.cluster_id,e.metadata.namespace,e.metadata.name);0===a.code&&(L.value="详情",I.value=a.data.items,P.value=!0,G.value=!0)};return window.addEventListener("setItemCluster",(e=>{O.value.cluster_id=parseInt(localStorage.getItem("cluster_id")),B()})),(e,a)=>{const u=d,f=v,w=m,_=j,k=p,V=n;return t(),s("div",null,[o("div",h,[o("div",x,[l(_,{ref:"searchForm",inline:!0,model:O.value},{default:i((()=>[l(f,{label:"名称"},{default:i((()=>[l(u,{modelValue:O.value.keywords,"onUpdate:modelValue":a[0]||(a[0]=e=>O.value.keywords=e),placeholder:"名称"},null,8,["modelValue"])])),_:1}),l(f,null,{default:i((()=>[l(w,{size:"small",type:"primary",icon:"search",onClick:H},{default:i((()=>a[3]||(a[3]=[r("查询")]))),_:1}),l(w,{size:"small",icon:"refresh",onClick:q},{default:i((()=>a[4]||(a[4]=[r("重置")]))),_:1})])),_:1}),l(f,null,{default:i((()=>[l(w,{size:"small",type:"primary",icon:"plus",onClick:a[1]||(a[1]=e=>(J.value="create",L.value="创建",I.value=y("podsecuritypolicies",O.value.namespace,""),P.value=!1,void(G.value=!0)))},{default:i((()=>a[5]||(a[5]=[r("新增")]))),_:1})])),_:1})])),_:1},8,["model"])]),F.value?(t(),s("div",z,[l(b,{"table-data":F.value,onUpdate:K,onDetail:W,onDelete:R},null,8,["table-data"])])):c("",!0)]),o("div",C,[l(k,{"current-page":U.value,"page-size":D.value,"page-sizes":[10,30,50,100],total:A.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:N,onSizeChange:M},null,8,["current-page","page-size","total"])]),G.value?(t(),s("div",E,[l(V,{modelValue:G.value,"onUpdate:modelValue":a[2]||(a[2]=e=>G.value=e),width:"60%",title:L.value},{default:i((()=>[o("div",S,[l(g,{data:I.value,"read-only":P.value,onClose:Q,onEnter:T},null,8,["data","read-only"])])])),_:1},8,["modelValue","title"])])):c("",!0)])}}});export{I as default};
