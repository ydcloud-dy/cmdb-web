/*! 
 Build based on  
 Time : 1735190558000 */
!function(){function e(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e=function(){return i};var t,i={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,i){e[t]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function h(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(t){h=function(e,t,i){return e[t]=i}}function u(e,t,i,r){var n=t&&t.prototype instanceof y?t:y,a=Object.create(n.prototype),s=new T(r||[]);return o(a,"_invoke",{value:E(e,i,s)}),a}function d(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}i.wrap=u;var v="suspendedStart",f="suspendedYield",_="executing",g="completed",p={};function y(){}function m(){}function C(){}var w={};h(w,s,(function(){return this}));var L=Object.getPrototypeOf,x=L&&L(L(D([])));x&&x!==r&&n.call(x,s)&&(w=x);var b=C.prototype=y.prototype=Object.create(w);function R(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){function i(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}var r;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,r){i(e,n,t,r)}))}return r=r?r.then(o,o):o()}})}function E(e,i,r){var n=v;return function(o,a){if(n===_)throw Error("Generator is already running");if(n===g){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var c=A(s,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===v)throw n=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=_;var l=d(e,i,r);if("normal"===l.type){if(n=r.done?g:f,l.arg===p)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=g,r.method="throw",r.arg=l.arg)}}}function A(e,i){var r=i.method,n=e.iterator[r];if(n===t)return i.delegate=null,"throw"===r&&e.iterator.return&&(i.method="return",i.arg=t,A(e,i),"throw"===i.method)||"return"!==r&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=d(n,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,p;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,p):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,p)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function D(e){if(e||""===e){var i=e[s];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function i(){for(;++r<e.length;)if(n.call(e,r))return i.value=e[r],i.done=!1,i;return i.value=t,i.done=!0,i};return o.next=o}}throw new TypeError(typeof e+" is not iterable")}return m.prototype=C,o(b,"constructor",{value:C,configurable:!0}),o(C,"constructor",{value:m,configurable:!0}),m.displayName=h(C,l,"GeneratorFunction"),i.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,h(e,l,"GeneratorFunction")),e.prototype=Object.create(b),e},i.awrap=function(e){return{__await:e}},R(M.prototype),h(M.prototype,c,(function(){return this})),i.AsyncIterator=M,i.async=function(e,t,r,n,o){void 0===o&&(o=Promise);var a=new M(u(e,t,r,n),o);return i.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},R(b),h(b,l,"Generator"),h(b,s,(function(){return this})),h(b,"toString",(function(){return"[object Generator]"})),i.keys=function(e){var t=Object(e),i=[];for(var r in t)i.push(r);return i.reverse(),function e(){for(;i.length;){var r=i.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},i.values=D,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function r(r,n){return s.type="throw",s.arg=e,i.next=r,n&&(i.method="next",i.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),S(i),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;S(i)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,i,r){return this.delegate={iterator:D(e),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=t),p}},i}function t(e,t,i,r,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void i(e)}s.done?t(c):Promise.resolve(c).then(r,n)}function i(e){return function(){var i=this,r=arguments;return new Promise((function(n,o){var a=e.apply(i,r);function s(e){t(a,n,o,s,c,"next",e)}function c(e){t(a,n,o,s,c,"throw",e)}s(void 0)}))}}function r(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(){return n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}},n.apply(null,arguments)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],c=!0,l=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;c=!1}else for(;!(c=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,n=e}finally{try{if(!c&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(l)throw n}}return s}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t,i){return t=l(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}(e,c()?Reflect.construct(t,i||[],l(e).constructor):t.apply(e,i))}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(c=function(){return!!e})()}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function d(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=v(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function v(e,t){if(e){if("string"==typeof e)return f(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function p(e,t,i){return t&&g(e.prototype,t),i&&g(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}System.register(["./index-legacy.Cf1_fyJw.js","./loading-legacy.BUHuF_Gy.js","./tag-legacy.Ca3_ouli.js","./select-legacy.L6EZLrW8.js","./scrollbar-legacy.dKZTD6w2.js","./popper-legacy.BkTYt---.js","./container-legacy.Do1bKGj4.js","./xterm-legacy.C7iTxYx2.js","./xterm-addon-fit-legacy.BgFhqBhw.js","./xterm-legacy.CncnO5QC.js","./index-legacy.CjsCdAav.js","./index-legacy.DGP8eUsx.js","./index-legacy.DPmmO7_J.js","./token-legacy.D8ssuuq3.js","./strings-legacy.Wo7ipnce.js","./castArray-legacy.Dek4eNNY.js","./isEqual-legacy.wQ-Y-8LH.js","./_Uint8Array-legacy.CS4Mx2ig.js","./debounce-legacy.Csxk0W50.js","./_baseIteratee-legacy.D0Xxhk8-.js","./index-legacy.DglejgZI.js"],(function(t,c){"use strict";var u,v,f,g,y,m,C,w,L,x,b,R,M,E,A,k,S,T,D,P,O;return{setters:[function(e){u=e.a,v=e.M,f=e.q,g=e.bM,y=e.l,m=e.o,C=e.c,w=e.g,L=e.e,x=e.w,b=e.F,R=e.v,M=e.S,E=e.b,A=e.db},null,null,function(e){k=e.E,S=e.a},null,null,function(e){T=e.f,D=e.g},function(e){P=e.x},function(e){O=e.x},null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var c={exports:{}};!function(e){var t;self,e.exports=(t={},function(){var e=t;function i(e,t,i){return e.addEventListener(t,i),{dispose:function(){i&&e.removeEventListener(t,i)}}}Object.defineProperty(e,"__esModule",{value:!0}),e.AttachAddon=void 0,e.AttachAddon=function(){function e(t,i){_(this,e),this._disposables=[],this._socket=t,this._socket.binaryType="arraybuffer",this._bidirectional=!(i&&!1===i.bidirectional)}return p(e,[{key:"activate",value:function(e){var t=this;this._disposables.push(i(this._socket,"message",(function(t){var i=t.data;e.write("string"==typeof i?i:new Uint8Array(i))}))),this._bidirectional&&(this._disposables.push(e.onData((function(e){return t._sendData(e)}))),this._disposables.push(e.onBinary((function(e){return t._sendBinary(e)})))),this._disposables.push(i(this._socket,"close",(function(){return t.dispose()}))),this._disposables.push(i(this._socket,"error",(function(){return t.dispose()})))}},{key:"dispose",value:function(){var e,t=d(this._disposables);try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(i){t.e(i)}finally{t.f()}}},{key:"_sendData",value:function(e){this._checkOpenSocket()&&this._socket.send(e)}},{key:"_sendBinary",value:function(e){if(this._checkOpenSocket()){for(var t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);this._socket.send(t)}}},{key:"_checkOpenSocket",value:function(){switch(this._socket.readyState){case WebSocket.OPEN:return!0;case WebSocket.CONNECTING:throw new Error("Attach addon was loaded before socket was open");case WebSocket.CLOSING:return!1;case WebSocket.CLOSED:throw new Error("Attach addon socket is closed");default:throw new Error("Unexpected socket state")}}}])}()}(),t)}(c);var F=c.exports,B={exports:{}};!function(e){self,e.exports=function(){var e={965:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphRenderer=void 0;var n,o=i(374),s=i(509),c=i(855),l=i(859),u=i(776),v=i(381),f=11,g=f*Float32Array.BYTES_PER_ELEMENT,y=0,m=0,C=0,w=function(e){function t(e,i,r){var n;_(this,t),(n=a(this,t))._terminal=e,n._gl=i,n._dimensions=r,n._activeBuffer=0,n._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};var c=n._gl;void 0===s.TextureAtlas.maxAtlasPages&&(s.TextureAtlas.maxAtlasPages=Math.min(32,(0,o.throwIfFalsy)(c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS))),s.TextureAtlas.maxTextureSize=(0,o.throwIfFalsy)(c.getParameter(c.MAX_TEXTURE_SIZE))),n._program=(0,o.throwIfFalsy)((0,v.createProgram)(c,"#version 300 es\nlayout (location = 0) in vec2 a_unitquad;\nlayout (location = 1) in vec2 a_cellpos;\nlayout (location = 2) in vec2 a_offset;\nlayout (location = 3) in vec2 a_size;\nlayout (location = 4) in float a_texpage;\nlayout (location = 5) in vec2 a_texcoord;\nlayout (location = 6) in vec2 a_texsize;\n\nuniform mat4 u_projection;\nuniform vec2 u_resolution;\n\nout vec2 v_texcoord;\nflat out int v_texpage;\n\nvoid main() {\n  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_texpage = int(a_texpage);\n  v_texcoord = a_texcoord + a_unitquad * a_texsize;\n}",function(e){for(var t="",i=1;i<e;i++)t+=" else if (v_texpage == ".concat(i,") { outColor = texture(u_texture[").concat(i,"], v_texcoord); }");return"#version 300 es\nprecision lowp float;\n\nin vec2 v_texcoord;\nflat in int v_texpage;\n\nuniform sampler2D u_texture[".concat(e,"];\n\nout vec4 outColor;\n\nvoid main() {\n  if (v_texpage == 0) {\n    outColor = texture(u_texture[0], v_texcoord);\n  } ").concat(t,"\n}")}(s.TextureAtlas.maxAtlasPages))),n.register((0,l.toDisposable)((function(){return c.deleteProgram(n._program)}))),n._projectionLocation=(0,o.throwIfFalsy)(c.getUniformLocation(n._program,"u_projection")),n._resolutionLocation=(0,o.throwIfFalsy)(c.getUniformLocation(n._program,"u_resolution")),n._textureLocation=(0,o.throwIfFalsy)(c.getUniformLocation(n._program,"u_texture")),n._vertexArrayObject=c.createVertexArray(),c.bindVertexArray(n._vertexArrayObject);var h=new Float32Array([0,0,1,0,0,1,1,1]),u=c.createBuffer();n.register((0,l.toDisposable)((function(){return c.deleteBuffer(u)}))),c.bindBuffer(c.ARRAY_BUFFER,u),c.bufferData(c.ARRAY_BUFFER,h,c.STATIC_DRAW),c.enableVertexAttribArray(0),c.vertexAttribPointer(0,2,n._gl.FLOAT,!1,0,0);var d=new Uint8Array([0,1,2,3]),f=c.createBuffer();n.register((0,l.toDisposable)((function(){return c.deleteBuffer(f)}))),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,f),c.bufferData(c.ELEMENT_ARRAY_BUFFER,d,c.STATIC_DRAW),n._attributesBuffer=(0,o.throwIfFalsy)(c.createBuffer()),n.register((0,l.toDisposable)((function(){return c.deleteBuffer(n._attributesBuffer)}))),c.bindBuffer(c.ARRAY_BUFFER,n._attributesBuffer),c.enableVertexAttribArray(2),c.vertexAttribPointer(2,2,c.FLOAT,!1,g,0),c.vertexAttribDivisor(2,1),c.enableVertexAttribArray(3),c.vertexAttribPointer(3,2,c.FLOAT,!1,g,2*Float32Array.BYTES_PER_ELEMENT),c.vertexAttribDivisor(3,1),c.enableVertexAttribArray(4),c.vertexAttribPointer(4,1,c.FLOAT,!1,g,4*Float32Array.BYTES_PER_ELEMENT),c.vertexAttribDivisor(4,1),c.enableVertexAttribArray(5),c.vertexAttribPointer(5,2,c.FLOAT,!1,g,5*Float32Array.BYTES_PER_ELEMENT),c.vertexAttribDivisor(5,1),c.enableVertexAttribArray(6),c.vertexAttribPointer(6,2,c.FLOAT,!1,g,7*Float32Array.BYTES_PER_ELEMENT),c.vertexAttribDivisor(6,1),c.enableVertexAttribArray(1),c.vertexAttribPointer(1,2,c.FLOAT,!1,g,9*Float32Array.BYTES_PER_ELEMENT),c.vertexAttribDivisor(1,1),c.useProgram(n._program);for(var p=new Int32Array(s.TextureAtlas.maxAtlasPages),y=0;y<s.TextureAtlas.maxAtlasPages;y++)p[y]=y;c.uniform1iv(n._textureLocation,p),c.uniformMatrix4fv(n._projectionLocation,!1,v.PROJECTION_MATRIX),n._atlasTextures=[];for(var m=function(){var e=new v.GLTexture((0,o.throwIfFalsy)(c.createTexture()));n.register((0,l.toDisposable)((function(){return c.deleteTexture(e.texture)}))),c.activeTexture(c.TEXTURE0+C),c.bindTexture(c.TEXTURE_2D,e.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),n._atlasTextures[C]=e},C=0;C<s.TextureAtlas.maxAtlasPages;C++)m();return c.enable(c.BLEND),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),n.handleResize(),n}return h(t,e),p(t,[{key:"beginFrame",value:function(){return!this._atlas||this._atlas.beginFrame()}},{key:"updateCell",value:function(e,t,i,r,n,o,a,s){this._updateCell(this._vertices.attributes,e,t,i,r,n,o,a,s)}},{key:"_updateCell",value:function(e,t,i,r,o,a,s,l,h){y=(i*this._terminal.cols+t)*f,r!==c.NULL_CELL_CODE&&void 0!==r?this._atlas&&(n=l&&l.length>1?this._atlas.getRasterizedGlyphCombinedChar(l,o,a,s,!1):this._atlas.getRasterizedGlyph(r,o,a,s,!1),m=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),o!==h&&n.offset.x>m?(C=n.offset.x-m,e[y]=-(n.offset.x-C)+this._dimensions.device.char.left,e[y+1]=-n.offset.y+this._dimensions.device.char.top,e[y+2]=(n.size.x-C)/this._dimensions.device.canvas.width,e[y+3]=n.size.y/this._dimensions.device.canvas.height,e[y+4]=n.texturePage,e[y+5]=n.texturePositionClipSpace.x+C/this._atlas.pages[n.texturePage].canvas.width,e[y+6]=n.texturePositionClipSpace.y,e[y+7]=n.sizeClipSpace.x-C/this._atlas.pages[n.texturePage].canvas.width,e[y+8]=n.sizeClipSpace.y):(e[y]=-n.offset.x+this._dimensions.device.char.left,e[y+1]=-n.offset.y+this._dimensions.device.char.top,e[y+2]=n.size.x/this._dimensions.device.canvas.width,e[y+3]=n.size.y/this._dimensions.device.canvas.height,e[y+4]=n.texturePage,e[y+5]=n.texturePositionClipSpace.x,e[y+6]=n.texturePositionClipSpace.y,e[y+7]=n.sizeClipSpace.x,e[y+8]=n.sizeClipSpace.y)):e.fill(0,y,y+f-1-2)}},{key:"clear",value:function(){var e=this._terminal,t=e.cols*e.rows*f;this._vertices.count!==t?this._vertices.attributes=new Float32Array(t):this._vertices.attributes.fill(0);for(var i=0;i<this._vertices.attributesBuffers.length;i++)this._vertices.count!==t?this._vertices.attributesBuffers[i]=new Float32Array(t):this._vertices.attributesBuffers[i].fill(0);this._vertices.count=t,i=0;for(var r=0;r<e.rows;r++)for(var n=0;n<e.cols;n++)this._vertices.attributes[i+9]=n/e.cols,this._vertices.attributes[i+10]=r/e.rows,i+=f}},{key:"handleResize",value:function(){var e=this._gl;e.useProgram(this._program),e.viewport(0,0,e.canvas.width,e.canvas.height),e.uniform2f(this._resolutionLocation,e.canvas.width,e.canvas.height),this.clear()}},{key:"render",value:function(e){if(this._atlas){var t=this._gl;t.useProgram(this._program),t.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;for(var i=this._vertices.attributesBuffers[this._activeBuffer],r=0,n=0;n<e.lineLengths.length;n++){var o=n*this._terminal.cols*f,a=this._vertices.attributes.subarray(o,o+e.lineLengths[n]*f);i.set(a,r),r+=a.length}t.bindBuffer(t.ARRAY_BUFFER,this._attributesBuffer),t.bufferData(t.ARRAY_BUFFER,i.subarray(0,r),t.STREAM_DRAW);for(var s=0;s<this._atlas.pages.length;s++)this._atlas.pages[s].version!==this._atlasTextures[s].version&&this._bindAtlasPageTexture(t,this._atlas,s);t.drawElementsInstanced(t.TRIANGLE_STRIP,4,t.UNSIGNED_BYTE,0,r/f)}}},{key:"setAtlas",value:function(e){this._atlas=e;var t,i=d(this._atlasTextures);try{for(i.s();!(t=i.n()).done;)t.value.version=-1}catch(r){i.e(r)}finally{i.f()}}},{key:"_bindAtlasPageTexture",value:function(e,t,i){e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,this._atlasTextures[i].texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.pages[i].canvas),e.generateMipmap(e.TEXTURE_2D),this._atlasTextures[i].version=t.pages[i].version}},{key:"setDimensions",value:function(e){this._dimensions=e}}])}(l.Disposable);t.GlyphRenderer=w,r([u.traceCall],w.prototype,"updateCell",null)},742:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleRenderer=void 0;var r=i(374),n=i(859),o=i(310),s=i(381),c=8*Float32Array.BYTES_PER_ELEMENT,l=p((function e(){_(this,e),this.attributes=new Float32Array(160),this.count=0})),u=0,d=0,v=0,f=0,g=0,y=0,m=0,C=function(e){function t(e,i,o,h){var u;_(this,t),(u=a(this,t))._terminal=e,u._gl=i,u._dimensions=o,u._themeService=h,u._vertices=new l,u._verticesCursor=new l;var d=u._gl;u._program=(0,r.throwIfFalsy)((0,s.createProgram)(d,"#version 300 es\nlayout (location = 0) in vec2 a_position;\nlayout (location = 1) in vec2 a_size;\nlayout (location = 2) in vec4 a_color;\nlayout (location = 3) in vec2 a_unitquad;\n\nuniform mat4 u_projection;\n\nout vec4 v_color;\n\nvoid main() {\n  vec2 zeroToOne = a_position + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_color = a_color;\n}","#version 300 es\nprecision lowp float;\n\nin vec4 v_color;\n\nout vec4 outColor;\n\nvoid main() {\n  outColor = v_color;\n}")),u.register((0,n.toDisposable)((function(){return d.deleteProgram(u._program)}))),u._projectionLocation=(0,r.throwIfFalsy)(d.getUniformLocation(u._program,"u_projection")),u._vertexArrayObject=d.createVertexArray(),d.bindVertexArray(u._vertexArrayObject);var v=new Float32Array([0,0,1,0,0,1,1,1]),f=d.createBuffer();u.register((0,n.toDisposable)((function(){return d.deleteBuffer(f)}))),d.bindBuffer(d.ARRAY_BUFFER,f),d.bufferData(d.ARRAY_BUFFER,v,d.STATIC_DRAW),d.enableVertexAttribArray(3),d.vertexAttribPointer(3,2,u._gl.FLOAT,!1,0,0);var g=new Uint8Array([0,1,2,3]),p=d.createBuffer();return u.register((0,n.toDisposable)((function(){return d.deleteBuffer(p)}))),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,p),d.bufferData(d.ELEMENT_ARRAY_BUFFER,g,d.STATIC_DRAW),u._attributesBuffer=(0,r.throwIfFalsy)(d.createBuffer()),u.register((0,n.toDisposable)((function(){return d.deleteBuffer(u._attributesBuffer)}))),d.bindBuffer(d.ARRAY_BUFFER,u._attributesBuffer),d.enableVertexAttribArray(0),d.vertexAttribPointer(0,2,d.FLOAT,!1,c,0),d.vertexAttribDivisor(0,1),d.enableVertexAttribArray(1),d.vertexAttribPointer(1,2,d.FLOAT,!1,c,2*Float32Array.BYTES_PER_ELEMENT),d.vertexAttribDivisor(1,1),d.enableVertexAttribArray(2),d.vertexAttribPointer(2,4,d.FLOAT,!1,c,4*Float32Array.BYTES_PER_ELEMENT),d.vertexAttribDivisor(2,1),u._updateCachedColors(h.colors),u.register(u._themeService.onChangeColors((function(e){u._updateCachedColors(e),u._updateViewportRectangle()}))),u}return h(t,e),p(t,[{key:"renderBackgrounds",value:function(){this._renderVertices(this._vertices)}},{key:"renderCursor",value:function(){this._renderVertices(this._verticesCursor)}},{key:"_renderVertices",value:function(e){var t=this._gl;t.useProgram(this._program),t.bindVertexArray(this._vertexArrayObject),t.uniformMatrix4fv(this._projectionLocation,!1,s.PROJECTION_MATRIX),t.bindBuffer(t.ARRAY_BUFFER,this._attributesBuffer),t.bufferData(t.ARRAY_BUFFER,e.attributes,t.DYNAMIC_DRAW),t.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,t.UNSIGNED_BYTE,0,e.count)}},{key:"handleResize",value:function(){this._updateViewportRectangle()}},{key:"setDimensions",value:function(e){this._dimensions=e}},{key:"_updateCachedColors",value:function(e){this._bgFloat=this._colorToFloat32Array(e.background),this._cursorFloat=this._colorToFloat32Array(e.cursor)}},{key:"_updateViewportRectangle",value:function(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}},{key:"updateBackgrounds",value:function(e){var t,i,r,n,a,s,c,l,h,u,d,v=this._terminal,f=this._vertices,_=1;for(t=0;t<v.rows;t++){for(r=-1,n=0,a=0,s=!1,i=0;i<v.cols;i++)c=(t*v.cols+i)*o.RENDER_MODEL_INDICIES_PER_CELL,l=e.cells[c+o.RENDER_MODEL_BG_OFFSET],u=!!(67108864&(h=e.cells[c+o.RENDER_MODEL_FG_OFFSET])),(l!==n||h!==a&&(s||u))&&((0!==n||s&&0!==a)&&(d=8*_++,this._updateRectangle(f,d,a,n,r,i,t)),r=i,n=l,a=h,s=u);(0!==n||s&&0!==a)&&(d=8*_++,this._updateRectangle(f,d,a,n,r,v.cols,t))}f.count=_}},{key:"updateCursor",value:function(e){var t=this._verticesCursor,i=e.cursor;if(i&&"block"!==i.style){var r,n=0;"bar"!==i.style&&"outline"!==i.style||(r=8*n++,this._addRectangleFloat(t.attributes,r,i.x*this._dimensions.device.cell.width,i.y*this._dimensions.device.cell.height,"bar"===i.style?i.dpr*i.cursorWidth:i.dpr,this._dimensions.device.cell.height,this._cursorFloat)),"underline"!==i.style&&"outline"!==i.style||(r=8*n++,this._addRectangleFloat(t.attributes,r,i.x*this._dimensions.device.cell.width,(i.y+1)*this._dimensions.device.cell.height-i.dpr,i.width*this._dimensions.device.cell.width,i.dpr,this._cursorFloat)),"outline"===i.style&&(r=8*n++,this._addRectangleFloat(t.attributes,r,i.x*this._dimensions.device.cell.width,i.y*this._dimensions.device.cell.height,i.width*this._dimensions.device.cell.width,i.dpr,this._cursorFloat),r=8*n++,this._addRectangleFloat(t.attributes,r,(i.x+i.width)*this._dimensions.device.cell.width-i.dpr,i.y*this._dimensions.device.cell.height,i.dpr,this._dimensions.device.cell.height,this._cursorFloat)),t.count=n}else t.count=0}},{key:"_updateRectangle",value:function(e,t,i,r,n,o,a){if(67108864&i)switch(50331648&i){case 16777216:case 33554432:u=this._themeService.colors.ansi[255&i].rgba;break;case 50331648:u=(16777215&i)<<8;break;default:u=this._themeService.colors.foreground.rgba}else switch(50331648&r){case 16777216:case 33554432:u=this._themeService.colors.ansi[255&r].rgba;break;case 50331648:u=(16777215&r)<<8;break;default:u=this._themeService.colors.background.rgba}e.attributes.length<t+4&&(e.attributes=(0,s.expandFloat32Array)(e.attributes,this._terminal.rows*this._terminal.cols*8)),d=n*this._dimensions.device.cell.width,v=a*this._dimensions.device.cell.height,f=(u>>24&255)/255,g=(u>>16&255)/255,y=(u>>8&255)/255,m=1,this._addRectangle(e.attributes,t,d,v,(o-n)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,f,g,y,m)}},{key:"_addRectangle",value:function(e,t,i,r,n,o,a,s,c,l){e[t]=i/this._dimensions.device.canvas.width,e[t+1]=r/this._dimensions.device.canvas.height,e[t+2]=n/this._dimensions.device.canvas.width,e[t+3]=o/this._dimensions.device.canvas.height,e[t+4]=a,e[t+5]=s,e[t+6]=c,e[t+7]=l}},{key:"_addRectangleFloat",value:function(e,t,i,r,n,o,a){e[t]=i/this._dimensions.device.canvas.width,e[t+1]=r/this._dimensions.device.canvas.height,e[t+2]=n/this._dimensions.device.canvas.width,e[t+3]=o/this._dimensions.device.canvas.height,e[t+4]=a[0],e[t+5]=a[1],e[t+6]=a[2],e[t+7]=a[3]}},{key:"_colorToFloat32Array",value:function(e){return new Float32Array([(e.rgba>>24&255)/255,(e.rgba>>16&255)/255,(e.rgba>>8&255)/255,(255&e.rgba)/255])}}])}(n.Disposable);t.RectangleRenderer=C},310:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.RenderModel=t.COMBINED_CHAR_BIT_MASK=t.RENDER_MODEL_EXT_OFFSET=t.RENDER_MODEL_FG_OFFSET=t.RENDER_MODEL_BG_OFFSET=t.RENDER_MODEL_INDICIES_PER_CELL=void 0;var r=i(296);t.RENDER_MODEL_INDICIES_PER_CELL=4,t.RENDER_MODEL_BG_OFFSET=1,t.RENDER_MODEL_FG_OFFSET=2,t.RENDER_MODEL_EXT_OFFSET=3,t.COMBINED_CHAR_BIT_MASK=2147483648,t.RenderModel=function(){function e(){_(this,e),this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=(0,r.createSelectionRenderModel)()}return p(e,[{key:"resize",value:function(e,i){var r=e*i*t.RENDER_MODEL_INDICIES_PER_CELL;r!==this.cells.length&&(this.cells=new Uint32Array(r),this.lineLengths=new Uint32Array(i))}},{key:"clear",value:function(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}])}()},666:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.JoinedCellData=t.WebglRenderer=void 0;var n=i(820),s=i(274),c=i(627),l=i(457),u=i(56),v=i(374),f=i(345),g=i(859),y=i(147),m=i(782),C=i(855),w=i(776),L=i(965),x=i(742),b=i(310),R=i(733),M=function(e){function t(e,i,r,l,h,p,y,C,w){var L,x;_(this,t),(x=a(this,t))._terminal=e,x._characterJoinerService=i,x._charSizeService=r,x._coreBrowserService=l,x._coreService=h,x._decorationService=p,x._optionsService=y,x._themeService=C,x._cursorBlinkStateManager=new g.MutableDisposable,x._charAtlasDisposable=x.register(new g.MutableDisposable),x._model=new b.RenderModel,x._workCell=new m.CellData,x._rectangleRenderer=x.register(new g.MutableDisposable),x._glyphRenderer=x.register(new g.MutableDisposable),x._onChangeTextureAtlas=x.register(new f.EventEmitter),x.onChangeTextureAtlas=x._onChangeTextureAtlas.event,x._onAddTextureAtlasCanvas=x.register(new f.EventEmitter),x.onAddTextureAtlasCanvas=x._onAddTextureAtlasCanvas.event,x._onRemoveTextureAtlasCanvas=x.register(new f.EventEmitter),x.onRemoveTextureAtlasCanvas=x._onRemoveTextureAtlasCanvas.event,x._onRequestRedraw=x.register(new f.EventEmitter),x.onRequestRedraw=x._onRequestRedraw.event,x._onContextLoss=x.register(new f.EventEmitter),x.onContextLoss=x._onContextLoss.event,x.register(x._themeService.onChangeColors((function(){return x._handleColorChange()}))),x._cellColorResolver=new s.CellColorResolver(x._terminal,x._model.selection,x._decorationService,x._coreBrowserService,x._themeService),x._core=x._terminal._core,x._renderLayers=[new R.LinkRenderLayer(x._core.screenElement,2,x._terminal,x._core.linkifier2,x._coreBrowserService,y,x._themeService)],x.dimensions=(0,v.createRenderDimensions)(),x._devicePixelRatio=x._coreBrowserService.dpr,x._updateDimensions(),x._updateCursorBlink(),x.register(y.onOptionChange((function(){return x._handleOptionsChanged()}))),x._canvas=document.createElement("canvas");var M={antialias:!1,depth:!1,preserveDrawingBuffer:w};if(x._gl=x._canvas.getContext("webgl2",M),!x._gl)throw new Error("WebGL2 not supported "+x._gl);return x.register((0,n.addDisposableDomListener)(x._canvas,"webglcontextlost",(function(e){e.preventDefault(),x._contextRestorationTimeout=setTimeout((function(){x._contextRestorationTimeout=void 0,x._onContextLoss.fire(e)}),3e3)}))),x.register((0,n.addDisposableDomListener)(x._canvas,"webglcontextrestored",(function(e){clearTimeout(x._contextRestorationTimeout),x._contextRestorationTimeout=void 0,(0,c.removeTerminalFromCache)(x._terminal),x._initializeWebGLState(),x._requestRedrawViewport()}))),x.register((0,u.observeDevicePixelDimensions)(x._canvas,x._coreBrowserService.window,(function(e,t){return x._setCanvasDevicePixelDimensions(e,t)}))),x._core.screenElement.appendChild(x._canvas),L=o(x._initializeWebGLState(),2),x._rectangleRenderer.value=L[0],x._glyphRenderer.value=L[1],x._isAttached=x._coreBrowserService.window.document.body.contains(x._core.screenElement),x.register((0,g.toDisposable)((function(){var e,t,i=d(x._renderLayers);try{for(i.s();!(t=i.n()).done;)t.value.dispose()}catch(r){i.e(r)}finally{i.f()}null===(e=x._canvas.parentElement)||void 0===e||e.removeChild(x._canvas),(0,c.removeTerminalFromCache)(x._terminal)}))),x}return h(t,e),p(t,[{key:"textureAtlas",get:function(){var e;return null===(e=this._charAtlas)||void 0===e?void 0:e.pages[0].canvas}},{key:"_handleColorChange",value:function(){this._refreshCharAtlas(),this._clearModel(!0)}},{key:"handleDevicePixelRatioChange",value:function(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}},{key:"handleResize",value:function(e,t){var i,r,n,o;this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);var a,s=d(this._renderLayers);try{for(s.s();!(a=s.n()).done;)a.value.resize(this._terminal,this.dimensions)}catch(c){s.e(c)}finally{s.f()}this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width="".concat(this.dimensions.css.canvas.width,"px"),this._canvas.style.height="".concat(this.dimensions.css.canvas.height,"px"),this._core.screenElement.style.width="".concat(this.dimensions.css.canvas.width,"px"),this._core.screenElement.style.height="".concat(this.dimensions.css.canvas.height,"px"),null===(i=this._rectangleRenderer.value)||void 0===i||i.setDimensions(this.dimensions),null===(r=this._rectangleRenderer.value)||void 0===r||r.handleResize(),null===(n=this._glyphRenderer.value)||void 0===n||n.setDimensions(this.dimensions),null===(o=this._glyphRenderer.value)||void 0===o||o.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}},{key:"handleCharSizeChanged",value:function(){this.handleResize(this._terminal.cols,this._terminal.rows)}},{key:"handleBlur",value:function(){var e,t,i=d(this._renderLayers);try{for(i.s();!(t=i.n()).done;)t.value.handleBlur(this._terminal)}catch(r){i.e(r)}finally{i.f()}null===(e=this._cursorBlinkStateManager.value)||void 0===e||e.pause(),this._requestRedrawViewport()}},{key:"handleFocus",value:function(){var e,t,i=d(this._renderLayers);try{for(i.s();!(t=i.n()).done;)t.value.handleFocus(this._terminal)}catch(r){i.e(r)}finally{i.f()}null===(e=this._cursorBlinkStateManager.value)||void 0===e||e.resume(),this._requestRedrawViewport()}},{key:"handleSelectionChanged",value:function(e,t,i){var r,n=d(this._renderLayers);try{for(n.s();!(r=n.n()).done;)r.value.handleSelectionChanged(this._terminal,e,t,i)}catch(o){n.e(o)}finally{n.f()}this._model.selection.update(this._terminal,e,t,i),this._requestRedrawViewport()}},{key:"handleCursorMove",value:function(){var e,t,i=d(this._renderLayers);try{for(i.s();!(t=i.n()).done;)t.value.handleCursorMove(this._terminal)}catch(r){i.e(r)}finally{i.f()}null===(e=this._cursorBlinkStateManager.value)||void 0===e||e.restartBlinkAnimation()}},{key:"_handleOptionsChanged",value:function(){this._updateDimensions(),this._refreshCharAtlas(),this._updateCursorBlink()}},{key:"_initializeWebGLState",value:function(){return this._rectangleRenderer.value=new x.RectangleRenderer(this._terminal,this._gl,this.dimensions,this._themeService),this._glyphRenderer.value=new L.GlyphRenderer(this._terminal,this._gl,this.dimensions),this.handleCharSizeChanged(),[this._rectangleRenderer.value,this._glyphRenderer.value]}},{key:"_refreshCharAtlas",value:function(){var e;if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0)this._isAttached=!1;else{var t=(0,c.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr);this._charAtlas!==t&&(this._onChangeTextureAtlas.fire(t.pages[0].canvas),this._charAtlasDisposable.value=(0,g.getDisposeArrayDisposable)([(0,f.forwardEvent)(t.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),(0,f.forwardEvent)(t.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)])),this._charAtlas=t,this._charAtlas.warmUp(),null===(e=this._glyphRenderer.value)||void 0===e||e.setAtlas(this._charAtlas)}}},{key:"_clearModel",value:function(e){var t;this._model.clear(),e&&(null===(t=this._glyphRenderer.value)||void 0===t||t.clear())}},{key:"clearTextureAtlas",value:function(){var e;null===(e=this._charAtlas)||void 0===e||e.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}},{key:"clear",value:function(){var e;this._clearModel(!0);var t,i=d(this._renderLayers);try{for(i.s();!(t=i.n()).done;)t.value.reset(this._terminal)}catch(r){i.e(r)}finally{i.f()}null===(e=this._cursorBlinkStateManager.value)||void 0===e||e.restartBlinkAnimation(),this._updateCursorBlink()}},{key:"registerCharacterJoiner",value:function(e){return-1}},{key:"deregisterCharacterJoiner",value:function(e){return!1}},{key:"renderRows",value:function(e,t){if(!this._isAttached){if(!(this._coreBrowserService.window.document.body.contains(this._core.screenElement)&&this._charSizeService.width&&this._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}var i,r=d(this._renderLayers);try{for(r.s();!(i=r.n()).done;)i.value.handleGridChanged(this._terminal,e,t)}catch(n){r.e(n)}finally{r.f()}this._glyphRenderer.value&&this._rectangleRenderer.value&&(this._glyphRenderer.value.beginFrame()?(this._clearModel(!0),this._updateModel(0,this._terminal.rows-1)):this._updateModel(e,t),this._rectangleRenderer.value.renderBackgrounds(),this._glyphRenderer.value.render(this._model),this._cursorBlinkStateManager.value&&!this._cursorBlinkStateManager.value.isCursorVisible||this._rectangleRenderer.value.renderCursor())}},{key:"_updateCursorBlink",value:function(){var e=this;this._terminal.options.cursorBlink?this._cursorBlinkStateManager.value=new l.CursorBlinkStateManager((function(){e._requestRedrawCursor()}),this._coreBrowserService):this._cursorBlinkStateManager.clear(),this._requestRedrawCursor()}},{key:"_updateModel",value:function(e,t){var i,r,n,o,a,s,c,l,h,u,d,v,f,_=this._core,g=this._workCell;e=A(e,_.rows-1,0),t=A(t,_.rows-1,0);var p=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY,y=Math.min(this._terminal.buffer.active.cursorX,_.cols-1),m=-1,w=this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden&&(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible);this._model.cursor=void 0;var L=!1;for(r=e;r<=t;r++)for(n=r+_.buffer.ydisp,o=_.buffer.lines.get(n),this._model.lineLengths[r]=0,a=this._characterJoinerService.getJoinedCharacters(n),v=0;v<_.cols;v++)if(i=this._cellColorResolver.result.bg,o.loadCell(v,g),0===v&&(i=this._cellColorResolver.result.bg),s=!1,c=v,a.length>0&&v===a[0][0]&&(s=!0,l=a.shift(),g=new E(g,o.translateToString(!0,l[0],l[1]),l[1]-l[0]),c=l[1]-1),h=g.getChars(),u=g.getCode(),d=(r*_.cols+v)*b.RENDER_MODEL_INDICIES_PER_CELL,this._cellColorResolver.resolve(g,v,n),w&&n===p&&(v===y&&(this._model.cursor={x:y,y:this._terminal.buffer.active.cursorY,width:g.getWidth(),style:this._coreBrowserService.isFocused?_.options.cursorStyle||"block":_.options.cursorInactiveStyle,cursorWidth:_.options.cursorWidth,dpr:this._devicePixelRatio},m=y+g.getWidth()-1),v>=y&&v<=m&&(this._coreBrowserService.isFocused&&"block"===(_.options.cursorStyle||"block")||!1===this._coreBrowserService.isFocused&&"block"===_.options.cursorInactiveStyle)&&(this._cellColorResolver.result.fg=50331648|this._themeService.colors.cursorAccent.rgba>>8&16777215,this._cellColorResolver.result.bg=50331648|this._themeService.colors.cursor.rgba>>8&16777215)),u!==C.NULL_CELL_CODE&&(this._model.lineLengths[r]=v+1),(this._model.cells[d]!==u||this._model.cells[d+b.RENDER_MODEL_BG_OFFSET]!==this._cellColorResolver.result.bg||this._model.cells[d+b.RENDER_MODEL_FG_OFFSET]!==this._cellColorResolver.result.fg||this._model.cells[d+b.RENDER_MODEL_EXT_OFFSET]!==this._cellColorResolver.result.ext)&&(L=!0,h.length>1&&(u|=b.COMBINED_CHAR_BIT_MASK),this._model.cells[d]=u,this._model.cells[d+b.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[d+b.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[d+b.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext,this._glyphRenderer.value.updateCell(v,r,u,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,h,i),s))for(g=this._workCell,v++;v<c;v++)f=(r*_.cols+v)*b.RENDER_MODEL_INDICIES_PER_CELL,this._glyphRenderer.value.updateCell(v,r,C.NULL_CELL_CODE,0,0,0,C.NULL_CELL_CHAR,0),this._model.cells[f]=C.NULL_CELL_CODE,this._model.cells[f+b.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[f+b.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[f+b.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext;L&&this._rectangleRenderer.value.updateBackgrounds(this._model),this._rectangleRenderer.value.updateCursor(this._model)}},{key:"_updateDimensions",value:function(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=1===this._optionsService.rawOptions.lineHeight?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}},{key:"_setCanvasDevicePixelDimensions",value:function(e,t){this._canvas.width===e&&this._canvas.height===t||(this._canvas.width=e,this._canvas.height=t,this._requestRedrawViewport())}},{key:"_requestRedrawViewport",value:function(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}},{key:"_requestRedrawCursor",value:function(){var e=this._terminal.buffer.active.cursorY;this._onRequestRedraw.fire({start:e,end:e})}}])}(g.Disposable);t.WebglRenderer=M,r([w.traceCall],M.prototype,"renderRows",null);var E=function(e){function t(e,i,r){var n;return _(this,t),(n=a(this,t)).content=0,n.combinedData="",n.fg=e.fg,n.bg=e.bg,n.combinedData=i,n._width=r,n}return h(t,e),p(t,[{key:"isCombined",value:function(){return 2097152}},{key:"getWidth",value:function(){return this._width}},{key:"getChars",value:function(){return this.combinedData}},{key:"getCode",value:function(){return 2097151}},{key:"setFromCharData",value:function(e){throw new Error("not implemented")}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}])}(y.AttributeData);function A(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(Math.min(e,t),i)}t.JoinedCellData=E},381:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.GLTexture=t.expandFloat32Array=t.createShader=t.createProgram=t.PROJECTION_MATRIX=void 0;var r=i(374);function n(e,t,i){var n=(0,r.throwIfFalsy)(e.createShader(t));if(e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))return n;e.deleteShader(n)}t.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),t.createProgram=function(e,t,i){var o=(0,r.throwIfFalsy)(e.createProgram());if(e.attachShader(o,(0,r.throwIfFalsy)(n(e,e.VERTEX_SHADER,t))),e.attachShader(o,(0,r.throwIfFalsy)(n(e,e.FRAGMENT_SHADER,i))),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS))return o;e.deleteProgram(o)},t.createShader=n,t.expandFloat32Array=function(e,t){for(var i=Math.min(2*e.length,t),r=new Float32Array(i),n=0;n<e.length;n++)r[n]=e[n];return r},t.GLTexture=p((function e(t){_(this,e),this.texture=t,this.version=-1}))},592:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRenderLayer=void 0;var r=i(627),n=i(237),o=i(374),s=i(859),c=function(e){function t(e,i,r,n,o,c,l,h){var u;return _(this,t),(u=a(this,t))._container=i,u._alpha=o,u._coreBrowserService=c,u._optionsService=l,u._themeService=h,u._deviceCharWidth=0,u._deviceCharHeight=0,u._deviceCellWidth=0,u._deviceCellHeight=0,u._deviceCharLeft=0,u._deviceCharTop=0,u._canvas=document.createElement("canvas"),u._canvas.classList.add("xterm-".concat(r,"-layer")),u._canvas.style.zIndex=n.toString(),u._initCanvas(),u._container.appendChild(u._canvas),u.register(u._themeService.onChangeColors((function(t){u._refreshCharAtlas(e,t),u.reset(e)}))),u.register((0,s.toDisposable)((function(){u._canvas.remove()}))),u}return h(t,e),p(t,[{key:"_initCanvas",value:function(){this._ctx=(0,o.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}},{key:"handleBlur",value:function(e){}},{key:"handleFocus",value:function(e){}},{key:"handleCursorMove",value:function(e){}},{key:"handleGridChanged",value:function(e,t,i){}},{key:"handleSelectionChanged",value:function(e,t,i){}},{key:"_setTransparency",value:function(e,t){if(t!==this._alpha){var i=this._canvas;this._alpha=t,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,i),this._refreshCharAtlas(e,this._themeService.colors),this.handleGridChanged(e,0,e.rows-1)}}},{key:"_refreshCharAtlas",value:function(e,t){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=(0,r.acquireTextureAtlas)(e,this._optionsService.rawOptions,t,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlas.warmUp())}},{key:"resize",value:function(e,t){this._deviceCellWidth=t.device.cell.width,this._deviceCellHeight=t.device.cell.height,this._deviceCharWidth=t.device.char.width,this._deviceCharHeight=t.device.char.height,this._deviceCharLeft=t.device.char.left,this._deviceCharTop=t.device.char.top,this._canvas.width=t.device.canvas.width,this._canvas.height=t.device.canvas.height,this._canvas.style.width="".concat(t.css.canvas.width,"px"),this._canvas.style.height="".concat(t.css.canvas.height,"px"),this._alpha||this._clearAll(),this._refreshCharAtlas(e,this._themeService.colors)}},{key:"_fillBottomLineAtCells",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._ctx.fillRect(e*this._deviceCellWidth,(t+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,i*this._deviceCellWidth,this._coreBrowserService.dpr)}},{key:"_clearAll",value:function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}},{key:"_clearCells",value:function(e,t,i,r){this._alpha?this._ctx.clearRect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,r*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,r*this._deviceCellHeight))}},{key:"_fillCharTrueColor",value:function(e,t,i,r){this._ctx.font=this._getFont(e,!1,!1),this._ctx.textBaseline=n.TEXT_BASELINE,this._clipCell(i,r,t.getWidth()),this._ctx.fillText(t.getChars(),i*this._deviceCellWidth+this._deviceCharLeft,r*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}},{key:"_clipCell",value:function(e,t,i){this._ctx.beginPath(),this._ctx.rect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}},{key:"_getFont",value:function(e,t,i){return"".concat(i?"italic":""," ").concat(t?e.options.fontWeightBold:e.options.fontWeight," ").concat(e.options.fontSize*this._coreBrowserService.dpr,"px ").concat(e.options.fontFamily)}}])}(s.Disposable);t.BaseRenderLayer=c},733:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.LinkRenderLayer=void 0;var r=i(197),o=i(237),s=function(e){function t(e,i,r,n,o,s,c){var l;return _(this,t),(l=a(this,t,[r,e,"link",i,!0,o,s,c])).register(n.onShowLinkUnderline((function(e){return l._handleShowLinkUnderline(e)}))),l.register(n.onHideLinkUnderline((function(e){return l._handleHideLinkUnderline(e)}))),l}return h(t,e),p(t,[{key:"resize",value:function(e,i){(function(e,t,i,r){var o=n(l(1&r?e.prototype:e),t,i);return 2&r&&"function"==typeof o?function(e){return o.apply(i,e)}:o})(t,"resize",this,3)([e,i]),this._state=void 0}},{key:"reset",value:function(e){this._clearCurrentLink()}},{key:"_clearCurrentLink",value:function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var e=this._state.y2-this._state.y1-1;e>0&&this._clearCells(0,this._state.y1+1,this._state.cols,e),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}},{key:"_handleShowLinkUnderline",value:function(e){if(e.fg===o.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:void 0!==e.fg&&(0,r.is256Color)(e.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[e.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,e.y1===e.y2)this._fillBottomLineAtCells(e.x1,e.y1,e.x2-e.x1);else{this._fillBottomLineAtCells(e.x1,e.y1,e.cols-e.x1);for(var t=e.y1+1;t<e.y2;t++)this._fillBottomLineAtCells(0,t,e.cols);this._fillBottomLineAtCells(0,e.y2,e.x2)}this._state=e}},{key:"_handleHideLinkUnderline",value:function(e){this._clearCurrentLink()}}])}(i(592).BaseRenderLayer);t.LinkRenderLayer=s},820:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(e,t,i,r){e.addEventListener(t,i,r);var n=!1;return{dispose:function(){n||(n=!0,e.removeEventListener(t,i,r))}}}},274:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CellColorResolver=void 0;var i,r=0,n=0,o=!1,a=!1,s=!1;t.CellColorResolver=function(){function e(t,i,r,n,o){_(this,e),this._terminal=t,this._selectionRenderModel=i,this._decorationService=r,this._coreBrowserService=n,this._themeService=o,this.result={fg:0,bg:0,ext:0}}return p(e,[{key:"resolve",value:function(e,t,c){this.result.bg=e.bg,this.result.fg=e.fg,this.result.ext=268435456&e.bg?e.extended.ext:0,n=0,r=0,a=!1,o=!1,s=!1,i=this._themeService.colors,this._decorationService.forEachDecorationAtCell(t,c,"bottom",(function(e){e.backgroundColorRGB&&(n=e.backgroundColorRGB.rgba>>8&16777215,a=!0),e.foregroundColorRGB&&(r=e.foregroundColorRGB.rgba>>8&16777215,o=!0)})),(s=this._selectionRenderModel.isCellSelected(this._terminal,t,c))&&(n=(this._coreBrowserService.isFocused?i.selectionBackgroundOpaque:i.selectionInactiveBackgroundOpaque).rgba>>8&16777215,a=!0,i.selectionForeground&&(r=i.selectionForeground.rgba>>8&16777215,o=!0)),this._decorationService.forEachDecorationAtCell(t,c,"top",(function(e){e.backgroundColorRGB&&(n=e.backgroundColorRGB.rgba>>8&16777215,a=!0),e.foregroundColorRGB&&(r=e.foregroundColorRGB.rgba>>8&16777215,o=!0)})),a&&(n=s?-16777216&e.bg&-134217729|n|50331648:-16777216&e.bg|n|50331648),o&&(r=-16777216&e.fg&-67108865|r|50331648),67108864&this.result.fg&&(a&&!o&&(r=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&i.background.rgba>>8|50331648,o=!0),!a&&o&&(n=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&i.foreground.rgba>>8|50331648,a=!0)),i=void 0,this.result.bg=a?n:this.result.bg,this.result.fg=o?r:this.result.fg}}])}()},627:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.removeTerminalFromCache=t.acquireTextureAtlas=void 0;var r=i(509),n=i(197),o=[];t.acquireTextureAtlas=function(e,t,i,a,s,c,l,h){for(var u=(0,n.generateConfig)(a,s,c,l,t,i,h),d=0;d<o.length;d++){var v=o[d],f=v.ownedBy.indexOf(e);if(f>=0){if((0,n.configEquals)(v.config,u))return v.atlas;1===v.ownedBy.length?(v.atlas.dispose(),o.splice(d,1)):v.ownedBy.splice(f,1);break}}for(var _=0;_<o.length;_++){var g=o[_];if((0,n.configEquals)(g.config,u))return g.ownedBy.push(e),g.atlas}var p=e._core,y={atlas:new r.TextureAtlas(document,u,p.unicodeService),config:u,ownedBy:[e]};return o.push(y),y.atlas},t.removeTerminalFromCache=function(e){for(var t=0;t<o.length;t++){var i=o[t].ownedBy.indexOf(e);if(-1!==i){1===o[t].ownedBy.length?(o[t].atlas.dispose(),o.splice(t,1)):o[t].ownedBy.splice(i,1);break}}}},197:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.is256Color=t.configEquals=t.generateConfig=void 0;var r=i(160);t.generateConfig=function(e,t,i,n,o,a,s){var c={foreground:a.foreground,background:a.background,cursor:r.NULL_COLOR,cursorAccent:r.NULL_COLOR,selectionForeground:r.NULL_COLOR,selectionBackgroundTransparent:r.NULL_COLOR,selectionBackgroundOpaque:r.NULL_COLOR,selectionInactiveBackgroundTransparent:r.NULL_COLOR,selectionInactiveBackgroundOpaque:r.NULL_COLOR,ansi:a.ansi.slice(),contrastCache:a.contrastCache,halfContrastCache:a.halfContrastCache};return{customGlyphs:o.customGlyphs,devicePixelRatio:s,letterSpacing:o.letterSpacing,lineHeight:o.lineHeight,deviceCellWidth:e,deviceCellHeight:t,deviceCharWidth:i,deviceCharHeight:n,fontFamily:o.fontFamily,fontSize:o.fontSize,fontWeight:o.fontWeight,fontWeightBold:o.fontWeightBold,allowTransparency:o.allowTransparency,drawBoldTextInBrightColors:o.drawBoldTextInBrightColors,minimumContrastRatio:o.minimumContrastRatio,colors:c}},t.configEquals=function(e,t){for(var i=0;i<e.colors.ansi.length;i++)if(e.colors.ansi[i].rgba!==t.colors.ansi[i].rgba)return!1;return e.devicePixelRatio===t.devicePixelRatio&&e.customGlyphs===t.customGlyphs&&e.lineHeight===t.lineHeight&&e.letterSpacing===t.letterSpacing&&e.fontFamily===t.fontFamily&&e.fontSize===t.fontSize&&e.fontWeight===t.fontWeight&&e.fontWeightBold===t.fontWeightBold&&e.allowTransparency===t.allowTransparency&&e.deviceCharWidth===t.deviceCharWidth&&e.deviceCharHeight===t.deviceCharHeight&&e.drawBoldTextInBrightColors===t.drawBoldTextInBrightColors&&e.minimumContrastRatio===t.minimumContrastRatio&&e.colors.foreground.rgba===t.colors.foreground.rgba&&e.colors.background.rgba===t.colors.background.rgba},t.is256Color=function(e){return 16777216==(50331648&e)||33554432==(50331648&e)}},237:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;var r=i(399);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=r.isFirefox||r.isLegacyEdge?"bottom":"ideographic"},457:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CursorBlinkStateManager=void 0,t.CursorBlinkStateManager=function(){function e(t,i){_(this,e),this._renderCallback=t,this._coreBrowserService=i,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}return p(e,[{key:"isPaused",get:function(){return!(this._blinkStartTimeout||this._blinkInterval)}},{key:"dispose",value:function(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"restartBlinkAnimation",value:function(){var e=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((function(){e._renderCallback(),e._animationFrame=void 0}))))}},{key:"_restartInterval",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:600;this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout((function(){if(e._animationTimeRestarted){var t=600-(Date.now()-e._animationTimeRestarted);if(e._animationTimeRestarted=void 0,t>0)return void e._restartInterval(t)}e.isCursorVisible=!1,e._animationFrame=e._coreBrowserService.window.requestAnimationFrame((function(){e._renderCallback(),e._animationFrame=void 0})),e._blinkInterval=e._coreBrowserService.window.setInterval((function(){if(e._animationTimeRestarted){var t=600-(Date.now()-e._animationTimeRestarted);return e._animationTimeRestarted=void 0,void e._restartInterval(t)}e.isCursorVisible=!e.isCursorVisible,e._animationFrame=e._coreBrowserService.window.requestAnimationFrame((function(){e._renderCallback(),e._animationFrame=void 0}))}),600)}),t)}},{key:"pause",value:function(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"resume",value:function(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}])}()},860:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.tryDrawCustomChar=t.powerlineDefinitions=t.boxDrawingDefinitions=t.blockElementDefinitions=void 0;var r=i(374);t.blockElementDefinitions={"▀":[{x:0,y:0,w:8,h:4}],"▁":[{x:0,y:7,w:8,h:1}],"▂":[{x:0,y:6,w:8,h:2}],"▃":[{x:0,y:5,w:8,h:3}],"▄":[{x:0,y:4,w:8,h:4}],"▅":[{x:0,y:3,w:8,h:5}],"▆":[{x:0,y:2,w:8,h:6}],"▇":[{x:0,y:1,w:8,h:7}],"█":[{x:0,y:0,w:8,h:8}],"▉":[{x:0,y:0,w:7,h:8}],"▊":[{x:0,y:0,w:6,h:8}],"▋":[{x:0,y:0,w:5,h:8}],"▌":[{x:0,y:0,w:4,h:8}],"▍":[{x:0,y:0,w:3,h:8}],"▎":[{x:0,y:0,w:2,h:8}],"▏":[{x:0,y:0,w:1,h:8}],"▐":[{x:4,y:0,w:4,h:8}],"▔":[{x:0,y:0,w:8,h:1}],"▕":[{x:7,y:0,w:1,h:8}],"▖":[{x:0,y:4,w:4,h:4}],"▗":[{x:4,y:4,w:4,h:4}],"▘":[{x:0,y:0,w:4,h:4}],"▙":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"▚":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"▛":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"▜":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"▝":[{x:4,y:0,w:4,h:4}],"▞":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"▟":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"🭰":[{x:1,y:0,w:1,h:8}],"🭱":[{x:2,y:0,w:1,h:8}],"🭲":[{x:3,y:0,w:1,h:8}],"🭳":[{x:4,y:0,w:1,h:8}],"🭴":[{x:5,y:0,w:1,h:8}],"🭵":[{x:6,y:0,w:1,h:8}],"🭶":[{x:0,y:1,w:8,h:1}],"🭷":[{x:0,y:2,w:8,h:1}],"🭸":[{x:0,y:3,w:8,h:1}],"🭹":[{x:0,y:4,w:8,h:1}],"🭺":[{x:0,y:5,w:8,h:1}],"🭻":[{x:0,y:6,w:8,h:1}],"🭼":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🭽":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭾":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭿":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🮀":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮁":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮂":[{x:0,y:0,w:8,h:2}],"🮃":[{x:0,y:0,w:8,h:3}],"🮄":[{x:0,y:0,w:8,h:5}],"🮅":[{x:0,y:0,w:8,h:6}],"🮆":[{x:0,y:0,w:8,h:7}],"🮇":[{x:6,y:0,w:2,h:8}],"🮈":[{x:5,y:0,w:3,h:8}],"🮉":[{x:3,y:0,w:5,h:8}],"🮊":[{x:2,y:0,w:6,h:8}],"🮋":[{x:1,y:0,w:7,h:8}],"🮕":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"🮖":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"🮗":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};var n={"░":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"▒":[[1,0],[0,0],[0,1],[0,0]],"▓":[[0,1],[1,1],[1,0],[1,1]]};t.boxDrawingDefinitions={"─":{1:"M0,.5 L1,.5"},"━":{3:"M0,.5 L1,.5"},"│":{1:"M.5,0 L.5,1"},"┃":{3:"M.5,0 L.5,1"},"┌":{1:"M0.5,1 L.5,.5 L1,.5"},"┏":{3:"M0.5,1 L.5,.5 L1,.5"},"┐":{1:"M0,.5 L.5,.5 L.5,1"},"┓":{3:"M0,.5 L.5,.5 L.5,1"},"└":{1:"M.5,0 L.5,.5 L1,.5"},"┗":{3:"M.5,0 L.5,.5 L1,.5"},"┘":{1:"M.5,0 L.5,.5 L0,.5"},"┛":{3:"M.5,0 L.5,.5 L0,.5"},"├":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"┣":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"┤":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"┫":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"┬":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"┳":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"┴":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"┻":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"┼":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"╋":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"╴":{1:"M.5,.5 L0,.5"},"╸":{3:"M.5,.5 L0,.5"},"╵":{1:"M.5,.5 L.5,0"},"╹":{3:"M.5,.5 L.5,0"},"╶":{1:"M.5,.5 L1,.5"},"╺":{3:"M.5,.5 L1,.5"},"╷":{1:"M.5,.5 L.5,1"},"╻":{3:"M.5,.5 L.5,1"},"═":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"║":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"╒":{1:function(e,t){return"M.5,1 L.5,".concat(.5-t," L1,").concat(.5-t," M.5,").concat(.5+t," L1,").concat(.5+t)}},"╓":{1:function(e,t){return"M".concat(.5-e,",1 L").concat(.5-e,",.5 L1,.5 M").concat(.5+e,",.5 L").concat(.5+e,",1")}},"╔":{1:function(e,t){return"M1,".concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1")}},"╕":{1:function(e,t){return"M0,".concat(.5-t," L.5,").concat(.5-t," L.5,1 M0,").concat(.5+t," L.5,").concat(.5+t)}},"╖":{1:function(e,t){return"M".concat(.5+e,",1 L").concat(.5+e,",.5 L0,.5 M").concat(.5-e,",.5 L").concat(.5-e,",1")}},"╗":{1:function(e,t){return"M0,".concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M0,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",1")}},"╘":{1:function(e,t){return"M.5,0 L.5,".concat(.5+t," L1,").concat(.5+t," M.5,").concat(.5-t," L1,").concat(.5-t)}},"╙":{1:function(e,t){return"M1,.5 L".concat(.5-e,",.5 L").concat(.5-e,",0 M").concat(.5+e,",.5 L").concat(.5+e,",0")}},"╚":{1:function(e,t){return"M1,".concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0 M1,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",0")}},"╛":{1:function(e,t){return"M0,".concat(.5+t," L.5,").concat(.5+t," L.5,0 M0,").concat(.5-t," L.5,").concat(.5-t)}},"╜":{1:function(e,t){return"M0,.5 L".concat(.5+e,",.5 L").concat(.5+e,",0 M").concat(.5-e,",.5 L").concat(.5-e,",0")}},"╝":{1:function(e,t){return"M0,".concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M0,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",0")}},"╞":{1:function(e,t){return"M.5,0 L.5,1 M.5,".concat(.5-t," L1,").concat(.5-t," M.5,").concat(.5+t," L1,").concat(.5+t)}},"╟":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1 M").concat(.5+e,",.5 L1,.5")}},"╠":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"╡":{1:function(e,t){return"M.5,0 L.5,1 M0,".concat(.5-t," L.5,").concat(.5-t," M0,").concat(.5+t," L.5,").concat(.5+t)}},"╢":{1:function(e,t){return"M0,.5 L".concat(.5-e,",.5 M").concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"╣":{1:function(e,t){return"M".concat(.5+e,",0 L").concat(.5+e,",1 M0,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0")}},"╤":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t," M.5,").concat(.5+t," L.5,1")}},"╥":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",.5 L").concat(.5-e,",1 M").concat(.5+e,",.5 L").concat(.5+e,",1")}},"╦":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1")}},"╧":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t," M0,").concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"╨":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",.5 L").concat(.5-e,",0 M").concat(.5+e,",.5 L").concat(.5+e,",0")}},"╩":{1:function(e,t){return"M0,".concat(.5+t," L1,").concat(.5+t," M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"╪":{1:function(e,t){return"M.5,0 L.5,1 M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"╫":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"╬":{1:function(e,t){return"M0,".concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1 M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"╱":{1:"M1,0 L0,1"},"╲":{1:"M0,0 L1,1"},"╳":{1:"M1,0 L0,1 M0,0 L1,1"},"╼":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"╽":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"╾":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"╿":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"┍":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"┎":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"┑":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"┒":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"┕":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"┖":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"┙":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"┚":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"┝":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"┞":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"┟":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"┠":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"┡":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"┢":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"┥":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"┦":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"┧":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"┨":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"┩":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"┪":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"┭":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"┮":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"┯":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"┰":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"┱":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"┲":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"┵":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"┶":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"┷":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"┸":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"┹":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"┺":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"┽":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"┾":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"┿":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"╀":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"╁":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"╂":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"╃":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"╄":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"╅":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"╆":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"╇":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"╈":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"╉":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"╊":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"╌":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"╍":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"┄":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"┅":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"┈":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"┉":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"╎":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"╏":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"┆":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"┇":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"┊":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"┋":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"╭":{1:function(e,t){return"M.5,1 L.5,".concat(.5+t/.15*.5," C.5,").concat(.5+t/.15*.5,",.5,.5,1,.5")}},"╮":{1:function(e,t){return"M.5,1 L.5,".concat(.5+t/.15*.5," C.5,").concat(.5+t/.15*.5,",.5,.5,0,.5")}},"╯":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t/.15*.5," C.5,").concat(.5-t/.15*.5,",.5,.5,0,.5")}},"╰":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t/.15*.5," C.5,").concat(.5-t/.15*.5,",.5,.5,1,.5")}}},t.powerlineDefinitions={"":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"":{d:"M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0",type:1,rightPadding:1},"":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"":{d:"M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0",type:1,leftPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},t.powerlineDefinitions[""]=t.powerlineDefinitions[""],t.powerlineDefinitions[""]=t.powerlineDefinitions[""],t.tryDrawCustomChar=function(e,i,s,h,u,v,f,_){var g=t.blockElementDefinitions[i];if(g)return function(e,t,i,r,n,o){for(var a=0;a<t.length;a++){var s=t[a],c=n/8,l=o/8;e.fillRect(i+s.x*c,r+s.y*l,s.w*c,s.h*l)}}(e,g,s,h,u,v),!0;var p=n[i];if(p)return function(e,t,i,n,s,c){var l=a.get(t);l||(l=new Map,a.set(t,l));var h=e.fillStyle;if("string"!=typeof h)throw new Error('Unexpected fillStyle type "'.concat(h,'"'));var u=l.get(h);if(!u){var d=t[0].length,v=t.length,f=document.createElement("canvas");f.width=d,f.height=v;var _,g,p,y,m=(0,r.throwIfFalsy)(f.getContext("2d")),C=new ImageData(d,v);if(h.startsWith("#"))_=parseInt(h.slice(1,3),16),g=parseInt(h.slice(3,5),16),p=parseInt(h.slice(5,7),16),y=h.length>7&&parseInt(h.slice(7,9),16)||1;else{if(!h.startsWith("rgba"))throw new Error('Unexpected fillStyle color format "'.concat(h,'" when drawing pattern glyph'));var w=h.substring(5,h.length-1).split(",").map((function(e){return parseFloat(e)})),L=o(w,4);_=L[0],g=L[1],p=L[2],y=L[3]}for(var x=0;x<v;x++)for(var b=0;b<d;b++)C.data[4*(x*d+b)]=_,C.data[4*(x*d+b)+1]=g,C.data[4*(x*d+b)+2]=p,C.data[4*(x*d+b)+3]=t[x][b]*(255*y);m.putImageData(C,0,0),u=(0,r.throwIfFalsy)(e.createPattern(f,null)),l.set(h,u)}e.fillStyle=u,e.fillRect(i,n,s,c)}(e,p,s,h,u,v),!0;var y=t.boxDrawingDefinitions[i];if(y)return function(e,t,i,r,n,a,s){e.strokeStyle=e.fillStyle;for(var h=0,u=Object.entries(t);h<u.length;h++){var v=o(u[h],2),f=v[0],_=v[1];e.beginPath(),e.lineWidth=s*Number.parseInt(f);var g,p=d(("function"==typeof _?_(.15,.15/a*n):_).split(" "));try{for(p.s();!(g=p.n()).done;){var y=g.value,m=y[0],C=c[m];if(C){var w=y.substring(1).split(",");w[0]&&w[1]&&C(e,l(w,n,a,i,r,!0,s))}}}catch(L){p.e(L)}finally{p.f()}e.stroke(),e.closePath()}}(e,y,s,h,u,v,_),!0;var m=t.powerlineDefinitions[i];return!!m&&(function(e,t,i,r,n,o,a,s){var h,u,v=new Path2D;v.rect(i,r,n,o),e.clip(v),e.beginPath();var f=a/12;e.lineWidth=s*f;var _,g=d(t.d.split(" "));try{for(g.s();!(_=g.n()).done;){var p=_.value,y=p[0],m=c[y];if(m){var C=p.substring(1).split(",");C[0]&&C[1]&&m(e,l(C,n,o,i,r,!1,s,(null!==(h=t.leftPadding)&&void 0!==h?h:0)*(f/2),(null!==(u=t.rightPadding)&&void 0!==u?u:0)*(f/2)))}}}catch(w){g.e(w)}finally{g.f()}1===t.type?(e.strokeStyle=e.fillStyle,e.stroke()):e.fill(),e.closePath()}(e,m,s,h,u,v,f,_),!0)};var a=new Map;function s(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(Math.min(e,t),i)}var c={C:function(e,t){return e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},L:function(e,t){return e.lineTo(t[0],t[1])},M:function(e,t){return e.moveTo(t[0],t[1])}};function l(e,t,i,r,n,o,a){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=e.map((function(e){return parseFloat(e)||parseInt(e)}));if(h.length<2)throw new Error("Too few arguments for instruction");for(var u=0;u<h.length;u+=2)h[u]*=t-c*a-l*a,o&&0!==h[u]&&(h[u]=s(Math.round(h[u]+.5)-.5,t,0)),h[u]+=r+c*a;for(var d=1;d<h.length;d+=2)h[d]*=i,o&&0!==h[d]&&(h[d]=s(Math.round(h[d]+.5)-.5,i,0)),h[d]+=n;return h}},56:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.observeDevicePixelDimensions=void 0;var r=i(859);t.observeDevicePixelDimensions=function(e,t,i){var n=new t.ResizeObserver((function(t){var r=t.find((function(t){return t.target===e}));if(r){if(!("devicePixelContentBoxSize"in r))return null==n||n.disconnect(),void(n=void 0);var o=r.devicePixelContentBoxSize[0].inlineSize,a=r.devicePixelContentBoxSize[0].blockSize;o>0&&a>0&&i(o,a)}}));try{n.observe(e,{box:["device-pixel-content-box"]})}catch(e){n.disconnect(),n=void 0}return(0,r.toDisposable)((function(){return null==n?void 0:n.disconnect()}))}},374:function(e,t){function i(e){return 57508<=e&&e<=57558}Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderDimensions=t.excludeFromContrastRatioDemands=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw new Error("value must not be falsy");return e},t.isPowerlineGlyph=i,t.isRestrictedPowerlineGlyph=function(e){return 57520<=e&&e<=57527},t.excludeFromContrastRatioDemands=function(e){return i(e)||function(e){return 9472<=e&&e<=9631}(e)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},296:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;var i=function(){function e(){_(this,e),this.clear()}return p(e,[{key:"clear",value:function(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}},{key:"update",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.selectionStart=t,this.selectionEnd=i,t&&i&&(t[0]!==i[0]||t[1]!==i[1])){var n=t[1]-e.buffer.active.viewportY,o=i[1]-e.buffer.active.viewportY,a=Math.max(n,0),s=Math.min(o,e.rows-1);a>=e.rows||s<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=r,this.viewportStartRow=n,this.viewportEndRow=o,this.viewportCappedStartRow=a,this.viewportCappedEndRow=s,this.startCol=t[0],this.endCol=i[0])}else this.clear()}},{key:"isCellSelected",value:function(e,t,i){return!!this.hasSelection&&(i-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?t>=this.startCol&&i>=this.viewportCappedStartRow&&t<this.endCol&&i<=this.viewportCappedEndRow:t<this.startCol&&i>=this.viewportCappedStartRow&&t>=this.endCol&&i<=this.viewportCappedEndRow:i>this.viewportStartRow&&i<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportEndRow&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol)}}])}();t.createSelectionRenderModel=function(){return new i}},509:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.TextureAtlas=void 0;var a,s=i(237),c=i(860),l=i(374),h=i(160),u=i(345),v=i(485),f=i(385),g=i(147),y=i(855),m=i(776),C={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}},w=function(){function e(t,i,r){_(this,e),this._document=t,this._config=i,this._unicodeService=r,this._didWarmUp=!1,this._cacheMap=new v.FourKeyMap,this._cacheMapCombined=new v.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new g.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new u.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new u.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=b(t,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,l.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}return p(e,[{key:"pages",get:function(){return this._pages}},{key:"dispose",value:function(){var e,t=d(this.pages);try{for(t.s();!(e=t.n()).done;)e.value.canvas.remove()}catch(i){t.e(i)}finally{t.f()}this._onAddTextureAtlasCanvas.dispose()}},{key:"warmUp",value:function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}},{key:"_doWarmUp",value:function(){for(var e=this,t=new f.IdleTaskQueue,i=function(i){t.enqueue((function(){if(!e._cacheMap.get(i,y.DEFAULT_COLOR,y.DEFAULT_COLOR,y.DEFAULT_EXT)){var t=e._drawToCache(i,y.DEFAULT_COLOR,y.DEFAULT_COLOR,y.DEFAULT_EXT);e._cacheMap.set(i,y.DEFAULT_COLOR,y.DEFAULT_COLOR,y.DEFAULT_EXT,t)}}))},r=33;r<126;r++)i(r)}},{key:"beginFrame",value:function(){return this._requestClearModel}},{key:"clearTexture",value:function(){if(0!==this._pages[0].currentRow.x||0!==this._pages[0].currentRow.y){var e,t=d(this._pages);try{for(t.s();!(e=t.n()).done;)e.value.clear()}catch(i){t.e(i)}finally{t.f()}this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}},{key:"_createNewPage",value:function(){if(e.maxAtlasPages&&this._pages.length>=Math.max(4,e.maxAtlasPages)){for(var t=this._pages.filter((function(t){return 2*t.canvas.width<=(e.maxTextureSize||4096)})).sort((function(e,t){return t.canvas.width!==e.canvas.width?t.canvas.width-e.canvas.width:t.percentageUsed-e.percentageUsed})),i=-1,r=0,n=0;n<t.length;n++)if(t[n].canvas.width!==r)i=n,r=t[n].canvas.width;else if(n-i==3)break;var o=t.slice(i,i+4),a=o.map((function(e){return e.glyphs[0].texturePage})).sort((function(e,t){return e>t?1:-1})),s=this.pages.length-o.length,c=this._mergePages(o,s);c.version++;for(var l=a.length-1;l>=0;l--)this._deletePage(a[l]);this.pages.push(c),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(c.canvas)}var h=new L(this._document,this._textureSize);return this._pages.push(h),this._activePages.push(h),this._onAddTextureAtlasCanvas.fire(h.canvas),h}},{key:"_mergePages",value:function(e,t){var i,r=2*e[0].canvas.width,n=new L(this._document,r,e),a=d(e.entries());try{for(a.s();!(i=a.n()).done;){var s=o(i.value,2),c=s[0],l=s[1],h=c*l.canvas.width%r,u=Math.floor(c/2)*l.canvas.height;n.ctx.drawImage(l.canvas,h,u);var v,f=d(l.glyphs);try{for(f.s();!(v=f.n()).done;){var _=v.value;_.texturePage=t,_.sizeClipSpace.x=_.size.x/r,_.sizeClipSpace.y=_.size.y/r,_.texturePosition.x+=h,_.texturePosition.y+=u,_.texturePositionClipSpace.x=_.texturePosition.x/r,_.texturePositionClipSpace.y=_.texturePosition.y/r}}catch(p){f.e(p)}finally{f.f()}this._onRemoveTextureAtlasCanvas.fire(l.canvas);var g=this._activePages.indexOf(l);-1!==g&&this._activePages.splice(g,1)}}catch(p){a.e(p)}finally{a.f()}return n}},{key:"_deletePage",value:function(e){this._pages.splice(e,1);for(var t=e;t<this._pages.length;t++){var i,r=this._pages[t],n=d(r.glyphs);try{for(n.s();!(i=n.n()).done;)i.value.texturePage--}catch(o){n.e(o)}finally{n.f()}r.version++}}},{key:"getRasterizedGlyphCombinedChar",value:function(e,t,i,r,n){return this._getFromCacheMap(this._cacheMapCombined,e,t,i,r,n)}},{key:"getRasterizedGlyph",value:function(e,t,i,r,n){return this._getFromCacheMap(this._cacheMap,e,t,i,r,n)}},{key:"_getFromCacheMap",value:function(e,t,i,r,n){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return(a=e.get(t,i,r,n))||(a=this._drawToCache(t,i,r,n,o),e.set(t,i,r,n,a)),a}},{key:"_getColorFromAnsiIndex",value:function(e){if(e>=this._config.colors.ansi.length)throw new Error("No color found for idx "+e);return this._config.colors.ansi[e]}},{key:"_getBackgroundColor",value:function(e,t,i,r){if(this._config.allowTransparency)return h.NULL_COLOR;var n;switch(e){case 16777216:case 33554432:n=this._getColorFromAnsiIndex(t);break;case 50331648:var o=g.AttributeData.toColorRGB(t);n=h.rgba.toColor(o[0],o[1],o[2]);break;default:n=i?h.color.opaque(this._config.colors.foreground):this._config.colors.background}return n}},{key:"_getForegroundColor",value:function(e,t,i,r,n,o,a,c,l,u){var d,v=this._getMinimumContrastColor(e,t,i,r,n,o,!1,l,c,u);if(v)return v;switch(n){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&l&&o<8&&(o+=8),d=this._getColorFromAnsiIndex(o);break;case 50331648:var f=g.AttributeData.toColorRGB(o);d=h.rgba.toColor(f[0],f[1],f[2]);break;default:d=a?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(d=h.color.opaque(d)),c&&(d=h.color.multiplyOpacity(d,s.DIM_OPACITY)),d}},{key:"_resolveBackgroundRgba",value:function(e,t,i){switch(e){case 16777216:case 33554432:return this._getColorFromAnsiIndex(t).rgba;case 50331648:return t<<8;default:return i?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}},{key:"_resolveForegroundRgba",value:function(e,t,i,r){switch(e){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&r&&t<8&&(t+=8),this._getColorFromAnsiIndex(t).rgba;case 50331648:return t<<8;default:return i?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}},{key:"_getMinimumContrastColor",value:function(e,t,i,r,n,o,a,s,c,l){if(1!==this._config.minimumContrastRatio&&!l){var u=this._getContrastCache(c),d=u.getColor(e,r);if(void 0!==d)return d||void 0;var v=this._resolveBackgroundRgba(t,i,a),f=this._resolveForegroundRgba(n,o,a,s),_=h.rgba.ensureContrastRatio(v,f,this._config.minimumContrastRatio/(c?2:1));if(_){var g=h.rgba.toColor(_>>24&255,_>>16&255,_>>8&255);return u.setColor(e,r,g),g}u.setColor(e,r,null)}}},{key:"_getContrastCache",value:function(e){return e?this._config.colors.halfContrastCache:this._config.colors.contrastCache}},{key:"_drawToCache",value:function(t,i,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a="number"==typeof t?String.fromCharCode(t):t,h=Math.min(this._config.deviceCellWidth*Math.max(a.length,2)+4,this._textureSize);this._tmpCanvas.width<h&&(this._tmpCanvas.width=h);var u=Math.min(this._config.deviceCellHeight+8,this._textureSize);if(this._tmpCanvas.height<u&&(this._tmpCanvas.height=u),this._tmpCtx.save(),this._workAttributeData.fg=r,this._workAttributeData.bg=i,this._workAttributeData.extended.ext=n,this._workAttributeData.isInvisible())return C;var v=!!this._workAttributeData.isBold(),f=!!this._workAttributeData.isInverse(),_=!!this._workAttributeData.isDim(),p=!!this._workAttributeData.isItalic(),y=!!this._workAttributeData.isUnderline(),m=!!this._workAttributeData.isStrikethrough(),w=!!this._workAttributeData.isOverline(),L=this._workAttributeData.getFgColor(),b=this._workAttributeData.getFgColorMode(),R=this._workAttributeData.getBgColor(),M=this._workAttributeData.getBgColorMode();if(f){var E=L;L=R,R=E;var A=b;b=M,M=A}var k=this._getBackgroundColor(M,R,f,_);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=k.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";var S=v?this._config.fontWeightBold:this._config.fontWeight,T=p?"italic":"";this._tmpCtx.font="".concat(T," ").concat(S," ").concat(this._config.fontSize*this._config.devicePixelRatio,"px ").concat(this._config.fontFamily),this._tmpCtx.textBaseline=s.TEXT_BASELINE;var D=1===a.length&&(0,l.isPowerlineGlyph)(a.charCodeAt(0)),P=1===a.length&&(0,l.isRestrictedPowerlineGlyph)(a.charCodeAt(0)),O=this._getForegroundColor(i,M,R,r,b,L,f,_,v,(0,l.excludeFromContrastRatioDemands)(a.charCodeAt(0)));this._tmpCtx.fillStyle=O.css;var F=P?0:4,B=!1;!1!==this._config.customGlyphs&&(B=(0,c.tryDrawCustomChar)(this._tmpCtx,a,F,F,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));var I,N=!D;if(I="number"==typeof t?this._unicodeService.wcwidth(t):this._unicodeService.getStringCellWidth(t),y){this._tmpCtx.save();var U=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),W=U%2==1?.5:0;if(this._tmpCtx.lineWidth=U,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())N=!1,this._tmpCtx.strokeStyle="rgb(".concat(g.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(","),")");else{N=!1;var j=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&j<8&&(j+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(j).css}this._tmpCtx.beginPath();for(var z=F,H=Math.ceil(F+this._config.deviceCharHeight)-W-(o?2*U:0),G=H+U,q=H+2*U,X=0;X<I;X++){this._tmpCtx.save();var V=z+X*this._config.deviceCellWidth,Y=z+(X+1)*this._config.deviceCellWidth,J=V+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(V,H),this._tmpCtx.lineTo(Y,H),this._tmpCtx.moveTo(V,q),this._tmpCtx.lineTo(Y,q);break;case 3:var K=U<=1?q:Math.ceil(F+this._config.deviceCharHeight-U/2)-W,Q=U<=1?H:Math.ceil(F+this._config.deviceCharHeight+U/2)-W,$=new Path2D;$.rect(V,H,this._config.deviceCellWidth,q-H),this._tmpCtx.clip($),this._tmpCtx.moveTo(V-this._config.deviceCellWidth/2,G),this._tmpCtx.bezierCurveTo(V-this._config.deviceCellWidth/2,Q,V,Q,V,G),this._tmpCtx.bezierCurveTo(V,K,J,K,J,G),this._tmpCtx.bezierCurveTo(J,Q,Y,Q,Y,G),this._tmpCtx.bezierCurveTo(Y,K,Y+this._config.deviceCellWidth/2,K,Y+this._config.deviceCellWidth/2,G);break;case 4:this._tmpCtx.setLineDash([Math.round(U),Math.round(U)]),this._tmpCtx.moveTo(V,H),this._tmpCtx.lineTo(Y,H);break;case 5:this._tmpCtx.setLineDash([4*this._config.devicePixelRatio,3*this._config.devicePixelRatio]),this._tmpCtx.moveTo(V,H),this._tmpCtx.lineTo(Y,H);break;default:this._tmpCtx.moveTo(V,H),this._tmpCtx.lineTo(Y,H)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!B&&this._config.fontSize>=12&&!this._config.allowTransparency&&" "!==a){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";var Z=this._tmpCtx.measureText(a);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in Z&&Z.actualBoundingBoxDescent>0){this._tmpCtx.save();var ee=new Path2D;ee.rect(z,H-Math.ceil(U/2),this._config.deviceCellWidth*I,q-H+Math.ceil(U/2)),this._tmpCtx.clip(ee),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=k.css,this._tmpCtx.strokeText(a,F,F+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(w){var te=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),ie=te%2==1?.5:0;this._tmpCtx.lineWidth=te,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(F,F+ie),this._tmpCtx.lineTo(F+this._config.deviceCharWidth*I,F+ie),this._tmpCtx.stroke()}if(B||this._tmpCtx.fillText(a,F,F+this._config.deviceCharHeight),"_"===a&&!this._config.allowTransparency){var re=x(this._tmpCtx.getImageData(F,F,this._config.deviceCellWidth,this._config.deviceCellHeight),k,O,N);if(re)for(var ne=1;ne<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=k.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(a,F,F+this._config.deviceCharHeight-ne),re=x(this._tmpCtx.getImageData(F,F,this._config.deviceCellWidth,this._config.deviceCellHeight),k,O,N));ne++);}if(m){var oe=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),ae=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=oe,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(F,F+Math.floor(this._config.deviceCharHeight/2)-ae),this._tmpCtx.lineTo(F+this._config.deviceCharWidth*I,F+Math.floor(this._config.deviceCharHeight/2)-ae),this._tmpCtx.stroke()}this._tmpCtx.restore();var se,ce=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);if(se=this._config.allowTransparency?function(e){for(var t=0;t<e.data.length;t+=4)if(e.data[t+3]>0)return!1;return!0}(ce):x(ce,k,O,N),se)return C;for(var le,he,ue=this._findGlyphBoundingBox(ce,this._workBoundingBox,h,P,B,F);;){if(0===this._activePages.length){var de=this._createNewPage();le=de,(he=de.currentRow).height=ue.size.y;break}he=(le=this._activePages[this._activePages.length-1]).currentRow;var ve,fe=d(this._activePages);try{for(fe.s();!(ve=fe.n()).done;){var _e=ve.value;ue.size.y<=_e.currentRow.height&&(le=_e,he=_e.currentRow)}}catch(Me){fe.e(Me)}finally{fe.f()}for(var ge=this._activePages.length-1;ge>=0;ge--){var pe,ye=d(this._activePages[ge].fixedRows);try{for(ye.s();!(pe=ye.n()).done;){var me=pe.value;me.height<=he.height&&ue.size.y<=me.height&&(le=this._activePages[ge],he=me)}}catch(Me){ye.e(Me)}finally{ye.f()}}if(he.y+ue.size.y>=le.canvas.height||he.height>ue.size.y+2){var Ce=!1;if(le.currentRow.y+le.currentRow.height+ue.size.y>=le.canvas.height){var we,Le=void 0,xe=d(this._activePages);try{for(xe.s();!(we=xe.n()).done;){var be=we.value;if(be.currentRow.y+be.currentRow.height+ue.size.y<be.canvas.height){Le=be;break}}}catch(Me){xe.e(Me)}finally{xe.f()}if(Le)le=Le;else if(e.maxAtlasPages&&this._pages.length>=e.maxAtlasPages&&he.y+ue.size.y<=le.canvas.height&&he.height>=ue.size.y&&he.x+ue.size.x<=le.canvas.width)Ce=!0;else{var Re=this._createNewPage();le=Re,(he=Re.currentRow).height=ue.size.y,Ce=!0}}Ce||(le.currentRow.height>0&&le.fixedRows.push(le.currentRow),he={x:0,y:le.currentRow.y+le.currentRow.height,height:ue.size.y},le.fixedRows.push(he),le.currentRow={x:0,y:he.y+he.height,height:0})}if(he.x+ue.size.x<=le.canvas.width)break;he===le.currentRow?(he.x=0,he.y+=he.height,he.height=0):le.fixedRows.splice(le.fixedRows.indexOf(he),1)}return ue.texturePage=this._pages.indexOf(le),ue.texturePosition.x=he.x,ue.texturePosition.y=he.y,ue.texturePositionClipSpace.x=he.x/le.canvas.width,ue.texturePositionClipSpace.y=he.y/le.canvas.height,ue.sizeClipSpace.x/=le.canvas.width,ue.sizeClipSpace.y/=le.canvas.height,he.height=Math.max(he.height,ue.size.y),he.x+=ue.size.x,le.ctx.putImageData(ce,ue.texturePosition.x-this._workBoundingBox.left,ue.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,ue.size.x,ue.size.y),le.addGlyph(ue),le.version++,ue}},{key:"_findGlyphBoundingBox",value:function(e,t,i,r,n,o){t.top=0;for(var a=r?this._config.deviceCellHeight:this._tmpCanvas.height,s=r?this._config.deviceCellWidth:i,c=!1,l=0;l<a;l++){for(var h=0;h<s;h++){var u=l*this._tmpCanvas.width*4+4*h+3;if(0!==e.data[u]){t.top=l,c=!0;break}}if(c)break}t.left=0,c=!1;for(var d=0;d<o+s;d++){for(var v=0;v<a;v++){var f=v*this._tmpCanvas.width*4+4*d+3;if(0!==e.data[f]){t.left=d,c=!0;break}}if(c)break}t.right=s,c=!1;for(var _=o+s-1;_>=o;_--){for(var g=0;g<a;g++){var p=g*this._tmpCanvas.width*4+4*_+3;if(0!==e.data[p]){t.right=_,c=!0;break}}if(c)break}t.bottom=a,c=!1;for(var y=a-1;y>=0;y--){for(var m=0;m<s;m++){var C=y*this._tmpCanvas.width*4+4*m+3;if(0!==e.data[C]){t.bottom=y,c=!0;break}}if(c)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:t.right-t.left+1,y:t.bottom-t.top+1},sizeClipSpace:{x:t.right-t.left+1,y:t.bottom-t.top+1},offset:{x:-t.left+o+(r||n?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-t.top+o+(r||n?1===this._config.lineHeight?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}])}();t.TextureAtlas=w,n([m.traceCall],w.prototype,"_drawToCache",null);var L=function(){function e(t,i,n){if(_(this,e),this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],n){var o,a=d(n);try{for(a.s();!(o=a.n()).done;){var s,c=o.value;(s=this._glyphs).push.apply(s,r(c.glyphs)),this._usedPixels+=c._usedPixels}}catch(h){a.e(h)}finally{a.f()}}this.canvas=b(t,i,i),this.ctx=(0,l.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}return p(e,[{key:"percentageUsed",get:function(){return this._usedPixels/(this.canvas.width*this.canvas.height)}},{key:"glyphs",get:function(){return this._glyphs}},{key:"addGlyph",value:function(e){this._glyphs.push(e),this._usedPixels+=e.size.x*e.size.y}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}])}();function x(e,t,i,r){for(var n=t.rgba>>>24,o=t.rgba>>>16&255,a=t.rgba>>>8&255,s=i.rgba>>>24,c=i.rgba>>>16&255,l=i.rgba>>>8&255,h=Math.floor((Math.abs(n-s)+Math.abs(o-c)+Math.abs(a-l))/12),u=!0,d=0;d<e.data.length;d+=4)e.data[d]===n&&e.data[d+1]===o&&e.data[d+2]===a||r&&Math.abs(e.data[d]-n)+Math.abs(e.data[d+1]-o)+Math.abs(e.data[d+2]-a)<h?e.data[d+3]=0:u=!1;return u}function b(e,t,i){var r=e.createElement("canvas");return r.width=t,r.height=i,r}},160:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;var r,n,a,s,c,l=i(399),h=0,u=0,d=0,v=0;function f(e){var t=e.toString(16);return t.length<2?"0"+t:t}function _(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(e){e.toCss=function(e,t,i,r){return void 0!==r?"#".concat(f(e)).concat(f(t)).concat(f(i)).concat(f(r)):"#".concat(f(e)).concat(f(t)).concat(f(i))},e.toRgba=function(e,t,i){return(e<<24|t<<16|i<<8|(arguments.length>3&&void 0!==arguments[3]?arguments[3]:255))>>>0}}(r||(t.channels=r={})),function(e){function t(e,t){var i;return v=Math.round(255*t),i=o(c.toChannels(e.rgba),3),h=i[0],u=i[1],d=i[2],{css:r.toCss(h,u,d,v),rgba:r.toRgba(h,u,d,v)}}e.blend=function(e,t){if(1==(v=(255&t.rgba)/255))return{css:t.css,rgba:t.rgba};var i=t.rgba>>24&255,n=t.rgba>>16&255,o=t.rgba>>8&255,a=e.rgba>>24&255,s=e.rgba>>16&255,c=e.rgba>>8&255;return h=a+Math.round((i-a)*v),u=s+Math.round((n-s)*v),d=c+Math.round((o-c)*v),{css:r.toCss(h,u,d),rgba:r.toRgba(h,u,d)}},e.isOpaque=function(e){return!(255&~e.rgba)},e.ensureContrastRatio=function(e,t,i){var r=c.ensureContrastRatio(e.rgba,t.rgba,i);if(r)return c.toColor(r>>24&255,r>>16&255,r>>8&255)},e.opaque=function(e){var t,i=(255|e.rgba)>>>0;return t=o(c.toChannels(i),3),h=t[0],u=t[1],d=t[2],{css:r.toCss(h,u,d),rgba:i}},e.opacity=t,e.multiplyOpacity=function(e,i){return t(e,(v=255&e.rgba)*i/255)},e.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]}}(n||(t.color=n={})),function(e){var t,i;if(!l.isNode){var n=document.createElement("canvas");n.width=1,n.height=1;var a=n.getContext("2d",{willReadFrequently:!0});a&&((t=a).globalCompositeOperation="copy",i=t.createLinearGradient(0,0,1,1))}e.toColor=function(e){var n;if(e.match(/#[\da-f]{3,8}/i))switch(e.length){case 4:return h=parseInt(e.slice(1,2).repeat(2),16),u=parseInt(e.slice(2,3).repeat(2),16),d=parseInt(e.slice(3,4).repeat(2),16),c.toColor(h,u,d);case 5:return h=parseInt(e.slice(1,2).repeat(2),16),u=parseInt(e.slice(2,3).repeat(2),16),d=parseInt(e.slice(3,4).repeat(2),16),v=parseInt(e.slice(4,5).repeat(2),16),c.toColor(h,u,d,v);case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}var a=e.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(a)return h=parseInt(a[1]),u=parseInt(a[2]),d=parseInt(a[3]),v=Math.round(255*(void 0===a[5]?1:parseFloat(a[5]))),c.toColor(h,u,d,v);if(!t||!i)throw new Error("css.toColor: Unsupported css format");if(t.fillStyle=i,t.fillStyle=e,"string"!=typeof t.fillStyle)throw new Error("css.toColor: Unsupported css format");if(t.fillRect(0,0,1,1),n=o(t.getImageData(0,0,1,1).data,4),h=n[0],u=n[1],d=n[2],255!==(v=n[3]))throw new Error("css.toColor: Unsupported css format");return{rgba:r.toRgba(h,u,d,v),css:e}}}(a||(t.css=a={})),function(e){function t(e,t,i){var r=e/255,n=t/255,o=i/255;return.2126*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(s||(t.rgb=s={})),function(e){function t(e,t,i){for(var r=e>>24&255,n=e>>16&255,o=e>>8&255,a=t>>24&255,c=t>>16&255,l=t>>8&255,h=_(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));h<i&&(a>0||c>0||l>0);)a-=Math.max(0,Math.ceil(.1*a)),c-=Math.max(0,Math.ceil(.1*c)),l-=Math.max(0,Math.ceil(.1*l)),h=_(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));return(a<<24|c<<16|l<<8|255)>>>0}function i(e,t,i){for(var r=e>>24&255,n=e>>16&255,o=e>>8&255,a=t>>24&255,c=t>>16&255,l=t>>8&255,h=_(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));h<i&&(a<255||c<255||l<255);)a=Math.min(255,a+Math.ceil(.1*(255-a))),c=Math.min(255,c+Math.ceil(.1*(255-c))),l=Math.min(255,l+Math.ceil(.1*(255-l))),h=_(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));return(a<<24|c<<16|l<<8|255)>>>0}e.ensureContrastRatio=function(e,r,n){var o=s.relativeLuminance(e>>8),a=s.relativeLuminance(r>>8);if(_(o,a)<n){if(a<o){var c=t(e,r,n),l=_(o,s.relativeLuminance(c>>8));if(l<n){var h=i(e,r,n);return l>_(o,s.relativeLuminance(h>>8))?c:h}return c}var u=i(e,r,n),d=_(o,s.relativeLuminance(u>>8));if(d<n){var v=t(e,r,n);return d>_(o,s.relativeLuminance(v>>8))?u:v}return u}},e.reduceLuminance=t,e.increaseLuminance=i,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},e.toColor=function(e,t,i,n){return{css:r.toCss(e,t,i,n),rgba:r.toRgba(e,t,i,n)}}}(c||(t.rgba=c={})),t.toPaddedHex=f,t.contrastRatio=_},345:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=function(){function e(){_(this,e),this._listeners=[],this._disposed=!1}return p(e,[{key:"event",get:function(){var e=this;return this._event||(this._event=function(t){return e._listeners.push(t),{dispose:function(){if(!e._disposed)for(var i=0;i<e._listeners.length;i++)if(e._listeners[i]===t)return void e._listeners.splice(i,1)}}}),this._event}},{key:"fire",value:function(e,t){for(var i=[],r=0;r<this._listeners.length;r++)i.push(this._listeners[r]);for(var n=0;n<i.length;n++)i[n].call(void 0,e,t)}},{key:"dispose",value:function(){this.clearListeners(),this._disposed=!0}},{key:"clearListeners",value:function(){this._listeners&&(this._listeners.length=0)}}])}(),t.forwardEvent=function(e,t){return e((function(e){return t.fire(e)}))}},859:function(e,t){function i(e){var t,i=d(e);try{for(i.s();!(t=i.n()).done;)t.value.dispose()}catch(r){i.e(r)}finally{i.f()}e.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=function(){function e(){_(this,e),this._disposables=[],this._isDisposed=!1}return p(e,[{key:"dispose",value:function(){this._isDisposed=!0;var e,t=d(this._disposables);try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(i){t.e(i)}finally{t.f()}this._disposables.length=0}},{key:"register",value:function(e){return this._disposables.push(e),e}},{key:"unregister",value:function(e){var t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)}}])}(),t.MutableDisposable=function(){function e(){_(this,e),this._isDisposed=!1}return p(e,[{key:"value",get:function(){return this._isDisposed?void 0:this._value},set:function(e){var t;this._isDisposed||e===this._value||(null===(t=this._value)||void 0===t||t.dispose(),this._value=e)}},{key:"clear",value:function(){this.value=void 0}},{key:"dispose",value:function(){var e;this._isDisposed=!0,null===(e=this._value)||void 0===e||e.dispose(),this._value=void 0}}])}(),t.toDisposable=function(e){return{dispose:e}},t.disposeArray=i,t.getDisposeArrayDisposable=function(e){return{dispose:function(){return i(e)}}}},485:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;var i=function(){function e(){_(this,e),this._data={}}return p(e,[{key:"set",value:function(e,t,i){this._data[e]||(this._data[e]={}),this._data[e][t]=i}},{key:"get",value:function(e,t){return this._data[e]?this._data[e][t]:void 0}},{key:"clear",value:function(){this._data={}}}])}();t.TwoKeyMap=i,t.FourKeyMap=function(){function e(){_(this,e),this._data=new i}return p(e,[{key:"set",value:function(e,t,r,n,o){this._data.get(e,t)||this._data.set(e,t,new i),this._data.get(e,t).set(r,n,o)}},{key:"get",value:function(e,t,i,r){var n;return null===(n=this._data.get(e,t))||void 0===n?void 0:n.get(i,r)}},{key:"clear",value:function(){this._data.clear()}}])}()},399:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode="undefined"==typeof navigator;var i=t.isNode?"node":navigator.userAgent,r=t.isNode?"node":navigator.platform;t.isFirefox=i.includes("Firefox"),t.isLegacyEdge=i.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(i),t.getSafariVersion=function(){if(!t.isSafari)return 0;var e=i.match(/Version\/(\d+)/);return null===e||e.length<2?0:parseInt(e[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(r),t.isIpad="iPad"===r,t.isIphone="iPhone"===r,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(r),t.isLinux=r.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(i)},385:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;var r=i(399),n=function(){function e(){_(this,e),this._tasks=[],this._i=0}return p(e,[{key:"enqueue",value:function(e){this._tasks.push(e),this._start()}},{key:"flush",value:function(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}},{key:"clear",value:function(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}},{key:"_start",value:function(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}},{key:"_process",value:function(e){this._idleCallback=void 0;var t=0,i=0;for(e.timeRemaining();this._i<this._tasks.length;)if(t=Date.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,Date.now()-t),1.5*(i=Math.max(t,i))>e.timeRemaining())return void this._start();this.clear()}}])}(),o=function(e){function t(){return _(this,t),a(this,t,arguments)}return h(t,e),p(t,[{key:"_requestCallback",value:function(e){var t=this;return setTimeout((function(){return e(t._createDeadline(16))}))}},{key:"_cancelCallback",value:function(e){clearTimeout(e)}},{key:"_createDeadline",value:function(e){var t=Date.now()+e;return{timeRemaining:function(){return Math.max(0,t-Date.now())}}}}])}(n);t.PriorityTaskQueue=o,t.IdleTaskQueue=!r.isNode&&"requestIdleCallback"in window?function(e){function t(){return _(this,t),a(this,t,arguments)}return h(t,e),p(t,[{key:"_requestCallback",value:function(e){return requestIdleCallback(e)}},{key:"_cancelCallback",value:function(e){cancelIdleCallback(e)}}])}(n):o,t.DebouncedIdleTask=function(){function e(){_(this,e),this._queue=new t.IdleTaskQueue}return p(e,[{key:"set",value:function(e){this._queue.clear(),this._queue.enqueue(e)}},{key:"flush",value:function(){this._queue.flush()}}])}()},147:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;var i=function(){function e(){_(this,e),this.fg=0,this.bg=0,this.extended=new r}return p(e,[{key:"clone",value:function(){var t=new e;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t}},{key:"isInverse",value:function(){return 67108864&this.fg}},{key:"isBold",value:function(){return 134217728&this.fg}},{key:"isUnderline",value:function(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:268435456&this.fg}},{key:"isBlink",value:function(){return 536870912&this.fg}},{key:"isInvisible",value:function(){return 1073741824&this.fg}},{key:"isItalic",value:function(){return 67108864&this.bg}},{key:"isDim",value:function(){return 134217728&this.bg}},{key:"isStrikethrough",value:function(){return 2147483648&this.fg}},{key:"isProtected",value:function(){return 536870912&this.bg}},{key:"isOverline",value:function(){return 1073741824&this.bg}},{key:"getFgColorMode",value:function(){return 50331648&this.fg}},{key:"getBgColorMode",value:function(){return 50331648&this.bg}},{key:"isFgRGB",value:function(){return!(50331648&~this.fg)}},{key:"isBgRGB",value:function(){return!(50331648&~this.bg)}},{key:"isFgPalette",value:function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)}},{key:"isBgPalette",value:function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)}},{key:"isFgDefault",value:function(){return!(50331648&this.fg)}},{key:"isBgDefault",value:function(){return!(50331648&this.bg)}},{key:"isAttributeDefault",value:function(){return 0===this.fg&&0===this.bg}},{key:"getFgColor",value:function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}},{key:"getBgColor",value:function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}},{key:"hasExtendedAttrs",value:function(){return 268435456&this.bg}},{key:"updateExtended",value:function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}},{key:"getUnderlineColor",value:function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}},{key:"getUnderlineColorMode",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}},{key:"isUnderlineColorRGB",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&~this.extended.underlineColor):this.isFgRGB()}},{key:"isUnderlineColorPalette",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()}},{key:"isUnderlineColorDefault",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&this.extended.underlineColor):this.isFgDefault()}},{key:"getUnderlineStyle",value:function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}],[{key:"toColorRGB",value:function(e){return[e>>>16&255,e>>>8&255,255&e]}},{key:"fromColorRGB",value:function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]}}])}();t.AttributeData=i;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_(this,e),this._ext=0,this._urlId=0,this._ext=t,this._urlId=i}return p(e,[{key:"ext",get:function(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext},set:function(e){this._ext=e}},{key:"underlineStyle",get:function(){return this._urlId?5:(469762048&this._ext)>>26},set:function(e){this._ext&=-469762049,this._ext|=e<<26&469762048}},{key:"underlineColor",get:function(){return 67108863&this._ext},set:function(e){this._ext&=-67108864,this._ext|=67108863&e}},{key:"urlId",get:function(){return this._urlId},set:function(e){this._urlId=e}},{key:"clone",value:function(){return new e(this._ext,this._urlId)}},{key:"isEmpty",value:function(){return 0===this.underlineStyle&&0===this._urlId}}])}();t.ExtendedAttrs=r},782:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;var r=i(133),n=i(855),o=i(147),s=function(e){function t(){var e;return _(this,t),(e=a(this,t,arguments)).content=0,e.fg=0,e.bg=0,e.extended=new o.ExtendedAttrs,e.combinedData="",e}return h(t,e),p(t,[{key:"isCombined",value:function(){return 2097152&this.content}},{key:"getWidth",value:function(){return this.content>>22}},{key:"getChars",value:function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,r.stringFromCodePoint)(2097151&this.content):""}},{key:"getCode",value:function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}},{key:"setFromCharData",value:function(e){this.fg=e[n.CHAR_DATA_ATTR_INDEX],this.bg=0;var t=!1;if(e[n.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[n.CHAR_DATA_CHAR_INDEX].length){var i=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){var r=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=r&&r<=57343?this.content=1024*(i-55296)+r-56320+65536|e[n.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[n.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[n.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[n.CHAR_DATA_WIDTH_INDEX]<<22)}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}],[{key:"fromCharData",value:function(e){var i=new t;return i.setFromCharData(e),i}}])}(o.AttributeData);t.CellData=s},855:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},133:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,r="",n=t;n<i;++n){var o=e[n];o>65535?(o-=65536,r+=String.fromCharCode(55296+(o>>10))+String.fromCharCode(o%1024+56320)):r+=String.fromCharCode(o)}return r},t.StringToUtf32=function(){function e(){_(this,e),this._interim=0}return p(e,[{key:"clear",value:function(){this._interim=0}},{key:"decode",value:function(e,t){var i=e.length;if(!i)return 0;var r=0,n=0;if(this._interim){var o=e.charCodeAt(n++);56320<=o&&o<=57343?t[r++]=1024*(this._interim-55296)+o-56320+65536:(t[r++]=this._interim,t[r++]=o),this._interim=0}for(var a=n;a<i;++a){var s=e.charCodeAt(a);if(55296<=s&&s<=56319){if(++a>=i)return this._interim=s,r;var c=e.charCodeAt(a);56320<=c&&c<=57343?t[r++]=1024*(s-55296)+c-56320+65536:(t[r++]=s,t[r++]=c)}else 65279!==s&&(t[r++]=s)}return r}}])}(),t.Utf8ToUtf32=function(){function e(){_(this,e),this.interim=new Uint8Array(3)}return p(e,[{key:"clear",value:function(){this.interim.fill(0)}},{key:"decode",value:function(e,t){var i=e.length;if(!i)return 0;var r,n,o,a,s=0,c=0,l=0;if(this.interim[0]){var h=!1,u=this.interim[0];u&=192==(224&u)?31:224==(240&u)?15:7;for(var d,v=0;(d=63&this.interim[++v])&&v<4;)u<<=6,u|=d;for(var f=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,_=f-v;l<_;){if(l>=i)return 0;if(128!=(192&(d=e[l++]))){l--,h=!0;break}this.interim[v++]=d,u<<=6,u|=63&d}h||(2===f?u<128?l--:t[s++]=u:3===f?u<2048||u>=55296&&u<=57343||65279===u||(t[s++]=u):u<65536||u>1114111||(t[s++]=u)),this.interim.fill(0)}for(var g=i-4,p=l;p<i;){for(;!(!(p<g)||128&(r=e[p])||128&(n=e[p+1])||128&(o=e[p+2])||128&(a=e[p+3]));)t[s++]=r,t[s++]=n,t[s++]=o,t[s++]=a,p+=4;if((r=e[p++])<128)t[s++]=r;else if(192==(224&r)){if(p>=i)return this.interim[0]=r,s;if(128!=(192&(n=e[p++]))){p--;continue}if((c=(31&r)<<6|63&n)<128){p--;continue}t[s++]=c}else if(224==(240&r)){if(p>=i)return this.interim[0]=r,s;if(128!=(192&(n=e[p++]))){p--;continue}if(p>=i)return this.interim[0]=r,this.interim[1]=n,s;if(128!=(192&(o=e[p++]))){p--;continue}if((c=(15&r)<<12|(63&n)<<6|63&o)<2048||c>=55296&&c<=57343||65279===c)continue;t[s++]=c}else if(240==(248&r)){if(p>=i)return this.interim[0]=r,s;if(128!=(192&(n=e[p++]))){p--;continue}if(p>=i)return this.interim[0]=r,this.interim[1]=n,s;if(128!=(192&(o=e[p++]))){p--;continue}if(p>=i)return this.interim[0]=r,this.interim[1]=n,this.interim[2]=o,s;if(128!=(192&(a=e[p++]))){p--;continue}if((c=(7&r)<<18|(63&n)<<12|(63&o)<<6|63&a)<65536||c>1114111)continue;t[s++]=c}}return s}}])}()},776:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a},o=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;var c,l=i(859),u=i(97),d={trace:u.LogLevelEnum.TRACE,debug:u.LogLevelEnum.DEBUG,info:u.LogLevelEnum.INFO,warn:u.LogLevelEnum.WARN,error:u.LogLevelEnum.ERROR,off:u.LogLevelEnum.OFF},v=t.LogService=function(e){function t(e){var i;return _(this,t),(i=a(this,t))._optionsService=e,i._logLevel=u.LogLevelEnum.OFF,i._updateLogLevel(),i.register(i._optionsService.onSpecificOptionChange("logLevel",(function(){return i._updateLogLevel()}))),c=s(i),i}return h(t,e),p(t,[{key:"logLevel",get:function(){return this._logLevel}},{key:"_updateLogLevel",value:function(){this._logLevel=d[this._optionsService.rawOptions.logLevel]}},{key:"_evalLazyOptionalParams",value:function(e){for(var t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())}},{key:"_log",value:function(e,t,i){this._evalLazyOptionalParams(i),e.call.apply(e,[console,(this._optionsService.options.logger?"":"xterm.js: ")+t].concat(r(i)))}},{key:"trace",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this._logLevel<=u.LogLevelEnum.TRACE&&this._log(null!==(i=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.trace.bind(this._optionsService.options.logger))&&void 0!==i?i:console.log,e,n)}},{key:"debug",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this._logLevel<=u.LogLevelEnum.DEBUG&&this._log(null!==(i=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.debug.bind(this._optionsService.options.logger))&&void 0!==i?i:console.log,e,n)}},{key:"info",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this._logLevel<=u.LogLevelEnum.INFO&&this._log(null!==(i=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.info.bind(this._optionsService.options.logger))&&void 0!==i?i:console.info,e,n)}},{key:"warn",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this._logLevel<=u.LogLevelEnum.WARN&&this._log(null!==(i=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.warn.bind(this._optionsService.options.logger))&&void 0!==i?i:console.warn,e,n)}},{key:"error",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this._logLevel<=u.LogLevelEnum.ERROR&&this._log(null!==(i=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.error.bind(this._optionsService.options.logger))&&void 0!==i?i:console.error,e,n)}}])}(l.Disposable);t.LogService=v=n([o(0,u.IOptionsService)],v),t.setTraceLogger=function(e){c=e},t.traceCall=function(e,t,i){if("function"!=typeof i.value)throw new Error("not supported");var r=i.value;i.value=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(c.logLevel!==u.LogLevelEnum.TRACE)return r.apply(this,t);c.trace("GlyphRenderer#".concat(r.name,"(").concat(t.map((function(e){return JSON.stringify(e)})).join(", "),")"));var n=r.apply(this,t);return c.trace("GlyphRenderer#".concat(r.name," return"),n),n}}},726:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;var i="di$target",r="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(e){return e[r]||[]},t.createDecorator=function(e){if(t.serviceRegistry.has(e))return t.serviceRegistry.get(e);var n=function(e,t,o){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");!function(e,t,n){t[i]===t?t[r].push({id:e,index:n}):(t[r]=[{id:e,index:n}],t[i]=t)}(n,e,o)};return n.toString=function(){return e},t.serviceRegistry.set(e,n),n}},97:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;var r,n=i(726);t.IBufferService=(0,n.createDecorator)("BufferService"),t.ICoreMouseService=(0,n.createDecorator)("CoreMouseService"),t.ICoreService=(0,n.createDecorator)("CoreService"),t.ICharsetService=(0,n.createDecorator)("CharsetService"),t.IInstantiationService=(0,n.createDecorator)("InstantiationService"),function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.OFF=5]="OFF"}(r||(t.LogLevelEnum=r={})),t.ILogService=(0,n.createDecorator)("LogService"),t.IOptionsService=(0,n.createDecorator)("OptionsService"),t.IOscLinkService=(0,n.createDecorator)("OscLinkService"),t.IUnicodeService=(0,n.createDecorator)("UnicodeService"),t.IDecorationService=(0,n.createDecorator)("DecorationService")}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,i),o.exports}var c={};return function(){var e=c;Object.defineProperty(e,"__esModule",{value:!0}),e.WebglAddon=void 0;var t=i(345),r=i(859),n=i(399),o=i(666),s=i(776),l=function(e){function i(e){var r;if(_(this,i),n.isSafari&&(0,n.getSafariVersion)()<16)throw new Error("Webgl2 is only supported on Safari 16 and above");return(r=a(this,i))._preserveDrawingBuffer=e,r._onChangeTextureAtlas=r.register(new t.EventEmitter),r.onChangeTextureAtlas=r._onChangeTextureAtlas.event,r._onAddTextureAtlasCanvas=r.register(new t.EventEmitter),r.onAddTextureAtlasCanvas=r._onAddTextureAtlasCanvas.event,r._onRemoveTextureAtlasCanvas=r.register(new t.EventEmitter),r.onRemoveTextureAtlasCanvas=r._onRemoveTextureAtlasCanvas.event,r._onContextLoss=r.register(new t.EventEmitter),r.onContextLoss=r._onContextLoss.event,r}return h(i,e),p(i,[{key:"activate",value:function(e){var i=this,n=e._core;if(e.element){this._terminal=e;var a=n.coreService,c=n.optionsService,l=n,h=l._renderService,u=l._characterJoinerService,d=l._charSizeService,v=l._coreBrowserService,f=l._decorationService,_=l._logService,g=l._themeService;(0,s.setTraceLogger)(_),this._renderer=this.register(new o.WebglRenderer(e,u,d,v,a,f,c,g,this._preserveDrawingBuffer)),this.register((0,t.forwardEvent)(this._renderer.onContextLoss,this._onContextLoss)),this.register((0,t.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,t.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this.register((0,t.forwardEvent)(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),h.setRenderer(this._renderer),this.register((0,r.toDisposable)((function(){var t=i._terminal._core._renderService;t.setRenderer(i._terminal._core._createRenderer()),t.handleResize(e.cols,e.rows)})))}else this.register(n.onWillOpen((function(){return i.activate(e)})))}},{key:"textureAtlas",get:function(){var e;return null===(e=this._renderer)||void 0===e?void 0:e.textureAtlas}},{key:"clearTextureAtlas",value:function(){var e;null===(e=this._renderer)||void 0===e||e.clearTextureAtlas()}}])}(r.Disposable);e.WebglAddon=l}(),c}()}(B);var I=B.exports,N={class:"dycloud-form-box"},U={id:"terminal",ref:"terminal",style:{height:"100vh"}},W={name:"Terminal"};t("default",Object.assign(W,{setup:function(t){var r=u("sh"),n=[{value:"bash",label:"/bin/bash"},{value:"sh",label:"/bin/sh"}],o=v();f((function(){z(r.value)}));var a=u(null),s=u(null),c=u(!1),l=u(""),h=u("");h.value=o.query.containerId;var d=u("");d.value=o.query.currentHost;var _=u(!1),p=u(null),B=u(null);g((function(){c.value=!1,window.removeEventListener("resize",(function(){}),!1)}));var W=function(){var t=i(e().mark((function t(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.value.fit(),c.value=!0,e.next=4,D(d.value,{id:l.value,width:a.value.cols,height:a.value.rows});case 4:0===e.sent.code&&a.value.focus();case 6:case"end":return e.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),j=function(e,t){var i=null;return function(){null!==i&&clearTimeout(i),i=setTimeout(e,t)}},z=function(){var t=i(e().mark((function t(i){var r;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _.value=!0,s.value&&s.value.close(),a.value&&a.value.dispose(document.getElementById("terminal")),e.next=5,T(d.value,{id:h.value,execType:i});case 5:if(0!==(r=e.sent).code){e.next=10;break}return l.value=r.data.Id,e.next=10,H(r.data.Id);case 10:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),H=function(){var t=i(e().mark((function t(r){var n,o,h,v;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c.value=!1,n=u("ws://"),-1!=="https://".indexOf("https://")&&(n.value="wss://"),o=y(),h="".concat(n.value).concat(window.location.host,"/api","/docker/").concat(d.value,"/container/exec/term/").concat(r,"?x-token=").concat(o.token),s.value=new WebSocket(h),s.value.onopen=W,v=new F.AttachAddon(s.value),p.value=new O.FitAddon,B.value=new I.WebglAddon,a.value=new P.Terminal,v.activate(a.value),p.value.activate(a.value),a.value.open(document.getElementById("terminal")),p.value.fit(),B.value.activate(a.value),B.value.onContextLoss=function(){p.value.dispose()},window.addEventListener("resize",j(function(){var t=i(e().mark((function t(i){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p.value.fit(),!c.value){e.next=6;break}return e.next=4,D(d.value,{id:l.value,width:a.value.cols,height:a.value.rows});case 4:0===e.sent.code&&a.value.focus();case 6:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),1500),!1),_.value=!1;case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return function(e,t){var i=k,o=S,a=A;return m(),C("div",N,[t[1]||(t[1]=w(" 终端类型: ")),L(o,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=function(e){return r.value=e}),style:{width:"150px"},onChange:z},{default:x((function(){return[(m(),C(b,null,R(n,(function(e){return L(i,{key:e.value,label:e.label,value:e.value,disabled:e.disabled},null,8,["label","value","disabled"])})),64))]})),_:1},8,["modelValue"]),M(E("div",U,null,512),[[a,_.value]])])}}}))}}}))}();
