/*! 
 Build based on  
 Time : 1735190558000 */
import{a as e,q as a,o as l,c as t,b as o,e as s,w as i,F as u,v as d,h as n,g as r,m as p,t as m,i as c,E as v,k as f}from"./index.ABWJOL2Q.js";import{E as g}from"./pagination.BfYt3rvk.js";/* empty css            */import{E as y,a as j}from"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              */import{E as h}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";import{E as b,a as w}from"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                *//* empty css             *//* empty css               */import{a as x,E as _}from"./form-item.ujPiwBAF.js";import{p as k,l as C,d as V}from"./image.CZxWpT28.js";import{g as I}from"./host.9Piocw2G.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./index.D4uEcQv3.js";import"./index.BRjlB3m5.js";import"./index.DglrVZRl.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./refs.CZv2DkwS.js";import"./_initCloneObject.jmqS1x-g.js";import"./_baseClone.gl1e0kmI.js";const z={class:"dycloud-form-box"},E={style:{"margin-bottom":"15px",display:"inline-block"}},S={slot:"footer"},U={slot:"footer",class:"dialog-footer"},A={class:"dycloud-pagination"},H={name:"Image"},q=Object.assign(H,{setup(H){const q=e(1),D=e(0),F=e(10),O=e=>{F.value=e,Q()},K=e=>{q.value=e,Q()},R=e(!1),B=e(!1),G=e({name:""}),J=e([]),L=e=>{J.value=e},M=e({}),N=async()=>{q.value=1,F.value=10,Q()},P=e([]),Q=async()=>{const e=await C(ee.value,{page:q.value,pageSize:F.value,name:M.value.name});0===e.code&&(D.value=e.data.total,q.value=e.data.page,F.value=e.data.pageSize,P.value=e.data.items)},T=e(!1),W=e({Ids:[]}),X=async()=>{const e=[];0!==J.value.length?(J.value&&J.value.map((a=>{e.push(a.id)})),W.value.Ids=e,T.value=!0):c({type:"warning",message:"请选择要删除的数据"})},Y=async()=>{T.value=!1},Z=async()=>{0===(await V(ee.value,{Ids:W.value.Ids})).code&&(c({type:"success",message:"删除成功"}),T.value=!1,Q())},$=e([]),ee=e("host"),ae=e=>{ee.value=e,window.localStorage.setItem("currentHost",e),le()},le=()=>{Q()};return a((()=>{(()=>{const e=window.localStorage.getItem("currentHost");e&&(ee.value=e)})(),(async()=>{$.value=[];const e=await I({pageSize:1e4});if(0===e.code)for(let a=0;a<e.data.list.length;a++)$.value.push({value:e.data.list[a].name,label:e.data.list[a].name})})(),le()})),(e,a)=>{const C=y,V=j,I=x,H=v,le=f,te=_,oe=b,se=w,ie=h,ue=g;return l(),t("div",z,[o("div",E,[s(te,{inline:!0,model:M.value,onKeyup:a[4]||(a[4]=p((e=>N()),["native","enter"]))},{default:i((()=>[s(I,{label:"主机:"},{default:i((()=>[s(V,{modelValue:ee.value,"onUpdate:modelValue":a[0]||(a[0]=e=>ee.value=e),onChange:ae,placeholder:"请选择主机"},{default:i((()=>[(l(!0),t(u,null,d($.value,(e=>(l(),n(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(I,null,{default:i((()=>[s(H,{type:"primary",icon:"download",onClick:a[1]||(a[1]=e=>(async()=>{R.value=!0})())},{default:i((()=>a[9]||(a[9]=[r("下载镜像")]))),_:1})])),_:1}),s(I,null,{default:i((()=>[s(H,{icon:"delete",style:{"margin-left":"10px"},disabled:!J.value.length,onClick:X},{default:i((()=>a[10]||(a[10]=[r("批量删除")]))),_:1},8,["disabled"])])),_:1}),s(I,null,{default:i((()=>[s(le,{modelValue:M.value.name,"onUpdate:modelValue":a[2]||(a[2]=e=>M.value.name=e),class:"search-input",placeholder:"输入镜像名称"},null,8,["modelValue"]),s(H,{style:{"margin-left":"20px"},type:"primary",icon:"search",onClick:a[3]||(a[3]=e=>N(M.value.name))},{default:i((()=>a[11]||(a[11]=[r("查询 ")]))),_:1})])),_:1})])),_:1},8,["model"])]),s(se,{data:P.value,style:{width:"100%",color:"#ffffff"},"row-key":"id",onSelectionChange:L},{default:i((()=>[s(oe,{type:"selection",width:"55"}),s(oe,{label:"镜像ID",prop:"id",width:"200px"},{default:i((e=>[r(m(e.row.id.replaceAll("sha256:","").substr(0,11)),1)])),_:1}),s(oe,{label:"镜像名称",prop:"tag",width:"350px"}),s(oe,{label:"创建时间",prop:"created",sortable:"",width:"200px"}),s(oe,{label:"镜像大小",prop:"size",sortable:"",width:"150px"}),s(oe,{label:"操作",width:"450px"},{default:i((e=>[s(H,{type:"danger",icon:"delete-filled",round:"",onClick:a=>(async e=>{W.value.Ids=[e],T.value=!0})(e.row.id)},null,8,["onClick"])])),_:1})])),_:1},8,["data"]),s(ie,{modelValue:R.value,"onUpdate:modelValue":a[7]||(a[7]=e=>R.value=e),title:"下载镜像",width:"400px","destroy-on-close":"true","show-close":!0},{default:i((()=>[o("div",null,[s(te,{ref:"pullImageRef",model:G.value},{default:i((()=>[s(I,{label:"镜像:",prop:"image"},{default:i((()=>[s(le,{modelValue:G.value.name,"onUpdate:modelValue":a[5]||(a[5]=e=>G.value.name=e),type:"text",placeholder:"nginx:latest",style:{width:"300px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])]),o("div",S,[s(H,{type:"primary",loading:B.value,round:"",onClick:a[6]||(a[6]=e=>(async()=>{B.value=!0,0===(await k(ee.value,G.value)).code&&(c({type:"success",message:"下载成功"}),Q(),R.value=!1),B.value=!1})())},{default:i((()=>a[12]||(a[12]=[r("开始下载")]))),_:1},8,["loading"])])])),_:1},8,["modelValue"]),s(ie,{modelValue:T.value,"onUpdate:modelValue":a[8]||(a[8]=e=>T.value=e),title:"是否确定删除?",width:"300px","show-close":!1},{default:i((()=>[o("div",U,[s(H,{type:"primary",onClick:Z},{default:i((()=>a[13]||(a[13]=[r("是")]))),_:1}),s(H,{onClick:Y},{default:i((()=>a[14]||(a[14]=[r("否")]))),_:1})])])),_:1},8,["modelValue"]),o("div",A,[s(ue,{"current-page":q.value,"page-size":F.value,"page-sizes":[10,30,50,100],total:D.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:K,onSizeChange:O},null,8,["current-page","page-size","total"])])])}}});export{q as default};
