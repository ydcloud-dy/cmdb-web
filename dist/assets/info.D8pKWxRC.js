/*! 
 Build based on  
 Time : 1735190558000 */
import{a as e,r as a,P as t,o as l,c as o,b as r,e as s,w as u,g as i,F as n,f as d,h as p,m as c,t as m,B as v,U as f,dS as y,v as g,cu as b,i as h,Q as j,E as w,k as C}from"./index.ABWJOL2Q.js";import{E as _}from"./drawer.XhtctEYG.js";import"./overlay.CDLw2uOw.js";/* empty css            */import{E as k,a as A}from"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              */import{E as x}from"./pagination.BfYt3rvk.js";import{E as V,a as D}from"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                *//* empty css             *//* empty css               */import{a as I,E}from"./form-item.ujPiwBAF.js";import{E as T}from"./date-picker.CCiP3Fyg.js";import{_ as U,a as z,g as B,b as F,d as S,f as O,e as P,c as Q,u as R}from"./rich-edit.B-XA77E4.js";import{g as q}from"./image.CN53lrx2.js";import{E as K}from"./index.D4uEcQv3.js";import{E as G}from"./index.DglrVZRl.js";import"./index.BRjlB3m5.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./_initCloneObject.jmqS1x-g.js";import"./_baseClone.gl1e0kmI.js";import"./dayjs.min.DOWqlKAh.js";import"./arrays.CvpzyGiz.js";import"./index.7ugBSK5z.js";import"./upload.-Ej7EZzx.js";import"./progress.KCbgDfe_.js";import"./cloneDeep.BwH6oqGn.js";const H={class:"dycloud-search-box"},J={class:"dycloud-table-box"},L={class:"dycloud-btn-list"},M={class:"file-list"},N={class:"dycloud-pagination"},W={class:"flex justify-between items-center"},X={class:"text-lg"},Y=Object.assign({name:"Info"},{__name:"info",setup(Y){const Z=e(!1),$=e({title:"",content:"",userID:void 0,attachments:[]}),ee=e([]);(async()=>{const e=await B();0===e.code&&(ee.value=e.data)})();const ae=a({}),te=a({createdAt:[{validator:(e,a,t)=>{ne.value.startCreatedAt&&!ne.value.endCreatedAt?t(new Error("请填写结束日期")):!ne.value.startCreatedAt&&ne.value.endCreatedAt?t(new Error("请填写开始日期")):ne.value.startCreatedAt&&ne.value.endCreatedAt&&(ne.value.startCreatedAt.getTime()===ne.value.endCreatedAt.getTime()||ne.value.startCreatedAt.getTime()>ne.value.endCreatedAt.getTime())?t(new Error("开始日期应当早于结束日期")):t()},trigger:"change"}]}),le=e(),oe=e(),re=e(1),se=e(0),ue=e(10),ie=e([]),ne=e({}),de=()=>{ne.value={},ve()},pe=()=>{var e;null==(e=oe.value)||e.validate((async e=>{e&&(re.value=1,ue.value=10,ve())}))},ce=e=>{ue.value=e,ve()},me=e=>{re.value=e,ve()},ve=async()=>{const e=await F({page:re.value,pageSize:ue.value,...ne.value});0===e.code&&(ie.value=e.data.list,se.value=e.data.total,re.value=e.data.page,ue.value=e.data.pageSize)};ve();(async()=>{})();const fe=e([]),ye=e=>{fe.value=e},ge=async()=>{b.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=[];if(0===fe.value.length)return void h({type:"warning",message:"请选择要删除的数据"});fe.value&&fe.value.map((a=>{e.push(a.ID)}));0===(await S({IDs:e})).code&&(h({type:"success",message:"删除成功"}),ie.value.length===e.length&&re.value>1&&re.value--,ve())}))},be=e(""),he=async e=>{0===(await P({ID:e.ID})).code&&(h({type:"success",message:"删除成功"}),1===ie.value.length&&re.value>1&&re.value--,ve())},je=e(!1),we=()=>{be.value="create",je.value=!0},Ce=()=>{je.value=!1,$.value={title:"",content:"",userID:void 0,attachments:[]}},_e=async()=>{var e;null==(e=le.value)||e.validate((async e=>{if(!e)return;let a;switch(be.value){case"create":default:a=await Q($.value);break;case"update":a=await R($.value)}0===a.code&&(h({type:"success",message:"创建/更改成功"}),Ce(),ve())}))};return(e,a)=>{const h=t("QuestionFilled"),B=j,F=K,S=T,P=I,Q=w,R=E,Y=V,ve=G,ke=D,Ae=x,xe=C,Ve=k,De=A,Ie=_;return l(),o("div",null,[r("div",H,[s(R,{ref_key:"elSearchFormRef",ref:oe,inline:!0,model:ne.value,class:"demo-form-inline",rules:te,onKeyup:c(pe,["enter"])},{default:u((()=>[s(P,{label:"创建日期",prop:"createdAt"},{label:u((()=>[r("span",null,[a[9]||(a[9]=i(" 创建日期 ")),s(F,{content:"搜索范围是开始日期（包含）至结束日期（不包含）"},{default:u((()=>[s(B,null,{default:u((()=>[s(h)])),_:1})])),_:1})])])),default:u((()=>[s(S,{modelValue:ne.value.startCreatedAt,"onUpdate:modelValue":a[0]||(a[0]=e=>ne.value.startCreatedAt=e),type:"datetime",placeholder:"开始日期","disabled-date":e=>!!ne.value.endCreatedAt&&e.getTime()>ne.value.endCreatedAt.getTime()},null,8,["modelValue","disabled-date"]),a[10]||(a[10]=i(" — ")),s(S,{modelValue:ne.value.endCreatedAt,"onUpdate:modelValue":a[1]||(a[1]=e=>ne.value.endCreatedAt=e),type:"datetime",placeholder:"结束日期","disabled-date":e=>!!ne.value.startCreatedAt&&e.getTime()<ne.value.startCreatedAt.getTime()},null,8,["modelValue","disabled-date"])])),_:1}),Z.value?(l(),o(n,{key:0},[],64)):d("",!0),s(P,null,{default:u((()=>[s(Q,{type:"primary",icon:"search",onClick:pe},{default:u((()=>a[11]||(a[11]=[i(" 查询 ")]))),_:1}),s(Q,{icon:"refresh",onClick:de},{default:u((()=>a[12]||(a[12]=[i(" 重置 ")]))),_:1}),Z.value?(l(),p(Q,{key:1,link:"",type:"primary",icon:"arrow-up",onClick:a[3]||(a[3]=e=>Z.value=!1)},{default:u((()=>a[14]||(a[14]=[i(" 收起 ")]))),_:1})):(l(),p(Q,{key:0,link:"",type:"primary",icon:"arrow-down",onClick:a[2]||(a[2]=e=>Z.value=!0)},{default:u((()=>a[13]||(a[13]=[i(" 展开 ")]))),_:1}))])),_:1})])),_:1},8,["model","rules"])]),r("div",J,[r("div",L,[s(Q,{type:"primary",icon:"plus",onClick:we},{default:u((()=>a[15]||(a[15]=[i(" 新增 ")]))),_:1}),s(Q,{icon:"delete",style:{"margin-left":"10px"},disabled:!fe.value.length,onClick:ge},{default:u((()=>a[16]||(a[16]=[i(" 删除 ")]))),_:1},8,["disabled"])]),s(ke,{ref:"multipleTable",style:{width:"100%"},"tooltip-effect":"dark",data:ie.value,"row-key":"ID",onSelectionChange:ye},{default:u((()=>[s(Y,{type:"selection",width:"55"}),s(Y,{align:"left",label:"日期",prop:"createdAt",width:"180"},{default:u((e=>[i(m(v(f)(e.row.CreatedAt)),1)])),_:1}),s(Y,{align:"left",label:"标题",prop:"title",width:"120"}),s(Y,{label:"内容",prop:"content",width:"200"},{default:u((e=>a[17]||(a[17]=[i(" [富文本内容] ")]))),_:1}),s(Y,{align:"left",label:"作者",prop:"userID",width:"120"},{default:u((e=>[r("span",null,m(v(y)(ee.value.userID,e.row.userID)),1)])),_:1}),s(Y,{label:"附件",prop:"attachments",width:"200"},{default:u((e=>[r("div",M,[(l(!0),o(n,null,g(e.row.attachments,(e=>(l(),p(ve,{key:e.uid,onClick:a=>{return t=e.url,void window.open(q(t),"_blank");var t}},{default:u((()=>[i(m(e.name),1)])),_:2},1032,["onClick"])))),128))])])),_:1}),s(Y,{align:"left",label:"操作",fixed:"right","min-width":"240"},{default:u((e=>[s(Q,{type:"primary",link:"",icon:"edit",class:"table-button",onClick:a=>(async e=>{const a=await O({ID:e.ID});be.value="update",0===a.code&&($.value=a.data,je.value=!0)})(e.row)},{default:u((()=>a[18]||(a[18]=[i(" 变更 ")]))),_:2},1032,["onClick"]),s(Q,{type:"primary",link:"",icon:"delete",onClick:a=>{return t=e.row,void b.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{he(t)}));var t}},{default:u((()=>a[19]||(a[19]=[i(" 删除 ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),r("div",N,[s(Ae,{layout:"total, sizes, prev, pager, next, jumper","current-page":re.value,"page-size":ue.value,"page-sizes":[10,30,50,100],total:se.value,onCurrentChange:me,onSizeChange:ce},null,8,["current-page","page-size","total"])])]),s(Ie,{modelValue:je.value,"onUpdate:modelValue":a[8]||(a[8]=e=>je.value=e),"destroy-on-close":"",size:"800","show-close":!1,"before-close":Ce},{header:u((()=>[r("div",W,[r("span",X,m("create"===be.value?"添加":"修改"),1),r("div",null,[s(Q,{type:"primary",onClick:_e},{default:u((()=>a[20]||(a[20]=[i(" 确 定 ")]))),_:1}),s(Q,{onClick:Ce},{default:u((()=>a[21]||(a[21]=[i(" 取 消 ")]))),_:1})])])])),default:u((()=>[s(R,{ref_key:"elFormRef",ref:le,model:$.value,"label-position":"top",rules:ae,"label-width":"80px"},{default:u((()=>[s(P,{label:"标题:",prop:"title"},{default:u((()=>[s(xe,{modelValue:$.value.title,"onUpdate:modelValue":a[4]||(a[4]=e=>$.value.title=e),clearable:!0,placeholder:"请输入标题"},null,8,["modelValue"])])),_:1}),s(P,{label:"内容:",prop:"content"},{default:u((()=>[s(U,{modelValue:$.value.content,"onUpdate:modelValue":a[5]||(a[5]=e=>$.value.content=e)},null,8,["modelValue"])])),_:1}),s(P,{label:"作者:",prop:"userID"},{default:u((()=>[s(De,{modelValue:$.value.userID,"onUpdate:modelValue":a[6]||(a[6]=e=>$.value.userID=e),placeholder:"请选择作者",style:{width:"100%"},clearable:!0},{default:u((()=>[(l(!0),o(n,null,g(ee.value.userID,((e,a)=>(l(),p(Ve,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(P,{label:"附件:",prop:"attachments"},{default:u((()=>[s(z,{modelValue:$.value.attachments,"onUpdate:modelValue":a[7]||(a[7]=e=>$.value.attachments=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}});export{Y as default};
