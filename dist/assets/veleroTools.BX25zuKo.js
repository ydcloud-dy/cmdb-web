/*! 
 Build based on  
 Time : 1735190558000 */
import{_ as e,a,o as t,c as s,b as i,e as o,w as n,F as l,d as r,B as p,g as m,i as u,E as c}from"./index.ABWJOL2Q.js";/* empty css               */import{E as d,a as v}from"./step.Cyb8VDAP.js";import{V as f}from"./velero.Buhf202L.js";import{M as y}from"./monaco-editor-vue3.es.BmYKexe9.js";import g from"./createVelero.oPxihKMk.js";import"./index.C5gbd99D.js";/* empty css             */import"./col.BzMVCOvM.js";import"./form-item.ujPiwBAF.js";import"./castArray.9wqFpW2Z.js";import"./_baseClone.gl1e0kmI.js";import"./_Uint8Array.BjvNwsUf.js";import"./_initCloneObject.jmqS1x-g.js";/* empty css              */const _={class:"page-container"},b={class:"center-container"},j={class:"center-container"},h={class:"content"},k={class:"button-container"},I={class:"button-container"},S=e({__name:"veleroTools",setup(e){const S=a(!0),O=a('mkdir -p /data/minio\ndocker run -d --name minio-server --env MINIO_ROOT_USER="user" --env MINIO_ROOT_PASSWORD="password" \\ \n--env MINIO_DEFAULT_BUCKETS="k8s-backup" --publish 9000:9000 --publish 9001:9001 -v \\ \n /data/minio:/bitnami/minio/data registry.cn-beijing.aliyuncs.com/dotbalo/minio:latest'),V=a(null);V.value={value:O.value,language:"yaml",theme:"vs-dark",selectOnLineNumbers:!0,roundedSelection:!1,readOnly:S.value,cursorStyle:"line",automaticLayout:!0,glyphMargin:!0,useTabStops:!1,autoIndent:!0,quickSuggestionsDelay:100};const x=a(1),M=a();a(!1);const w=()=>{x.value=2},C=()=>{x.value=1},E=a(null),T=(a({keywords:""}),async()=>{if(E.value){if(await E.value.submitForm()){let e;const a=E.value.getFormData();a.cluster_id=M.value,e=await f(a),0===e.code?u({type:"success",message:"创建Velero成功"}):u({type:"error",message:e.msg})}}});return window.addEventListener("setItemCluster",(e=>{M.value=parseInt(localStorage.getItem("cluster_id"))})),(e,a)=>{const u=d,f=v,S=c;return t(),s("div",_,[i("div",b,[o(f,{class:"centered-steps",space:400,active:x.value,"finish-status":"success"},{default:n((()=>[o(u,{title:"对象存储准备"}),o(u,{title:"Velero配置"})])),_:1},8,["active"])]),i("div",j,[i("div",h,[1===x.value?(t(),s(l,{key:0},[a[2]||(a[2]=r('<p class="section-title" data-v-533f6953> 说明 </p><p style="margin-top:20px;" data-v-533f6953> 使用Velero备份集群，数据默认存储在对象存储中。 可以使用Minio、Ceph和公有云的对象存储作为Velero的存储后端， 所以需要提前准备对象存储用于Velero。 </p><p class="section-title" data-v-533f6953> 安装Minio </p><p style="margin-top:20px;margin-bottom:20px;" data-v-533f6953> 如果没有可用的对象存储，可以使用如下命令快速安装一个 <a href="https://min.io/" target="_blank" data-v-533f6953>Minio</a></p>',4)),o(p(y),{value:O.value,"onUpdate:value":a[0]||(a[0]=e=>O.value=e),theme:"vs",options:V.value,language:"yaml",width:"100%",height:80},null,8,["value","options"]),a[3]||(a[3]=r('<p style="margin-top:20px;" data-v-533f6953> 创建完成之后，可以通过宿主机的IP:9001端口即可访问Minio的控制台，默认用户名密码：user/password， 如需修改密码，可以修改上述命令的环境变量。 </p><p style="margin-top:20px;" data-v-533f6953> 需要记录如下信息：地址、用户名（S3 Key）、密码（S3 Secret）、桶（Bucket）供Velero使用。 </p><p class="section-title" data-v-533f6953> 注意事项 </p><p style="margin-top:20px;" data-v-533f6953> 生产环境建议部署 <a href="https://min.io/docs/minio/linux/operations/install-deploy-manage/deploy-minio-multi-node-multi-drive.html" target="_blank" data-v-533f6953>高可用的Minio集群</a> 作为Velero的后端存储。 </p>',4)),i("div",k,[o(S,{type:"primary",onClick:w},{default:n((()=>a[1]||(a[1]=[m(" 下一步 ")]))),_:1})])],64)):(t(),s(l,{key:1},[o(g,{ref_key:"createVeleroRef",ref:E},null,512),i("div",I,[o(S,{onClick:C},{default:n((()=>a[4]||(a[4]=[m("上一步")]))),_:1}),o(S,{type:"primary",onClick:T},{default:n((()=>a[5]||(a[5]=[m("提交")]))),_:1})])],64))])])])}}},[["__scopeId","data-v-533f6953"]]);export{S as default};
