/*! 
 Build based on  
 Time : 1735190558000 */
import{a as e,H as a,P as t,o as s,c as l,b as o,e as i,w as r,g as m,f as d,i as u,k as n,E as p}from"./index.ABWJOL2Q.js";import{E as c}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";import{E as v}from"./pagination.BfYt3rvk.js";/* empty css            */import"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              *//* empty css             *//* empty css               */import{a as j,E as g}from"./form-item.ujPiwBAF.js";import{g as y}from"./k8s.DUZ1Kw0R.js";import f from"./yaml.D684Yn7D.js";import _ from"./recordTable.Dhft2QuK.js";import w from"./detail.BhVZTrzv.js";import k from"./createRestore.CZ3DXa1Q.js";import{e as b,f as V,g as x,h,i as C,j as E}from"./velero.Buhf202L.js";import"./index.BRjlB3m5.js";import"./refs.CZv2DkwS.js";import"./index.D4uEcQv3.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./index.DglrVZRl.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./_baseClone.gl1e0kmI.js";import"./_initCloneObject.jmqS1x-g.js";import"./monaco-editor-vue3.es.BmYKexe9.js";import"./js-yaml.B_ZKWvuw.js";import"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                */import"./popover.DFR01WU1.js";import"./dropdown.Co_mIot6.js";import"./col.BzMVCOvM.js";import"./tab-pane.fs024GHS.js";import"./index.C5gbd99D.js";import"./card.RgDT494R.js";import"./detail-basic.C5XH3jbK.js";import"./age.Du5VDnjl.js";import"./link.QK3LjIND.js";import"./detail-pods.B6dtbEQc.js";import"./dropdown-item.Bdep7Ju0.js";import"./metrics.Dq7Dbl3h.js";import"./terminal.CkdZuQYW.js";import"./xterm.BR7SOqRe.js";/* empty css              */import"./xterm-addon-fit.onOJMBm7.js";import"./index.DDa397GF.js";import"./index.DrIIbIcU.js";import"./terminal-log.p9WpB3Ej.js";import"./monitor.CqRBZu0a.js";import"./date-picker.CCiP3Fyg.js";import"./dayjs.min.DOWqlKAh.js";import"./arrays.CvpzyGiz.js";import"./index.7ugBSK5z.js";import"./detail-ports.B1_yjkTj.js";/* empty css                    *//* empty css              */import"./namespaces.DIn9v7pI.js";import"./index.DINKPDpR.js";const T={class:"dycloud-table-box"},z={class:"dycloud-btn-list"},S={key:0},L={class:"dycloud-pagination"},R={key:0},D={class:"dialog-footer"},N={key:1},U={class:"dialog-footer"},I={key:2},A={class:"dialog-footer"},F={key:3},H={class:"dialog-footer"},M={name:"veleroTasks"},O=Object.assign(M,{setup(M){const O=e({}),B=e(1),K=e(0),Y=e(10),q=e([]),J=e(""),P=e({keywords:"",namespace:""}),X=e(!1),G=()=>{P.value.keywords=""},Q=()=>{B.value=1,Y.value=10,$()},W=e=>{Y.value=e,$()},Z=e=>{B.value=e,$()},$=async()=>{const e=await b({cluster_id:P.value.cluster_id,page:B.value,pageSize:Y.value,namespace:P.value.namespace,keyword:P.value.keywords});0===e.code&&(e.data.items.forEach((e=>{e.status.expiration&&(e.status.expiration=new Date(e.status.expiration).toLocaleString()),e.metadata.creationTimestamp&&(e.metadata.creationTimestamp=new Date(e.metadata.creationTimestamp).toLocaleString()),e.status.startTimestamp&&(e.status.startTimestamp=new Date(e.status.startTimestamp).toLocaleString()),e.status.completionTimestamp&&(e.status.completionTimestamp=new Date(e.status.completionTimestamp).toLocaleString())})),q.value=e.data.items,K.value=e.data.total,B.value=e.data.page,Y.value=e.data.pageSize)},ee=e(!1),ae=e("");a((()=>"create"===ae.value?"新增":"更新"));const te=async e=>{ae.value="update",J.value="编辑";const a=await V({cluster_id:P.value.cluster_id,namespace:e.metadata.namespace,VeleroRecordName:e.metadata.name});a.data.items&&a.data.items.code?u({type:"error",message:a.data.items.message}):0===a.code&&(O.value=a.data.items,ee.value=!0)},se=e(!1),le=async e=>{ae.value="restore",J.value="还原",X.value=!1,O.value=y("restore",P.value.namespace,""),se.value=!0,O.value.spec.backupName=e.metadata.name},oe=async e=>{ae.value="update",J.value="编辑";const a=await V({cluster_id:P.value.cluster_id,namespace:e.metadata.namespace,VeleroRecordName:e.metadata.name});a.data.items&&a.data.items.code?u({type:"error",message:a.data.items.message}):0===a.code&&(O.value=a.data.items,X.value=!0,de.value=!0)},ie=()=>{ee.value=!1,de.value=!1,ue.value=!1,se.value=!1,O.value={}},re=async e=>{e.visible=!1;const a=await x({cluster_id:P.value.cluster_id,namespace:e.metadata.namespace,VeleroRecordName:e.metadata.name});a.data.items&&a.data.items.code?u({type:"error",message:a.data.items.message}):0===a.code&&(u({type:"success",message:"删除成功"}),$())},me=async e=>{let a;switch(ae.value){case"create":default:a=await h({cluster_id:P.value.cluster_id,content:e});break;case"update":a=await E({cluster_id:P.value.cluster_id,namespace:e.metadata.namespace,VeleroRecordName:e.metadata.name,content:e});break;case"restore":a=await C({cluster_id:P.value.cluster_id,namespace:e.metadata.namespace,content:e})}a.data.items&&a.data.items.code?u({type:"error",message:a.data.items.message}):0===a.code&&(ie(),(async e=>{0===e.code&&(u({type:"success",message:e.msg}),$())})(a))},de=e(!1),ue=e(!1),ne=async e=>{const a=await V({cluster_id:P.value.cluster_id,namespace:e.metadata.namespace,VeleroRecordName:e.metadata.name});a.data.items&&a.data.items.code?u({type:"error",message:a.data.items.message}):(0===a.code&&(J.value="详情",O.value=a.data.items,O.value.cluster_id=P.value.cluster_id,O.value.type="deployment"),ue.value=!0)};return window.addEventListener("setItemCluster",(e=>{P.value.cluster_id=parseInt(localStorage.getItem("cluster_id"))})),window.addEventListener("setItemNamespace",(e=>{P.value.namespace=localStorage.getItem("namespace"),$()})),(e,a)=>{const u=n,b=j,V=p,x=g,h=v,C=c,E=t("CreateVeleroRecord");return s(),l("div",null,[o("div",T,[o("div",z,[i(x,{ref:"searchForm",inline:!0,model:P.value},{default:r((()=>[i(b,{label:"名称"},{default:r((()=>[i(u,{modelValue:P.value.keywords,"onUpdate:modelValue":a[0]||(a[0]=e=>P.value.keywords=e),placeholder:"名称"},null,8,["modelValue"])])),_:1}),i(b,null,{default:r((()=>[i(V,{size:"small",type:"primary",icon:"search",onClick:Q},{default:r((()=>a[7]||(a[7]=[m("查询")]))),_:1}),i(V,{size:"small",icon:"refresh",onClick:G},{default:r((()=>a[8]||(a[8]=[m("重置")]))),_:1}),i(V,{size:"small",type:"primary",icon:"plus",onClick:a[1]||(a[1]=e=>(ae.value="create",J.value="创建",O.value=y("backup",P.value.namespace,""),void(ee.value=!0)))},{default:r((()=>a[9]||(a[9]=[m("YAML")]))),_:1}),i(V,{size:"small",type:"primary",icon:"plus",onClick:a[2]||(a[2]=e=>(ae.value="create",J.value="创建",X.value=!1,O.value=y("backup",P.value.namespace,""),void(de.value=!0)))},{default:r((()=>a[10]||(a[10]=[m("新增")]))),_:1})])),_:1})])),_:1},8,["model"])]),q.value?(s(),l("div",S,[i(_,{"table-data":q.value,onYaml_update:te,onReduction:le,onUpdate:oe,onDetail:ne,onDelete:re},null,8,["table-data"])])):d("",!0)]),o("div",L,[i(h,{"current-page":B.value,"page-size":Y.value,"page-sizes":[10,30,50,100],total:K.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:Z,onSizeChange:W},null,8,["current-page","page-size","total"])]),ee.value?(s(),l("div",R,[i(C,{modelValue:ee.value,"onUpdate:modelValue":a[3]||(a[3]=e=>ee.value=e),width:"60%",title:J.value},{default:r((()=>[o("div",D,[i(f,{data:O.value,onClose:ie,onEnter:me},null,8,["data"])])])),_:1},8,["modelValue","title"])])):d("",!0),de.value?(s(),l("div",N,[i(C,{modelValue:de.value,"onUpdate:modelValue":a[4]||(a[4]=e=>de.value=e),title:"dialogTitle",width:"70%"},{default:r((()=>[o("div",U,[i(E,{cluster:P.value.cluster_id,form:O.value,readonly:X.value,onClose:ie,onEnter:me},null,8,["cluster","form","readonly"])])])),_:1},8,["modelValue"])])):d("",!0),se.value?(s(),l("div",I,[i(C,{modelValue:se.value,"onUpdate:modelValue":a[5]||(a[5]=e=>se.value=e),title:"dialogTitle",width:"70%"},{default:r((()=>[o("div",A,[i(k,{cluster:P.value.cluster_id,form:O.value,readonly:X.value,onClose:ie,onEnter:me},null,8,["cluster","form","readonly"])])])),_:1},8,["modelValue"])])):d("",!0),ue.value?(s(),l("div",F,[i(C,{modelValue:ue.value,"onUpdate:modelValue":a[6]||(a[6]=e=>ue.value=e),width:"70%",title:J.value},{default:r((()=>[o("div",H,[i(w,{data:O.value,"read-only":X.value,onClose:ie,onEnter:me},null,8,["data","read-only"])])])),_:1},8,["modelValue","title"])])):d("",!0)])}}});export{O as default};
