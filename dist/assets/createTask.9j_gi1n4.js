/*! 
 Build based on  
 Time : 1735190558000 */
import{_ as e,r as l,a,q as s,o,h as t,w as d,e as u,c as n,F as i,v as r,g as m,t as p,f as c,b as v,O as f,k as b,E as j}from"./index.ABWJOL2Q.js";/* empty css             *//* empty css               */import{E as _,a as V}from"./col.BzMVCOvM.js";/* empty css            */import{E as y,a as h}from"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css                    *//* empty css              */import{a as g,E as x}from"./form-item.ujPiwBAF.js";/* empty css              */import{g as U}from"./namespaces.DIn9v7pI.js";import{E as k,a as R}from"./index.DINKPDpR.js";import"./index.D4uEcQv3.js";import"./index.BRjlB3m5.js";import"./index.DglrVZRl.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./_baseClone.gl1e0kmI.js";import"./_initCloneObject.jmqS1x-g.js";const N={class:"button-container"},E={name:"CreateVeleroTask"},w=e(Object.assign(E,{props:{form:Object,readonly:Boolean,isUpdate:Boolean},emits:["close","enter"],setup(e,{emit:E}){var w,C,I,q,O,S,A,B,F,z,K,L,T,D,G,H,J,M,P,Q,W,X,Y,Z,$,ee,le,ae,se,oe,te;const de=l({name:[{required:!0,message:"字段值不可为空"}]}),ue=[{label:"备份所有命名空间",value:1},{label:"备份指定命名空间",value:2}],ne=[{label:"备份所有资源类型",value:1},{label:"备份指定资源类型",value:2}],ie=a(null),re=e,me=E,pe=l({name:(null==(C=null==(w=re.form)?void 0:w.metadata)?void 0:C.name)||"",includedNamespaces:(null==(S=null==(O=null==(q=null==(I=re.form)?void 0:I.spec)?void 0:q.template)?void 0:O.includedNamespaces)?void 0:S.includes("*"))?1:2,namespaces:(null==(z=null==(F=null==(B=null==(A=re.form)?void 0:A.spec)?void 0:B.template)?void 0:F.includedNamespaces)?void 0:z.includes("*"))?[]:(null==(T=null==(L=null==(K=re.form)?void 0:K.spec)?void 0:L.template)?void 0:T.includedNamespaces)||[],schedule:(null==(G=null==(D=re.form)?void 0:D.spec)?void 0:G.schedule)||"1 0 * * *",includedResources:(null==(P=null==(M=null==(J=null==(H=re.form)?void 0:H.spec)?void 0:J.template)?void 0:M.includedResources)?void 0:P.includes("*"))?1:2,ttl:(null==(X=null==(W=null==(Q=re.form)?void 0:Q.spec)?void 0:W.template)?void 0:X.ttl)||"720h0m0s",annotations:(null==(Z=null==(Y=re.form)?void 0:Y.metadata)?void 0:Z.annotations)||"",resources:(null==(ae=null==(le=null==(ee=null==($=re.form)?void 0:$.spec)?void 0:ee.template)?void 0:le.includedResources)?void 0:ae.includes("*"))?[]:(null==(te=null==(oe=null==(se=re.form)?void 0:se.spec)?void 0:oe.template)?void 0:te.includedResources)||[]}),ce=()=>{1===pe.includedNamespaces&&(pe.namespaces=["*"]),1===pe.includedResources?pe.resources=["*"]:"string"==typeof pe.resources&&(pe.resources=pe.resources.split("\n").map((e=>e.trim())).filter((e=>e.length>0))),ie.value.validate((e=>{e&&me("enter",{metadata:{name:pe.name,annotations:pe.annotations},spec:{schedule:pe.schedule,template:{includedNamespaces:pe.namespaces,includedResources:pe.resources,ttl:pe.ttl}}})}))},ve=a([]);let fe=a(null);const be=async()=>{if(fe.value=parseInt(localStorage.getItem("cluster_id")),null!==fe.value){const e=await U({id:fe.value});0===e.code&&(ve.value=e.data.namespaces.map((e=>({label:e,value:e}))))}};return s((()=>{window.addEventListener("setItemCluster",be),be()})),(l,a)=>{const s=b,U=g,E=_,w=k,C=R,I=y,q=h,O=V,S=j,A=x;return o(),t(A,{model:pe,ref_key:"vForm",ref:ie,rules:de,"label-position":"left","label-width":"80px",size:"medium",onSubmit:a[8]||(a[8]=f((()=>{}),["prevent"]))},{default:d((()=>[u(O,{gutter:20},{default:d((()=>[u(E,{span:6,offset:3},{default:d((()=>[u(U,{label:"名称",prop:"name",class:"required"},{default:d((()=>[u(s,{modelValue:pe.name,"onUpdate:modelValue":a[0]||(a[0]=e=>pe.name=e),type:"text",placeholder:"请输入备份任务名称",clearable:""},null,8,["modelValue"])])),_:1}),u(U,{label:"备份策略",prop:"schedule"},{default:d((()=>[u(s,{modelValue:pe.schedule,"onUpdate:modelValue":a[1]||(a[1]=e=>pe.schedule=e),type:"text",clearable:""},null,8,["modelValue"])])),_:1}),u(U,{label:"保留时长",prop:"ttl"},{default:d((()=>[u(s,{modelValue:pe.ttl,"onUpdate:modelValue":a[2]||(a[2]=e=>pe.ttl=e),type:"text",clearable:""},null,8,["modelValue"])])),_:1}),u(U,{label:"备注信息",prop:"annotations"},{default:d((()=>[u(s,{modelValue:pe.annotations,"onUpdate:modelValue":a[3]||(a[3]=e=>pe.annotations=e),type:"text",placeholder:"添加备注信息",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),u(E,{span:8},{default:d((()=>[u(U,{label:"命名空间",prop:"includedNamespaces"},{default:d((()=>[u(C,{modelValue:pe.includedNamespaces,"onUpdate:modelValue":a[4]||(a[4]=e=>pe.includedNamespaces=e)},{default:d((()=>[(o(),n(i,null,r(ue,((e,l)=>u(w,{key:l,label:e.value,disabled:e.disabled},{default:d((()=>[m(p(e.label),1)])),_:2},1032,["label","disabled"]))),64))])),_:1},8,["modelValue"])])),_:1}),u(U,{label:"资源选择",prop:"includedResources"},{default:d((()=>[u(C,{modelValue:pe.includedResources,"onUpdate:modelValue":a[5]||(a[5]=e=>pe.includedResources=e)},{default:d((()=>[(o(),n(i,null,r(ne,((e,l)=>u(w,{key:l,label:e.value,disabled:e.disabled},{default:d((()=>[m(p(e.label),1)])),_:2},1032,["label","disabled"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(E,{span:6},{default:d((()=>[2===pe.includedNamespaces?(o(),t(U,{key:0,label:"命名空间",prop:"namespaces"},{default:d((()=>[u(q,{modelValue:pe.namespaces,"onUpdate:modelValue":a[6]||(a[6]=e=>pe.namespaces=e),class:"full-width-input",clearable:"",multiple:""},{default:d((()=>[(o(!0),n(i,null,r(ve.value,((e,l)=>(o(),t(I,{key:l,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):c("",!0),2===pe.includedResources?(o(),t(U,{key:1,label:"资源类型",prop:"resources"},{default:d((()=>[u(s,{modelValue:pe.resources,"onUpdate:modelValue":a[7]||(a[7]=e=>pe.resources=e),type:"textarea",placeholder:"请输入资源类型",clearable:""},null,8,["modelValue"])])),_:1})):c("",!0)])),_:1})])),_:1}),v("div",N,[u(S,{type:"primary",onClick:ce},{default:d((()=>[m(p(e.isUpdate?"更新":"新增"),1)])),_:1})])])),_:1},8,["model","rules"])}}}),[["__scopeId","data-v-4be53ac5"]]);export{w as default};
