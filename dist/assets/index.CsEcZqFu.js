/*! 
 Build based on  
 Time : 1735190558000 */
import{a as e,o as a,c as l,b as t,e as s,w as o,F as i,v as r,h as u,g as d,f as m,i as n,k as p,E as c}from"./index.ABWJOL2Q.js";import{E as v}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";import{E as j}from"./pagination.BfYt3rvk.js";/* empty css            */import{E as g,a as y}from"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              *//* empty css             *//* empty css               */import{a as f,E as _}from"./form-item.ujPiwBAF.js";import{g as b}from"./k8sCluster.LvLN1W31.js";import{G as k,N as w,a as h,b as x}from"./namespaces.DIn9v7pI.js";import C from"./form.DR0CAim9.js";import V from"./table.acNIT5Wb.js";import{_ as z,a as E}from"./index.D2JmR_vB.js";import"./index.BRjlB3m5.js";import"./refs.CZv2DkwS.js";import"./index.D4uEcQv3.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./index.DglrVZRl.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./_baseClone.gl1e0kmI.js";import"./_initCloneObject.jmqS1x-g.js";import"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                */import"./popover.DFR01WU1.js";import"./dropdown.Co_mIot6.js";import"./age.Du5VDnjl.js";import"./warningBar.BzThqhMC.js";import"./terminal.CkdZuQYW.js";import"./xterm.BR7SOqRe.js";/* empty css              */import"./xterm-addon-fit.onOJMBm7.js";import"./files.U5RRtO1D.js";import"./link.QK3LjIND.js";import"./upload.-Ej7EZzx.js";import"./progress.KCbgDfe_.js";import"./cloneDeep.BwH6oqGn.js";const I={class:"dycloud-search-box"},S={class:"dycloud-table-box"},U={class:"dycloud-btn-list"},N={key:0},A={class:"dycloud-pagination"},D={key:0},F={key:1},L={class:"dialog-footer"},O={name:"Index"},q=Object.assign(O,{setup(O){const q=e({apiVersion:"v1",kind:"Namespace",metadata:{name:"",annotations:{},labels:{}}}),B=e(1),G=e(0),H=e(10),M=e([]),W=e(""),J=e({keywords:""}),K=e([]),P=()=>{J.value={}},Q=()=>{B.value=1,H.value=10,X()},R=e=>{H.value=e,X()},T=e=>{B.value=e,X()},X=async e=>{e&&await(async()=>{const e=await b({page:1,pageSize:1e4});0===e.code&&(K.value=e.data.list,J.value.cluster_id=K.value[0].id,parseInt(localStorage.getItem("cluster_id"))>0?(J.value.cluster_id=parseInt(localStorage.getItem("cluster_id")),E(J.value.cluster_id)):E(K.value[0].id))})();const a=await k({cluster_id:J.value.cluster_id,page:B.value,pageSize:H.value,keyword:J.value.keywords});0===a.code&&(M.value=a.data.items,G.value=a.data.total,B.value=a.data.page,H.value=a.data.pageSize)};X(!0);const Y=e(!1),Z=e(""),$=async e=>{Z.value="update",W.value="更新",q.value=e,Y.value=!0},ee=()=>{Y.value=!1,q.value={apiVersion:"v1",kind:"Namespace",metadata:{name:"",annotations:{},labels:{}}}},ae=async e=>{const a=await w({cluster_id:J.value.cluster_id,namespaceName:e.metadata.name});a.data.items&&a.data.items.code?n({type:"error",message:a.data.items.message}):0===a.code&&(n({type:"success",message:"删除成功"}),X())},le=async e=>{let a;switch(Z.value){case"create":default:a=await h({cluster_id:J.value.cluster_id,content:e});break;case"update":a=await x({cluster_id:J.value.cluster_id,namespaceName:e.metadata.name,content:e})}a.data.items&&a.data.items.code?n({type:"error",message:a.data.items.message}):0===a.code&&(ee(),(async e=>{0===e.code&&(n({type:"success",message:e.msg}),X())})(a))},te=async()=>{E(J.value.cluster_id),X()},se=e(!1),oe=()=>{W.value="CloudShell",se.value=!0};return window.addEventListener("setItemCluster",(e=>{J.value.cluster_id=parseInt(localStorage.getItem("cluster_id"))})),(e,n)=>{const b=g,k=y,w=f,h=p,x=c,E=_,O=j,X=v;return a(),l("div",null,[t("div",I,[s(E,{ref:"searchForm",inline:!0,model:J.value},{default:o((()=>[s(w,{label:"集群"},{default:o((()=>[s(k,{modelValue:J.value.cluster_id,"onUpdate:modelValue":n[0]||(n[0]=e=>J.value.cluster_id=e),style:{width:"200px"},placeholder:"请选择集群",onChange:te},{default:o((()=>[(a(!0),l(i,null,r(K.value,(e=>(a(),u(b,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(w,{label:"名称"},{default:o((()=>[s(h,{modelValue:J.value.keywords,"onUpdate:modelValue":n[1]||(n[1]=e=>J.value.keywords=e),placeholder:"名称"},null,8,["modelValue"])])),_:1}),s(w,null,{default:o((()=>[s(x,{size:"small",type:"primary",icon:"search",onClick:Q},{default:o((()=>n[5]||(n[5]=[d("查询")]))),_:1}),s(x,{size:"small",icon:"refresh",onClick:P},{default:o((()=>n[6]||(n[6]=[d("重置")]))),_:1})])),_:1}),s(w,null,{default:o((()=>[s(x,{size:"small",type:"primary",icon:"Cloudy",onClick:oe},{default:o((()=>n[7]||(n[7]=[d("CloudShell")]))),_:1})])),_:1})])),_:1},8,["model"])]),t("div",S,[t("div",U,[s(x,{size:"small",type:"primary",icon:"plus",onClick:n[2]||(n[2]=e=>(Z.value="create",W.value="创建",void(Y.value=!0)))},{default:o((()=>n[8]||(n[8]=[d("新增")]))),_:1})]),M.value?(a(),l("div",N,[s(V,{"table-data":M.value,onUpdate:$,onDelete:ae},null,8,["table-data"])])):m("",!0)]),t("div",A,[s(O,{"current-page":B.value,"page-size":H.value,"page-sizes":[10,30,50,100],total:G.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:T,onSizeChange:R},null,8,["current-page","page-size","total"])]),Y.value?(a(),l("div",D,[s(X,{modelValue:Y.value,"onUpdate:modelValue":n[3]||(n[3]=e=>Y.value=e),width:"40%",title:W.value,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},{default:o((()=>[s(C,{form:q.value,optype:Z.value,onClose:ee,onEnter:le},null,8,["form","optype"])])),_:1},8,["modelValue","title"])])):m("",!0),se.value?(a(),l("div",F,[s(X,{modelValue:se.value,"onUpdate:modelValue":n[4]||(n[4]=e=>se.value=e),width:"70%",title:W.value,center:!0},{default:o((()=>[t("div",L,[s(z,{onClose:ee})])])),_:1},8,["modelValue","title"])])):m("",!0)])}}});export{q as default};
