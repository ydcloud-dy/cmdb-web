/*! 
 Build based on  
 Time : 1735190558000 */
import{a as e,o as a,c as t,b as s,e as o,w as l,g as i,f as r,i as u,k as p,E as n}from"./index.ABWJOL2Q.js";import{E as c}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";import{E as d}from"./pagination.BfYt3rvk.js";/* empty css            */import"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              *//* empty css             *//* empty css               */import{a as m,E as v}from"./form-item.ujPiwBAF.js";import{g as y,d as g,a as j,c as f,u as b,T as h}from"./codeSource.zRy1fTFq.js";import k from"./form.BO8P2YU1.js";import w from"./table.DzBT5cGv.js";import{s as x}from"./cloud_region.DtcSymib.js";import"./index.BRjlB3m5.js";import"./refs.CZv2DkwS.js";import"./index.D4uEcQv3.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./index.DglrVZRl.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./_baseClone.gl1e0kmI.js";import"./_initCloneObject.jmqS1x-g.js";/* empty css                    *//* empty css              */import"./index.DINKPDpR.js";import"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                */import"./popover.DFR01WU1.js";import"./dropdown.Co_mIot6.js";import"./dayjs.min.DOWqlKAh.js";import"./stringFun.hIDu-B3o.js";const _={class:"dycloud-search-box"},z={class:"dycloud-table-box"},T={class:"dycloud-btn-list"},C={key:0},E={class:"dycloud-pagination"},I={key:0},S={name:"Index"},U=Object.assign(S,{setup(S){const U=e({}),D=e(1),V=e(0),H=e(10),F=e([]),A=e(""),O=e({});e(!1);const R=e([]),q=e([]),B=()=>{O.value={}},G=e=>{O.value=e,J()},L=()=>{D.value=1,H.value=10,J()},M=e=>{H.value=e,J()},N=e=>{D.value=e,J()},J=async()=>{const e=await y({page:D.value,pageSize:H.value,keyword:O.value.name});0===e.code&&(F.value=e.data.list,V.value=e.data.total,D.value=e.data.page,H.value=e.data.pageSize)};J();const K=e(!1),P=e("请输入地址"),Q=e(!1),W=e(""),X=async e=>{const a=await g(e.ID);if(W.value="update",A.value="更新",0===a.code){const e=a.data;U.value={ID:e.ID,name:e.name,desc:e.desc,type:e.type,repositoryType:0===e.config.type?"private":"public",url:e.config.url||"",username:3===e.type&&0===e.config.type?e.config.username:"",token:e.config.token||""},4===e.type?(U.value.url="https://github.com",K.value=!0,P.value="https://github.com"):5===e.type?(U.value.url="https://gitee.com",K.value=!0,P.value="https://gitee.com"):(K.value=!1,P.value="请输入地址"),Q.value=!0}},Y=async e=>{0===(await x({id:e.id})).code&&(u({type:"success",message:"操作成功"}),J())},Z=()=>{Q.value=!1,U.value={}},$=async e=>{e.visible=!1;0===(await j(e.ID)).code&&(u({type:"success",message:"删除成功"}),1===F.value.length&&D.value>1&&D.value--,J())},ee=e=>{R.value=e},ae=async e=>{let a;switch("kubernetes"===e.type?(e.type=0,e.config={type:0,conf:"config"===e.authType?e.conf:void 0,url:"token"===e.authType?e.url:void 0,token:"token"===e.authType?e.kubeToken:void 0},delete e.conf,delete e.url,delete e.kubeToken):"registry"===e.type&&(e.type=1,e.config={url:e.registryUrl,username:e.username,password:e.password,isHttps:e.isHttps},delete e.registryUrl,delete e.username,delete e.password,delete e.isHttps),delete e.authType,W.value){case"create":default:a=await f(e);break;case"update":a=await b(e)}0===a.code&&(Z(),(async e=>{0===e.code&&(u({type:"success",message:e.msg}),1===F.value.length&&D.value>1&&D.value--,J())})(a))},te=async e=>{const a=await h(e);0===a.code&&u({type:"success",message:a.data})};return(e,u)=>{const y=p,g=m,j=n,f=v,b=d,h=c;return a(),t("div",null,[s("div",_,[o(f,{ref:"searchForm",inline:!0,model:O.value},{default:l((()=>[o(g,{label:"名称"},{default:l((()=>[o(y,{modelValue:O.value.name,"onUpdate:modelValue":u[0]||(u[0]=e=>O.value.name=e),placeholder:"名称"},null,8,["modelValue"])])),_:1}),o(g,null,{default:l((()=>[o(j,{size:"small",type:"primary",icon:"search",onClick:L},{default:l((()=>u[3]||(u[3]=[i("查询")]))),_:1}),o(j,{size:"small",icon:"refresh",onClick:B},{default:l((()=>u[4]||(u[4]=[i("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),s("div",z,[s("div",T,[o(j,{size:"small",type:"primary",icon:"plus",onClick:u[1]||(u[1]=e=>(W.value="create",A.value="创建",U.value={repositoryType:"private",type:3},void(Q.value=!0)))},{default:l((()=>u[5]||(u[5]=[i("新增")]))),_:1})]),F.value?(a(),t("div",C,[o(w,{"table-data":F.value,onUpdate:X,onSearch:G,onTest:te,onSelect:ee,onDelete:$,onRegion:Y},null,8,["table-data"])])):r("",!0)]),s("div",E,[o(b,{"current-page":D.value,"page-size":H.value,"page-sizes":[10,30,50,100],total:V.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:N,onSizeChange:M},null,8,["current-page","page-size","total"])]),Q.value?(a(),t("div",I,[o(h,{modelValue:Q.value,"onUpdate:modelValue":u[2]||(u[2]=e=>Q.value=e),width:"40%",title:A.value,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},{default:l((()=>[o(k,{form:U.value,regions:q.value,"is-url-disabled":K.value,"url-placeholder":P.value,onClose:Z,type:W.value,onEnter:ae},null,8,["form","regions","is-url-disabled","url-placeholder","type"])])),_:1},8,["modelValue","title"])])):r("",!0)])}}});export{U as default};
