/*! 
 Build based on  
 Time : 1735190558000 */
import{a as e,o as a,c as t,b as s,e as o,w as l,g as i,f as r,i as n,k as u,E as p}from"./index.ABWJOL2Q.js";import{E as c}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";import{E as d}from"./pagination.BfYt3rvk.js";/* empty css            */import"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              *//* empty css             *//* empty css               */import{a as m,E as v}from"./form-item.ujPiwBAF.js";import{a as y,d as g,b as f,c as j,u as b,T as k}from"./service.5FwJlJUs.js";import h from"./form.CFO583s5.js";import w from"./table.DIIacuyC.js";import{s as x}from"./cloud_region.DtcSymib.js";import"./index.BRjlB3m5.js";import"./refs.CZv2DkwS.js";import"./index.D4uEcQv3.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./index.DglrVZRl.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./_baseClone.gl1e0kmI.js";import"./_initCloneObject.jmqS1x-g.js";import"./switch.CqADXIhW.js";/* empty css                    *//* empty css              */import"./index.DINKPDpR.js";import"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                */import"./popover.DFR01WU1.js";import"./dropdown.Co_mIot6.js";import"./dayjs.min.DOWqlKAh.js";import"./stringFun.hIDu-B3o.js";const _={class:"dycloud-search-box"},T={class:"dycloud-table-box"},z={class:"dycloud-btn-list"},C={key:0},U={class:"dycloud-pagination"},E={key:0},D={name:"Index"},H=Object.assign(D,{setup(D){const H=e({}),I=e(1),S=e(0),V=e(10),F=e([]),A=e(""),O=e({});e(!1);const R=e([]),q=e([]),B=()=>{O.value={}},G=e=>{O.value=e,Q()},L=()=>{I.value=1,V.value=10,Q()},M=e=>{V.value=e,Q()},N=e=>{I.value=e,Q()},Q=async()=>{const e=await y({page:I.value,pageSize:V.value,keyword:O.value.name});0===e.code&&(F.value=e.data.list,S.value=e.data.total,I.value=e.data.page,V.value=e.data.pageSize)};Q();const J=e(!1),K=e(""),P=async e=>{const a=await g(e.ID);if(K.value="update",A.value="更新",0===a.code){const e=a.data;H.value={ID:e.ID,name:e.name,desc:e.desc,type:e.type,authType:0===e.type?e.config.conf?"config":"token":null,conf:0===e.type&&e.config.conf?e.config.conf:"",url:0===e.type&&e.config.url?e.config.url:"",kubeToken:0===e.type&&e.config.token?e.config.token:"",registryUrl:1===e.type?e.config.url:"",username:1===e.type?e.config.username:"",password:1===e.type?e.config.password:"",isHttps:1===e.type&&e.config.isHttps},J.value=!0}},W=async e=>{0===(await x({id:e.id})).code&&(n({type:"success",message:"操作成功"}),Q())},X=()=>{J.value=!1,H.value={}},Y=async e=>{e.visible=!1;0===(await f(e.ID)).code&&(n({type:"success",message:"删除成功"}),1===F.value.length&&I.value>1&&I.value--,Q())},Z=e=>{R.value=e},$=async e=>{let a;switch("kubernetes"===e.type?(e.type=0,e.config={type:0,conf:"config"===e.authType?e.conf:void 0,url:"token"===e.authType?e.url:void 0,token:"token"===e.authType?e.kubeToken:void 0},delete e.conf,delete e.url,delete e.kubeToken):"registry"===e.type&&(e.type=1,e.config={url:e.registryUrl,username:e.username,password:e.password,isHttps:e.isHttps},delete e.registryUrl,delete e.username,delete e.password,delete e.isHttps),delete e.authType,K.value){case"create":default:a=await j(e);break;case"update":a=await b(e)}0===a.code&&(X(),(async e=>{0===e.code&&(n({type:"success",message:e.msg}),1===F.value.length&&I.value>1&&I.value--,Q())})(a))},ee=async e=>{const a=await k(e);0===a.code&&n({type:"success",message:a.data})};return(e,n)=>{const y=u,g=m,f=p,j=v,b=d,k=c;return a(),t("div",null,[s("div",_,[o(j,{ref:"searchForm",inline:!0,model:O.value},{default:l((()=>[o(g,{label:"名称"},{default:l((()=>[o(y,{modelValue:O.value.name,"onUpdate:modelValue":n[0]||(n[0]=e=>O.value.name=e),placeholder:"名称"},null,8,["modelValue"])])),_:1}),o(g,null,{default:l((()=>[o(f,{size:"small",type:"primary",icon:"search",onClick:L},{default:l((()=>n[3]||(n[3]=[i("查询")]))),_:1}),o(f,{size:"small",icon:"refresh",onClick:B},{default:l((()=>n[4]||(n[4]=[i("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),s("div",T,[s("div",z,[o(f,{size:"small",type:"primary",icon:"plus",onClick:n[1]||(n[1]=e=>(K.value="create",A.value="创建",void(J.value=!0)))},{default:l((()=>n[5]||(n[5]=[i("新增")]))),_:1})]),F.value?(a(),t("div",C,[o(w,{"table-data":F.value,onUpdate:P,onSearch:G,onTest:ee,onSelect:Z,onDelete:Y,onRegion:W},null,8,["table-data"])])):r("",!0)]),s("div",U,[o(b,{"current-page":I.value,"page-size":V.value,"page-sizes":[10,30,50,100],total:S.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:N,onSizeChange:M},null,8,["current-page","page-size","total"])]),J.value?(a(),t("div",E,[o(k,{modelValue:J.value,"onUpdate:modelValue":n[2]||(n[2]=e=>J.value=e),width:"40%",title:A.value,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},{default:l((()=>[o(h,{form:H.value,regions:q.value,onClose:X,type:K.value,onEnter:$},null,8,["form","regions","type"])])),_:1},8,["modelValue","title"])])):r("",!0)])}}});export{H as default};
