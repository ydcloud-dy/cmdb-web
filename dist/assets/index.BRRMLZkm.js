/*! 
 Build based on  
 Time : 1735190558000 */
import{s as e,a,o as t,c as s,b as l,e as o,w as i,g as r,f as d,i as m,k as n,E as u}from"./index.ABWJOL2Q.js";import{E as c}from"./dialog.DdLHJsLF.js";import"./overlay.CDLw2uOw.js";import{E as p}from"./pagination.BfYt3rvk.js";/* empty css            */import"./select.C2tLDQ30.js";import"./scrollbar.3ySweVnY.js";/* empty css               *//* empty css              *//* empty css             *//* empty css               */import{a as v,E as j}from"./form-item.ujPiwBAF.js";import{g}from"./k8s.DUZ1Kw0R.js";import{_ as y}from"./index.CLE9PzC_.js";import _ from"./table.BKp8mDhh.js";import"./index.BRjlB3m5.js";import"./refs.CZv2DkwS.js";import"./index.D4uEcQv3.js";import"./isEqual.CtpQH3Dm.js";import"./_Uint8Array.BjvNwsUf.js";import"./index.DglrVZRl.js";import"./token.DWNpOE8r.js";import"./strings.C2tuonvC.js";import"./castArray.9wqFpW2Z.js";import"./debounce.CkdGDwJt.js";import"./_baseIteratee.BPaQBmlP.js";import"./index.6ock-Gvr.js";import"./_baseClone.gl1e0kmI.js";import"./_initCloneObject.jmqS1x-g.js";import"./monaco-editor-vue3.es.BmYKexe9.js";import"./js-yaml.B_ZKWvuw.js";import"./table-column.ChuwY-lb.js";import"./checkbox.BcMUmSPv.js";/* empty css                */import"./popover.DFR01WU1.js";import"./dropdown.Co_mIot6.js";import"./age.Du5VDnjl.js";const b=(e,a)=>"/kubernetes/proxy/".concat(e,"/api/v1/namespaces/").concat(a,"/endpoints"),f=a=>e({url:"/kubernetes/endpointDetails",method:"get",params:a}),k=a=>e({url:"/kubernetes/endpoint",method:"post",data:a}),w={class:"dycloud-table-box"},h={class:"dycloud-btn-list"},x={key:0},z={class:"dycloud-pagination"},C={key:0},E={class:"dialog-footer"},I={name:"Endpoints"},V=Object.assign(I,{setup(I){const V=a({}),N=a(1),S=a(0),D=a(10),U=a([]),L=a(""),A=a({keywords:"",namespace:""}),F=a(!1),O=()=>{A.value.keywords=""},q=()=>{N.value=1,D.value=10,Y()},H=e=>{D.value=e,Y()},M=e=>{N.value=e,Y()},Y=async()=>{const a=await(t={cluster_id:A.value.cluster_id,page:N.value,pageSize:D.value,namespace:A.value.namespace,keyword:A.value.keywords},e({url:"/kubernetes/endpoint",method:"get",params:t}));var t;0===a.code&&(U.value=a.data.items,S.value=a.data.total,N.value=a.data.page,D.value=a.data.pageSize)},B=a(!1),G=a(""),J=async e=>{G.value="update",L.value="编辑";const a=await f({cluster_id:A.value.cluster_id,namespace:e.metadata.namespace,endpointName:e.metadata.name});a.data.items&&a.data.items.code?m({type:"error",message:a.data.items.message}):0===a.code&&(V.value=a.data.items,F.value=!1,B.value=!0)},K=()=>{B.value=!1,V.value={}},P=async a=>{a.visible=!1;const t=await(s={cluster_id:A.value.cluster_id,namespace:a.metadata.namespace,endpointName:a.metadata.name},e({url:"".concat(b(s,l),"/").concat(o),method:"delete"}));var s,l,o;t.data.items&&t.data.items.code?m({type:"error",message:t.data.items.message}):0===t.code&&(m({type:"success",message:"删除成功"}),Y())},Q=async a=>{let t;switch(G.value){case"create":t=await k({cluster_id:A.value.cluster_id,namespace:a.metadata.namespace,content:a});break;case"update":t=await(s={cluster_id:A.value.cluster_id,namespace:a.metadata.namespace,endpointName:a.metadata.name,content:a},e({url:"".concat(b(s,l),"/").concat(o),method:"put",data:i}));break;default:t=await k({cluster_id:A.value.cluster_id,content:a})}var s,l,o,i;t.data.items&&t.data.items.code?m({type:"error",message:t.data.items.message}):0===t.code&&(K(),(async e=>{0===e.code&&(m({type:"success",message:e.msg}),Y())})(t))},R=async e=>{const a=await f({cluster_id:A.value.cluster_id,namespace:e.metadata.namespace,endpointName:e.metadata.name});a.data.items&&a.data.items.code?m({type:"error",message:a.data.items.message}):0===a.code&&(L.value="详情",V.value=a.data.items,V.value.cluster_id=A.value.cluster_id,F.value=!0,B.value=!0)};return window.addEventListener("setItemCluster",(e=>{A.value.cluster_id=parseInt(localStorage.getItem("cluster_id"))})),window.addEventListener("setItemNamespace",(e=>{A.value.namespace=localStorage.getItem("namespace"),Y()})),(e,a)=>{const m=n,b=v,f=u,k=j,I=p,Y=c;return t(),s("div",null,[l("div",w,[l("div",h,[o(k,{ref:"searchForm",inline:!0,model:A.value},{default:i((()=>[o(b,{label:"名称"},{default:i((()=>[o(m,{modelValue:A.value.keywords,"onUpdate:modelValue":a[0]||(a[0]=e=>A.value.keywords=e),placeholder:"名称"},null,8,["modelValue"])])),_:1}),o(b,null,{default:i((()=>[o(f,{size:"small",type:"primary",icon:"search",onClick:q},{default:i((()=>a[3]||(a[3]=[r("查询")]))),_:1}),o(f,{size:"small",icon:"refresh",onClick:O},{default:i((()=>a[4]||(a[4]=[r("重置")]))),_:1})])),_:1}),o(b,null,{default:i((()=>[o(f,{size:"small",type:"primary",icon:"plus",onClick:a[1]||(a[1]=e=>(G.value="create",L.value="创建",V.value=g("endpoints",A.value.namespace,""),F.value=!1,void(B.value=!0)))},{default:i((()=>a[5]||(a[5]=[r("新增")]))),_:1})])),_:1})])),_:1},8,["model"])]),U.value?(t(),s("div",x,[o(_,{"table-data":U.value,onUpdate:J,onDetail:R,onDelete:P},null,8,["table-data"])])):d("",!0)]),l("div",z,[o(I,{"current-page":N.value,"page-size":D.value,"page-sizes":[10,30,50,100],total:S.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:M,onSizeChange:H},null,8,["current-page","page-size","total"])]),B.value?(t(),s("div",C,[o(Y,{modelValue:B.value,"onUpdate:modelValue":a[2]||(a[2]=e=>B.value=e),width:"60%",title:L.value},{default:i((()=>[l("div",E,[o(y,{data:V.value,"read-only":F.value,onClose:K,onEnter:Q},null,8,["data","read-only"])])])),_:1},8,["modelValue","title"])])):d("",!0)])}}});export{V as default};
