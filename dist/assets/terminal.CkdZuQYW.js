/*! 
 Build based on  
 Time : 1735190558000 */
import{s as e,a as t,_ as s,o as n,c as o,b as a}from"./index.ABWJOL2Q.js";import{x as i}from"./xterm.BR7SOqRe.js";/* empty css              */import{x as r}from"./xterm-addon-fit.onOJMBm7.js";const d=t=>e({url:"/kubernetes/pods",method:"get",params:t}),l=t=>e({url:"/kubernetes/pods/deleteFiles",method:"post",data:t}),c=t=>e({url:"/kubernetes/podDetails",method:"get",params:t}),m=t=>e({url:"/kubernetes/pods",method:"post",data:t}),h=t=>e({url:"/kubernetes/pods",method:"put",data:t}),p=t=>e({url:"/kubernetes/pods",method:"delete",data:t}),u=t=>e({url:"/kubernetes/nodes/EvictAllPod",method:"post",data:t}),w=t=>e({url:"/kubernetes/pods/listFiles",method:"post",data:t}),x=t("https://"),g=t(void 0);const b=s({name:"Terminal",props:{data:{type:Object,default:()=>({})},name:{type:String,default:()=>""}},data:()=>({xterm:null,ws:null,winHeight:window.innerHeight,containername:"",containers:[]}),mounted(){this.initTerminal(),window.addEventListener("resize",this.onWindowResize)},methods:{initTerminal(){const e=document.body.clientHeight,t=e/18,s=e/3;this.xterm=new i.Terminal({cols:parseInt(s.toString(),10),rows:parseInt(t.toString(),10),rendererType:"canvas",convertEol:!0,disableStdin:!1,scrollback:100,cursorBlink:!0,cursorStyle:"bar",fontSize:14,windowsMode:!0,theme:{foreground:"#FFFFFF",background:"#000000",cursor:"help",lineHeight:16}});const n=new r.FitAddon;this.xterm.loadAddon(n),n.fit();const o=document.getElementById("terminal");this.xterm.open(o),this.xterm.writeln("欢迎使用运维系统终端"),this.xterm.writeln(""),this.wsConnect(),this.xterm.onData(this.onTerminalData),this.xterm.onResize(this.onTerminalResize)},onTerminalData(e){const t={type:"read",data:e};this.ws.send(JSON.stringify(t))},onWindowResize(){const e={type:"resize",cols:this.xterm.cols,rows:this.xterm.rows};this.ws.send(JSON.stringify(e))},onTerminalResize(){const e={type:"resize",cols:this.xterm.cols,rows:this.xterm.rows};this.ws.send(JSON.stringify(e))},wsConnect(){-1!==x.value.indexOf("http")?x.value=x.value.replace("http","ws"):-1!==x.value.indexOf("https")&&(x.value=x.value.replace("https","wss"));const e=localStorage.getItem("token"),t="".concat(x.value,":").concat(g.value,"/kubernetes/pods/terminal?name=").concat(this.name,"&cluster_id=").concat(this.data.cluster_id,"&pod_name=").concat(this.data.metadata.name,"&namespace=").concat(this.data.metadata.namespace,"&x-token=").concat(e,"&cols=").concat(this.xterm.cols,"&rows=").concat(this.xterm.rows);this.ws=new WebSocket(t),this.ws.onopen=this.onConnectionOpen,this.ws.onmessage=this.onConnectionMessage,this.ws.onclose=this.onConnectionClose,this.ws.onerror=this.onConnectionError},onConnectionOpen(e){this.onTerminalResize(),this.xterm.focus()},onConnectionMessage(e){const t=JSON.parse(e.data);"write"===t.type&&this.xterm.write(t.data)},onConnectionClose(e){},onConnectionError(e){}}},[["render",function(e,t,s,i,r,d){return n(),o("div",null,t[0]||(t[0]=[a("div",null,[a("div",{id:"terminal",width:"100%",style:{overflow:"auto"},className:"console"})],-1)]))}]]);export{l as D,d as G,b as P,w as a,p as b,c,h as d,u as e,m as f};
